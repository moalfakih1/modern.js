[{"id":0,"title":"Builder Core","routePath":"/builder/en/api/builder-core","lang":"en","toc":[{"text":"createBuilder","id":"createbuilder","depth":2},{"text":"builderWebpackProvider","id":"builderwebpackprovider","depth":3},{"text":"builderRspackProvider","id":"builderrspackprovider","depth":3},{"text":"options","id":"options","depth":3},{"text":"mergeBuilderConfig","id":"mergebuilderconfig","depth":2},{"text":"webpack","id":"webpack","depth":2},{"text":"HtmlWebpackPlugin","id":"htmlwebpackplugin","depth":2}],"domain":"","content":"#\n\nThis section describes some of the core methods provided by Builder.\n\n\ncreateBuilder#\n\nCreate a Builder instance object.\n\nWhen using this method, it needs to be used with the\n@modern-js/builder-webpack-provider or @modern-js/builder-rspack-provider.\nProviders implements corresponding build feature based on specific bundlers.\n\n\nbuilderWebpackProvider#\n\nWhen builderWebpackProvider is passed, the Builder will use webpack as the\nbundler for building.\n\n\n\n\nconst provider = builderWebpackProvider({\n  builderConfig: {\n    // some configs\n  },\n});\n\nconst builder = await createBuilder(provider, {\n  // some options\n});\n\n\n\nbuilderRspackProvider#\n\nWhen builderRspackProvider is passed, the Builder will use Rspack as the bundler\nfor building.\n\n\n\n\nconst provider = builderRspackProvider({\n  builderConfig: {\n    // some configs\n  },\n});\n\nconst builder = await createBuilder(provider, {\n  // some options\n});\n\n\n\noptions#\n\nThe second parameter of createBuilder is a options object, you can pass in the\nfollowing options:\n\ntype BuilderEntry = Record;\n\ntype BuilderTarget = 'web' | 'node' | 'modern-web' | 'web-worker';\n\ntype CreateBuilderOptions = {\n  cwd?: string;\n  entry?: BuilderEntry;\n  target?: BuilderTarget | BuilderTarget[];\n  framework?: string;\n  configPath?: string | null;\n};\n\n\nDescription:\n\n * cwd: The root path of the current build, the default value is process.cwd().\n * entry: Build entry object.\n * target: Build target type, the default value is ['web'], see chapter Build\n   Target for details.\n * framework: The name of the framework, a unique identifier, the default value\n   is 'modern.js'.\n * configPath: The path to the framework config file (absolute path), this\n   parameter affects the build cache update.\n\n\nmergeBuilderConfig#\n\nMerges multiple Builder config objects and returns a new merged object.\n\n * Type\n\nfunction mergeBuilderConfig(...configs: BuilderConfig[]): BuilderConfig;\n\n\n * Example\n\n\n\nconst config1 = {\n  dev: {\n    https: false,\n  },\n};\nconst config2 = {\n  dev: {\n    https: true,\n  },\n};\n\nconst mergedConfig = mergeBuilderConfig(config1, config2);\n\nconsole.log(mergedConfig); // { dev: { https: true } }\n\n\n> This method does not modify the original config object.\n\n\nwebpack#\n\nA webpack object for consuming webpack builtin plugins or type definitions.\n\n * Example\n\n\n\nnew webpack.DefinePlugin();\n\n\n> In most scenarios, it is recommended to import webpack from Builder instead of\n> manually installing a \"webpack\" dependency, which can avoid multi-instance\n> problems.\n\n\nHtmlWebpackPlugin#\n\nHtmlWebpackPlugin object, usually used to implement custom plugins of\nHtmlWebpackPlugin.\n\n * Example\n\n\n\n\n> In most scenarios, it is recommended to import HtmlWebpackPlugin from builder\n> instead of manually installing a \"html-webpack-plugin\" dependency, which can\n> avoid multi-instance problems.","frontmatter":{"extractApiHeaders":[2]}},{"id":1,"title":"Builder Instance","routePath":"/builder/en/api/builder-instance","lang":"en","toc":[{"text":"builder.context","id":"builder.context","depth":2},{"text":"builder.context.entry","id":"builder.context.entry","depth":3},{"text":"builder.context.target","id":"builder.context.target","depth":3},{"text":"builder.context.rootPath","id":"builder.context.rootpath","depth":3},{"text":"builder.context.srcPath","id":"builder.context.srcpath","depth":3},{"text":"builder.context.distPath","id":"builder.context.distpath","depth":3},{"text":"builder.context.cachePath","id":"builder.context.cachepath","depth":3},{"text":"builder.context.configPath","id":"builder.context.configpath","depth":3},{"text":"builder.context.tsconfigPath","id":"builder.context.tsconfigpath","depth":3},{"text":"builder.context.framework","id":"builder.context.framework","depth":3},{"text":"builder.context.devServer","id":"builder.context.devserver","depth":3},{"text":"builder.context.bundlerType","id":"builder.context.bundlertype","depth":3},{"text":"builder.build","id":"builder.build","depth":2},{"text":"Development environment build","id":"development-environment-build","depth":3},{"text":"Monitor file changes","id":"monitor-file-changes","depth":3},{"text":"Custom Compiler","id":"custom-compiler","depth":3},{"text":"builder.startDevServer","id":"builder.startdevserver","depth":2},{"text":"Disable Print URLs","id":"disable-print-urls","depth":3},{"text":"Strict Port","id":"strict-port","depth":3},{"text":"Custom Compiler","id":"custom-compiler-1","depth":3},{"text":"builder.createCompiler","id":"builder.createcompiler","depth":2},{"text":"builder.addPlugins","id":"builder.addplugins","depth":2},{"text":"builder.removePlugins","id":"builder.removeplugins","depth":2},{"text":"builder.isPluginExists","id":"builder.ispluginexists","depth":2},{"text":"builder.inspectConfig","id":"builder.inspectconfig","depth":2},{"text":"builder.onBeforeCreateCompiler","id":"builder.onbeforecreatecompiler","depth":2},{"text":"builder.onAfterCreateCompiler","id":"builder.onaftercreatecompiler","depth":2},{"text":"builder.onBeforeBuild","id":"builder.onbeforebuild","depth":2},{"text":"builder.onAfterBuild","id":"builder.onafterbuild","depth":2},{"text":"builder.onBeforeStartDevServer","id":"builder.onbeforestartdevserver","depth":2},{"text":"builder.onAfterStartDevServer","id":"builder.onafterstartdevserver","depth":2},{"text":"builder.onDevCompileDone","id":"builder.ondevcompiledone","depth":2},{"text":"builder.onExit","id":"builder.onexit","depth":2},{"text":"builder.getBuilderConfig","id":"builder.getbuilderconfig","depth":2},{"text":"builder.getNormalizedConfig","id":"builder.getnormalizedconfig","depth":2},{"text":"builder.getHTMLPaths","id":"builder.gethtmlpaths","depth":2}],"domain":"","content":"#\n\nThis section describes all the properties and methods on the Builder instance\nobject.\n\n\nbuilder.context#\n\nbuilder.context is a read-only object that provides some context infos.\n\n\nbuilder.context.entry#\n\nThe entry object, corresponding to the entry option of createBuilder method.\n\n * Type\n\ntype BuilderEntry = Record;\n\n\n\nbuilder.context.target#\n\nBuild target type, corresponding to the target option of createBuilder method.\n\n * Type\n\ntype BuilderTarget = 'web' | 'node' | 'modern-web' | 'web-worker';\n\ntype Context = {\n  target: BuilderTarget | BuilderTarget[];\n};\n\n\n\nbuilder.context.rootPath#\n\nThe root path of current build, corresponding to the cwd option of createBuilder\nmethod.\n\n * Type\n\ntype RootPath = string;\n\n\n\nbuilder.context.srcPath#\n\nThe absolute path to the src directory.\n\n * Type\n\ntype SrcPath = string;\n\n\n\nbuilder.context.distPath#\n\nThe absolute path of the output directory, corresponding to the\noutput.distPath.root config in BuilderConfig.\n\n * Type\n\ntype DistPath = string;\n\n\n\nbuilder.context.cachePath#\n\nThe absolute path of the build cache files.\n\n * Type\n\ntype CachePath = string;\n\n\n\nbuilder.context.configPath#\n\nThe absolute path to the framework config file, corresponding to the configPath\noption of createBuilder method.\n\n * Type\n\ntype ConfigPath = string | undefined;\n\n\n\nbuilder.context.tsconfigPath#\n\nThe absolute path of the tsconfig.json file, or undefined if the tsconfig.json\nfile does not exist in current project.\n\n * Type\n\ntype TsconfigPath = string | undefined;\n\n\n\nbuilder.context.framework#\n\nThe name of the framework, a unique identifier, the default value is\n'modern.js'.\n\n * Type\n\ntype Framework = string | undefined;\n\n\n\nbuilder.context.devServer#\n\nDev Server information, including the current Dev Server hostname and port\nnumber.\n\n * Type\n\ntype DevServer = {\n  hostname: string;\n  port: number;\n};\n\n\n\nbuilder.context.bundlerType#\n\nThe bundler type of current build.\n\n * Type\n\ntype bundlerType = 'webpack' | 'rspack';\n\n\n\nbuilder.build#\n\nPerform a production build.\n\n * Type\n\ntype BuildOptions = {\n  mode?: 'development' | 'production';\n  watch?: boolean;\n  // custom Compiler object\n  compiler?: Compiler | MultiCompiler;\n};\n\nfunction Build(options?: BuildOptions): Promise;\n\n\n * Example\n\nawait builder.build();\n\n\n\nDevelopment environment build#\n\nIf you need to perform a development build, you can set the mode option to\n'development'.\n\nawait builder.build({\n  mode: 'development',\n});\n\n\n\nMonitor file changes#\n\nIf you need to watch file changes and re-build, you can set the watch option to\ntrue.\n\nawait builder.build({\n  watch: true,\n});\n\n\n\nCustom Compiler#\n\nIn some cases, you may want to use a custom compiler:\n\nconst compiler = webpack({\n  // ...\n});\nawait builder.build({\n  compiler,\n});\n\n\n\nbuilder.startDevServer#\n\nStart the local Dev Server, based on the Modern.js Dev Server.\n\n * Type\n\ntype StartDevServerOptions = {\n  // Whether to output URL infos, the default is true\n  printURLs?: boolean | Function;\n  // Whether to throw an exception when the port is occupied, the default is false\n  strictPort?: boolean;\n  // custom Compiler object\n  compiler?: Compiler | MultiCompiler;\n  // passing through the build-independent dev server configuration\n  serverOptions?: Partial;\n};\n\ntype StartDevServerResult = {\n  urls: string[];\n  port: number;\n  server: Server;\n};\n\nfunction StartDevServer(\n  options?: StartDevServerOptions,\n): Promise;\n\n\n * Example\n\nStart Dev Server:\n\nawait builder.startDevServer();\n\n\nAfter successfully starting Dev Server, you can see the following logs:\n\ninfo    Starting dev server...\ninfo    Dev server running at:\n\n  > Local:    http://localhost:8080\n  > Network:  http://192.168.0.1:8080\n\n\nstartDevServer returns the following parameters:\n\n * urls: URLs to access Dev Server.\n * port: The actual listening port number.\n * server: Server instance object.\n\nconst { urls, port, server } = await builder.startDevServer();\nconsole.log(urls); // ['http://localhost:8080', 'http://192.168.0.1:8080']\nconsole.log(port); // 8080\n\n// Close the Dev Server\nawait server.close();\n\n\n\nDisable Print URLs#\n\nSetting printURLs to false to disable the default URL output, so you can custom\nthe logs.\n\nawait builder.startDevServer({\n  printURLs: false,\n});\n\n\nYou can also directly configure printURLs as a function to modify URLs, such as\nadding a subpath to each URL:\n\nawait builder.startDevServer({\n  printURLs: urls => {\n    return urls.map(({ label, url }) => ({\n      label,\n      url: `${url}/path`,\n    }));\n  },\n});\n\n\n\nStrict Port#\n\nWhen a port is occupied, Builder will automatically increment the port number\nuntil an available port is found.\n\nSet strictPort to true and Builder will throw an exception when the port is\noccupied.\n\nawait builder.startDevServer({\n  strictPort: true,\n});\n\n\n\nCustom Compiler#\n\nIn some cases, you may want to use a custom compiler:\n\nconst compiler = webpack({\n  // ...\n});\nawait builder.startDevServer({\n  compiler,\n});\n\n\n\nbuilder.createCompiler#\n\nCreate a Compiler object.\n\nWhen the target option of createBuilder contains only one value, the return\nvalue is Compiler; when target contains multiple values, the return value is\nMultiCompiler.\n\n * Type\n\nfunction CreateCompiler(): Promise;\n\n\n * Example\n\nconst compiler = await builder.createCompiler();\n\n\n> In most scenarios, you do not need to use this API unless you need to custom\n> the Dev Server or other advanced scenarios.\n\n\nbuilder.addPlugins#\n\nRegister one or more Builder plugins, which can be called multiple times.\n\nThis method needs to be called before compiling. If it is called after\ncompiling, it will not affect the compilation result.\n\n * Type\n\ntype AddPluginsOptions = { before?: string } | { after?: string };\n\nfunction AddPlugins(\n  plugins: BuilderPlugins[],\n  options?: AddPluginsOptions,\n): Promise;\n\n\n * Example\n\nbuilder.addPlugins([builderPluginFoo(), builderPluginBar()]);\n\n// Insert before the bar plugin\nbuilder.addPlugins([builderPluginFoo()], { before: 'bar' });\n\n// Insert after the bar plugin\nbuilder.addPlugins([builderPluginFoo()], { after: 'bar' });\n\n\n\nbuilder.removePlugins#\n\nRemoves one or more Builder plugins, which can be called multiple times.\n\nThis method needs to be called before compiling. If it is called after\ncompiling, it will not affect the compilation result.\n\n * Type\n\nfunction RemovePlugins(pluginNames: string[]): void;\n\n\n * Example\n\n// add plugin\nconst pluginFoo = builderPluginFoo();\nbuilder.addPlugins(pluginFoo);\n\n// remove plugin\nbuilder.removePlugins([pluginFoo.name]);\n\n\n\nbuilder.isPluginExists#\n\nDetermines whether a plugin has been registered.\n\n * Type\n\nfunction IsPluginExists(pluginName: string): boolean;\n\n\n * Example\n\nbuilder.addPlugins([builderPluginFoo()]);\n\nbuilder.isPluginExists(builderPluginFoo().name); // true\n\n\n\nbuilder.inspectConfig#\n\nInspect the final generated builder config and bundler config.\n\n * Type\n\ntype InspectConfigOptions = {\n  // View the config in the specified environment, the default is \"development\", can be set to \"production\"\n  env?: BuilderMode;\n  // Whether to enable verbose mode, display the complete content of the function in the config, the default is `false`\n  verbose?: boolean;\n  // Specify the output path, defaults to the value configured by `output.distPath.root`\n  outputPath?: string;\n  // Whether to write the result to disk, the default is `false`\n  writeToDisk?: boolean;\n};\n\nasync function InspectConfig(options?: InspectConfigOptions): Promise<{\n  builderConfig: string;\n  bundlerConfigs: string[];\n  origin: {\n    builderConfig: BuilderConfig;\n    bundlerConfigs: BundlerConfigs[];\n  };\n}>;\n\n\n * Example\n\nGet the config content in string format:\n\nconst { builderConfig, bundlerConfigs } = await builder.inspectConfig();\n\nconsole.log(builderConfig, bundlerConfigs);\n\n\nWrite the config content to disk:\n\nawait builder.inspectConfig({\n  writeToDisk: true,\n});\n\n\n\nbuilder.onBeforeCreateCompiler#\n\nCalled before creating the compiler instance, when you execute\nbuilder.startDevServer, builder.build or builder.createCompiler, this hook will\nbe called. You can get the final config object of the bundler through the\nbundlerConfigs parameter.\n\n * Type\n\nfunction OnBeforeCreateCompiler(\n  callback: (params: {\n    bundlerConfigs: WebpackConfig[] | RspackConfig[];\n  }) => Promise | void,\n): void;\n\n\n * Example\n\nbuilder.onBeforeCreateCompiler(({ bundlerConfigs }) => {\n  console.log('the bundler config is ', bundlerConfigs);\n});\n\n\n\nbuilder.onAfterCreateCompiler#\n\nCalled after creating a compiler instance, before executing a build, when you\nexecute builder.startDevServer, builder.build or builder.createCompiler, this\nhook will be called. You can get the compiler instance through the compiler\nparameter.\n\n * Type\n\nfunction OnAfterCreateCompiler(callback: (params: {\n  compiler: Compiler | MultiCompiler;\n}) => Promise | void;): void;\n\n\n * Example\n\nbuilder.onAfterCreateCompiler(({ compiler }) => {\n  console.log('the compiler is ', compiler);\n});\n\n\n\nbuilder.onBeforeBuild#\n\nCalled before executing the production environment build, you can get the final\nconfig object of the bundler through the bundlerConfigs parameter.\n\n * Type\n\nfunction OnBeforeBuild(\n  callback: (params: {\n    bundlerConfigs?: WebpackConfig[] | RspackConfig[];\n  }) => Promise | void,\n): void;\n\n\n * Example\n\nbuilder.onBeforeBuild(({ bundlerConfigs }) => {\n  console.log('the bundler config is ', bundlerConfigs);\n});\n\n\n\nbuilder.onAfterBuild#\n\nCalled after executing the production build, you can get the build result\ninformation through the stats parameter.\n\n * Type\n\nfunction OnAfterBuild(\n  callback: (params: { stats?: Stats | MultiStats }) => Promise | void,\n): void;\n\n\n * Example\n\nbuilder.onAfterBuild(({ stats }) => {\n  console.log(stats?.toJson());\n});\n\n\n\nbuilder.onBeforeStartDevServer#\n\nCalled before starting the development server.\n\n * Type\n\nfunction OnBeforeStartDevServer(callback: () => Promise | void): void;\n\n\n * Example\n\nbuilder.onBeforeStartDevServer(() => {\n  console.log('before start!');\n});\n\n\n\nbuilder.onAfterStartDevServer#\n\nCalled after starting the development server, you can get the port number\nthrough the port parameter.\n\n * Type\n\nfunction OnAfterStartDevServer(\n  callback: (params: { port: number }) => Promise | void,\n): void;\n\n\n * Example\n\nbuilder.onAfterStartDevServer(({ port }) => {\n  console.log('this port is: ', port);\n});\n\n\n\nbuilder.onDevCompileDone#\n\nCalled after each development environment build, you can use isFirstCompile to\ndetermine whether it is the first build.\n\n * Type\n\nfunction OnDevCompileDone(\n  callback: (params: { isFirstCompile: boolean }) => Promise | void,\n): void;\n\n\n * Example\n\nbuilder.onDevCompileDone(({ isFirstCompile }) => {\n  if (isFirstCompile) {\n    console.log('first compile!');\n  } else {\n    console.log('re-compile!');\n  }\n});\n\n\n\nbuilder.onExit#\n\nCalled when the process is going to exit, this hook can only execute synchronous\ncode.\n\n * Type\n\nfunction OnExit(callback: () => void): void;\n\n\n * Example\n\nbuilder.onExit(() => {\n  console.log('exit!');\n});\n\n\n\nbuilder.getBuilderConfig#\n\nGet the Builder config, this method must be called after the modifyBuilderConfig\nhook is executed.\n\n * Type\n\nfunction GetBuilderConfig(): Readonly;\n\n\n * Example\n\nbuilder.onBeforeBuild(() => {\n  const config = builder.getBuilderConfig();\n  console.log(config.html?.title);\n});\n\n\n\nbuilder.getNormalizedConfig#\n\nGet the normalized Builder config, this method must be called after the\nmodifyBuilderConfig hook is executed.\n\nCompared with the api.getBuilderConfig method, the config returned by this\nmethod has been normalized, and the type definition of the config will be\nnarrowed. For example, the undefined type of config.html will be removed.\n\nIt is recommended to use this method to get the Builder config.\n\n * Type\n\nfunction GetNormalizedConfig(): Readonly;\n\n\n * Example\n\nbuilder.onBeforeBuild(() => {\n  const config = api.getNormalizedConfig();\n  console.log(config.html.title);\n});\n\n\n\nbuilder.getHTMLPaths#\n\nGet path information for all HTML assets.\n\nThis method will return an object, the key is the entry name and the value is\nthe relative path of the HTML file in the dist directory.\n\n * Type\n\nfunction GetHTMLPaths(): Record;\n\n\n * Example\n\nbuilder.onBeforeBuild(() => {\n  const htmlPaths = api.getHTMLPaths();\n  console.log(htmlPaths); // { main: 'html/main/index.html' };\n});\n","frontmatter":{"extractApiHeaders":[2]}},{"id":2,"title":"Builder Types","routePath":"/builder/en/api/builder-types","lang":"en","toc":[{"text":"BuilderInstance","id":"builderinstance","depth":2},{"text":"BuilderContext","id":"buildercontext","depth":2},{"text":"BuilderPlugin","id":"builderplugin","depth":2},{"text":"BuilderTarget","id":"buildertarget","depth":2},{"text":"BuilderEntry","id":"builderentry","depth":2},{"text":"CreateBuilderOptions","id":"createbuilderoptions","depth":2}],"domain":"","content":"#\n\nThis section describes some of the type definitions provided by the Builder.\n\n\nBuilderInstance#\n\nThe type of the Builder instance.\n\n\n\nlet builder: BuilderInstance;\n\n\nYou can pass in the Provider type through generics to make the type definition\nof the Builder instance more accurate:\n\n\n\n\nlet builder: BuilderInstance;\n\n\n\nBuilderContext#\n\nThe type of the context property in the Builder instance.\n\n\n\nconst context: BuilderContext = builder.context;\n\n\n\nBuilderPlugin#\n\nThe type of Builder plugin, should be used with the BuilderPluginAPI type\nexported from the provider.\n\n\n\n\nconst myPlugin: BuilderPlugin = {\n  name: 'my-plugin',\n  setup() {},\n};\n\n\n\nBuilderTarget#\n\nThe type of build target.\n\n\n\n\n\nBuilderEntry#\n\nThe type of the entry option to the createBuilder method.\n\n\n\n\n\nCreateBuilderOptions#\n\nThe param type of createBuilder method.\n\n\n","frontmatter":{"extractApiHeaders":[2]}},{"id":3,"title":"Dev Config","routePath":"/builder/en/api/config-dev","lang":"en","toc":[{"text":"dev.assetPrefix","id":"dev.assetprefix","depth":2},{"text":"Boolean Type","id":"boolean-type","depth":4},{"text":"String type","id":"string-type","depth":4},{"text":"dev.beforeStartUrl","id":"dev.beforestarturl","depth":2},{"text":"dev.hmr","id":"dev.hmr","depth":2},{"text":"dev.host","id":"dev.host","depth":2},{"text":"dev.https","id":"dev.https","depth":2},{"text":"Automatically generate certificates","id":"automatically-generate-certificates","depth":4},{"text":"Manually set the certificate","id":"manually-set-the-certificate","depth":4},{"text":"dev.port","id":"dev.port","depth":2},{"text":"Example","id":"example","depth":3},{"text":"dev.progressBar","id":"dev.progressbar","depth":2},{"text":"dev.startUrl","id":"dev.starturl","depth":2},{"text":"Port placeholder","id":"port-placeholder","depth":3}],"domain":"","content":"#\n\nThis section describes some dev configurations in Modern.js Builder.\n\n\ndev.assetPrefix#\n\n * Type: boolean | string\n * Default: '/'\n\nSet the URL prefix of static assets in the development environment, similar to\nthe output.publicPath config of webpack.\n\nassetPrefix will affect the URLs of most of the static assets, including\nJavaScript files, CSS files, images, videos, etc. If an incorrect value is\nspecified, you'll receive 404 errors while loading these resources.\n\nThis config is only used in the development environment. In the production\nenvironment, please use the output.assetPrefix to set the URL prefix.\n\nBoolean Type#\n\nIf assetPrefix is set to true, the URL prefix will be //ip:port/:\n\nexport default {\n  dev: {\n    assetPrefix: true,\n  },\n};\n\n\nThe script URL will be:\n\n\n\n\nIf assetPrefix is set to false or not set, / is used as the default value.\n\nString type#\n\nWhen the value of assetPrefix is string type, the string will be used as the URL\nprefix:\n\nexport default {\n  dev: {\n    assetPrefix: 'http://example.com/assets/',\n  },\n};\n\n\nThe script URL will be:\n\n\n\n\n\ndev.beforeStartUrl#\n\n * Type: () => Promise | void\n * Default: undefined\n\ndev.beforeStartUrl is used to execute a callback function before opening the\nstartUrl, this config needs to be used together with dev.startUrl.\n\nexport default {\n  dev: {\n    startUrl: true,\n    beforeStartUrl: async () => {\n      await doSomeThing();\n    },\n  },\n};\n\n\n\ndev.hmr#\n\n * Type: boolean\n * Default: true\n\nWhether to enable Hot Module Replacement.\n\nIf hmr is set to false, the HMR and react-refresh will no longer work.\n\nexport default {\n  dev: {\n    hmr: false,\n  },\n};\n\n\n\ndev.host#\n\n * Type: string\n * Default: localhost\n\nSpecify the host used by Dev Server. For example, if you want the server to be\naccessible externally, you can set it to:\n\nexport default {\n  dev: {\n    host: '0.0.0.0',\n  },\n};\n\n\n\ndev.https#\n\n * Type: boolean | { key: string; cert: string }\n * Default: false\n\nAfter configuring this option, you can enable HTTPS Dev Server, and disabling\nthe HTTP Dev Server.\n\nHTTP:\n\n  > Local: http://localhost:8080/\n  > Network: http://192.168.0.1:8080/\n\n\nHTTPS:\n\n  > Local: https://localhost:8080/\n  > Network: https://192.168.0.1:8080/\n\n\nAutomatically generate certificates#\n\nYou can directly set https to true, Builder will automatically generate the\nHTTPS certificate based on devcert.\n\nWhen using this method, you need to manually install the devcert dependency in\nyour project:\n\n# npm\nnpm install devcert@1.2.2 -D\n\n#yarn\nyarn add devcert@1.2.2 -D\n\n#pnpm\npnpm add devcert@1.2.2 -D\n\n\nThen configure dev.https to true:\n\nexport default {\n  dev: {\n    https: true,\n  },\n};\n\n\nThe devcert has some limitations, it does not currently support IP addresses\nyet.\n\nTIP\nThe https proxy automatically installs the certificate and needs root authority,\nplease enter the password according to the prompt.The password is only used to\ntrust the certificate, and will not be leaked or be used elsewhere.\n\nManually set the certificate#\n\nYou can also manually pass in the certificate and the private key required in\nthe dev.https option. This parameter will be directly passed to the createServer\nmethod of the https module in Node.js.\n\nFor details, please refer to https.createServer.\n\n\n\nexport default {\n  dev: {\n    https: {\n      key: fs.readFileSync('certificates/private.pem'),\n      cert: fs.readFileSync('certificates/public.pem'),\n    },\n  },\n};\n\n\n\ndev.port#\n\n * Type: number\n * Default: 8080\n\nSpecify a port number for Dev Server to listen.\n\nBy default, Dev Server listens on port 8080 and automatically increments the\nport number when the port is occupied.\n\n\nExample#\n\nSet the port to 3000:\n\nexport default {\n  dev: {\n    port: 3000,\n  },\n};\n\n\n\ndev.progressBar#\n\n * Type:\n\ntype ProgressBar =\n  | boolean\n  | {\n      id?: string;\n    };\n\n\n * Default: true\n\nWhether to display progress bar during compilation.\n\nexport default {\n  dev: {\n    progressBar: false,\n  },\n};\n\n\nIf you need to modify the text displayed on the left side of the progress bar,\nyou can set the id option:\n\nexport default {\n  dev: {\n    progressBar: {\n      id: 'Some Text',\n    },\n  },\n};\n\n\n\ndev.startUrl#\n\n * Type: boolean | string | string[] | undefined\n * Default: undefined\n\ndev.startUrl is used to set the URL of the page that automatically opens in the\nbrowser when Dev Server starts.\n\nBy default, no page will be opened.\n\nYou can set it to the following values:\n\nexport default {\n  dev: {\n    // Open the project's default preview page, equivalent to `http://localhost:`\n    startUrl: true,\n    // Open the specified page\n    startUrl: 'http://localhost:8080',\n    // Open multiple pages\n    startUrl: ['http://localhost:8080', 'http://localhost:8080/about'],\n  },\n};\n\n\n\nPort placeholder#\n\nSince the port number may change, you can use the placeholder to refer to the\ncurrent port number, and Builder will automatically replace the placeholder with\nthe actual listening port number.\n\nexport default {\n  dev: {\n    startUrl: 'http://localhost:/home',\n  },\n};\n","frontmatter":{"extractApiHeaders":[2]}},{"id":4,"title":"Experiments Config","routePath":"/builder/en/api/config-experiments","lang":"en","toc":[{"text":"experiments.lazyCompilation","id":"experiments.lazycompilation","depth":2},{"text":"Lazy Compilation for Dynamic Imports","id":"lazy-compilation-for-dynamic-imports","depth":3},{"text":"Lazy Compilation for Entires","id":"lazy-compilation-for-entires","depth":3},{"text":"Limitations","id":"limitations","depth":3},{"text":"Disable split chunks","id":"disable-split-chunks","depth":4},{"text":"Use proxy","id":"use-proxy","depth":4}],"domain":"","content":"#\n\nThis section describes some experimental configs in the Builder, which can\nenable unstable features in Builder.\n\nIf you meet issues with experimental features, please disable the config first\nand report through GitHub Issues.\n\n\nexperiments.lazyCompilation#\n\n * Type:\n\ntype LazyCompilationOptions =\n  | boolean\n  | {\n      // Whether to enable lazy compilation for entries\n      entries?: boolean;\n      // Whether to enable lazy compilation for dynamic imports\n      imports?: boolean;\n    };\n\n\n * Default: false\n * Bundler: only support webpack\n\nUsed to enable the lazy compilation (i.e. compile on demand). When this config\nis enabled, Builder will compile entrypoints and dynamic imports only when they\nare used. It will improve the compilation startup time of the project.\n\nLazy compilation only takes effect in the development.\n\n\nLazy Compilation for Dynamic Imports#\n\nLazy compile async modules introduced by Dynamic Import:\n\nexport default {\n  experiments: {\n    lazyCompilation: {\n      imports: true,\n      entries: false,\n    },\n  },\n};\n\n\nWhen imports option is enabled, all async modules will only be compiled when\nrequested. If your project is a single-page application, and routing is split\nthrough Dynamic Import, there will be a significant effect of speeding up\ncompilation.\n\n\nLazy Compilation for Entires#\n\nIn addition to lazy compilation for async modules, you can also choose to lazily\ncompile both entries and async modules at the same time.\n\nexport default {\n  experiments: {\n    lazyCompilation: {\n      imports: true,\n      entries: true,\n    },\n  },\n};\n\n\nThe above config can also be simplified to:\n\nexport default {\n  experiments: {\n    lazyCompilation: true,\n  },\n};\n\n\nWhen entries option is enabled, all pages will not be compiled when the\ncompilation is started, and the page will be compiled only when you visit it.\n\nWhen using lazy compilation for entries, there are some considerations:\n\n * Only work for multi-page applications, no work for single-page applications.\n * when you visit a page, there will be a white screen for a period of time due\n   to waiting for the page to be compiled.\n\n\nLimitations#\n\nDisable split chunks#\n\nWhen you enable lazy compilation, in order to ensure the compilation results,\nBuilder will disable split chunks in the development. This will not affect the\nbuild results in the production, but will cause a difference between the build\nresults of the development and production.\n\nUse proxy#\n\nLazy Compilation relies on the local development server of webpack. When you\nproxy a domain name to localhost, Lazy Compilation will not work properly.\nTherefore, if you need to develop with proxy, please disable Lazy Compilation.","frontmatter":{"extractApiHeaders":[2]}},{"id":5,"title":"Html Config","routePath":"/builder/en/api/config-html","lang":"en","toc":[{"text":"html.appIcon","id":"html.appicon","depth":2},{"text":"Example","id":"example","depth":3},{"text":"html.crossorigin","id":"html.crossorigin","depth":2},{"text":"Example","id":"example-1","depth":3},{"text":"html.disableHtmlFolder","id":"html.disablehtmlfolder","depth":2},{"text":"Example","id":"example-2","depth":3},{"text":"html.favicon","id":"html.favicon","depth":2},{"text":"Example","id":"example-3","depth":3},{"text":"html.faviconByEntries","id":"html.faviconbyentries","depth":2},{"text":"Example","id":"example-4","depth":3},{"text":"html.inject","id":"html.inject","depth":2},{"text":"Default inject position","id":"default-inject-position","depth":4},{"text":"Inject into body","id":"inject-into-body","depth":4},{"text":"html.injectByEntries","id":"html.injectbyentries","depth":2},{"text":"Example","id":"example-5","depth":3},{"text":"html.meta","id":"html.meta","depth":2},{"text":"String Type","id":"string-type","depth":4},{"text":"Object Type","id":"object-type","depth":4},{"text":"Remove Default Value","id":"remove-default-value","depth":3},{"text":"html.metaByEntries","id":"html.metabyentries","depth":2},{"text":"Example","id":"example-6","depth":3},{"text":"html.tags","id":"html.tags","depth":2},{"text":"Tag Object","id":"tag-object","depth":4},{"text":"Tags Handler","id":"tags-handler","depth":4},{"text":"html.tagsByEntries","id":"html.tagsbyentries","depth":2},{"text":"Example","id":"example-7","depth":3},{"text":"html.mountId","id":"html.mountid","depth":2},{"text":"Example","id":"example-8","depth":3},{"text":"Notes","id":"notes","depth":3},{"text":"Update Relevant Code","id":"update-relevant-code","depth":4},{"text":"Custom Templates","id":"custom-templates","depth":4},{"text":"html.template","id":"html.template","depth":2},{"text":"Example","id":"example-9","depth":3},{"text":"html.templateByEntries","id":"html.templatebyentries","depth":2},{"text":"Example","id":"example-10","depth":3},{"text":"html.templateParameters","id":"html.templateparameters","depth":2},{"text":"Example","id":"example-11","depth":3},{"text":"html.templateParametersByEntries","id":"html.templateparametersbyentries","depth":2},{"text":"Example","id":"example-12","depth":3},{"text":"html.title","id":"html.title","depth":2},{"text":"html.titleByEntries","id":"html.titlebyentries","depth":2},{"text":"Example","id":"example-13","depth":3}],"domain":"","content":"","frontmatter":{"extractApiHeaders":[2]}},{"id":6,"title":"Output Config","routePath":"/builder/en/api/config-output","lang":"en","toc":[{"text":"output.assetPrefix","id":"output.assetprefix","depth":2},{"text":"Example","id":"example","depth":3},{"text":"output.assetsRetry","id":"output.assetsretry","depth":2},{"text":"assetsRetry.max","id":"assetsretry.max","depth":3},{"text":"assetsRetry.domain","id":"assetsretry.domain","depth":3},{"text":"assetsRetry.type","id":"assetsretry.type","depth":3},{"text":"assetsRetry.test","id":"assetsretry.test","depth":3},{"text":"assetsRetry.crossOrigin","id":"assetsretry.crossorigin","depth":3},{"text":"assetsRetry.onRetry","id":"assetsretry.onretry","depth":3},{"text":"assetsRetry.onSuccess","id":"assetsretry.onsuccess","depth":3},{"text":"assetsRetry.onFail","id":"assetsretry.onfail","depth":3},{"text":"output.charset","id":"output.charset","depth":2},{"text":"output.cleanDistPath","id":"output.cleandistpath","depth":2},{"text":"output.convertToRem","id":"output.converttorem","depth":2},{"text":"Boolean Type","id":"boolean-type","depth":4},{"text":"Object Type","id":"object-type","depth":4},{"text":"Example","id":"example-1","depth":3},{"text":"output.copy","id":"output.copy","depth":2},{"text":"output.cssModuleLocalIdentName","id":"output.cssmodulelocalidentname","depth":2},{"text":"Default Value","id":"default-value","depth":3},{"text":"Template String","id":"template-string","depth":3},{"text":"Example","id":"example-2","depth":3},{"text":"output.dataUriLimit","id":"output.dataurilimit","depth":2},{"text":"Example","id":"example-3","depth":3},{"text":"output.disableCssExtract","id":"output.disablecssextract","depth":2},{"text":"Example","id":"example-4","depth":3},{"text":"output.disableCssModuleExtension","id":"output.disablecssmoduleextension","depth":2},{"text":"Example","id":"example-5","depth":3},{"text":"Detailed","id":"detailed","depth":3},{"text":"disableCssModuleExtension is false (default)","id":"disablecssmoduleextension-is-false-(default)","depth":4},{"text":"disableCssModuleExtension is true","id":"disablecssmoduleextension-is-true","depth":4},{"text":"output.distPath","id":"output.distpath","depth":2},{"text":"Example","id":"example-6","depth":3},{"text":"output.disableMinimize","id":"output.disableminimize","depth":2},{"text":"output.disableSourceMap","id":"output.disablesourcemap","depth":2},{"text":"output.disableTsChecker","id":"output.disabletschecker","depth":2},{"text":"Blocking Compilation","id":"blocking-compilation","depth":3},{"text":"Example","id":"example-7","depth":3},{"text":"output.disableFilenameHash","id":"output.disablefilenamehash","depth":2},{"text":"Example","id":"example-8","depth":3},{"text":"output.disableInlineRuntimeChunk","id":"output.disableinlineruntimechunk","depth":2},{"text":"Disable Inlining","id":"disable-inlining","depth":3},{"text":"Merge Into Page Chunk","id":"merge-into-page-chunk","depth":3},{"text":"output.enableAssetManifest","id":"output.enableassetmanifest","depth":2},{"text":"Example","id":"example-9","depth":3},{"text":"output.enableAssetFallback","id":"output.enableassetfallback","depth":2},{"text":"Example","id":"example-10","depth":3},{"text":"output.enableLatestDecorators","id":"output.enablelatestdecorators","depth":2},{"text":"output.enableCssModuleTSDeclaration","id":"output.enablecssmoduletsdeclaration","depth":2},{"text":"Example","id":"example-11","depth":3},{"text":"output.enableInlineScripts","id":"output.enableinlinescripts","depth":2},{"text":"Example","id":"example-12","depth":3},{"text":"output.enableInlineStyles","id":"output.enableinlinestyles","depth":2},{"text":"Example","id":"example-13","depth":3},{"text":"output.externals","id":"output.externals","depth":2},{"text":"Example","id":"example-14","depth":3},{"text":"output.filename","id":"output.filename","depth":2},{"text":"Example","id":"example-15","depth":3},{"text":"output.legalComments","id":"output.legalcomments","depth":2},{"text":"Example","id":"example-16","depth":3},{"text":"output.overrideBrowserslist","id":"output.overridebrowserslist","depth":2},{"text":"Priority","id":"priority","depth":4},{"text":"Default Value","id":"default-value-1","depth":4},{"text":"Example","id":"example-17","depth":3},{"text":"Set according to Targets","id":"set-according-to-targets","depth":4},{"text":"output.polyfill","id":"output.polyfill","depth":2},{"text":"Config","id":"config","depth":3},{"text":"entry","id":"entry","depth":4},{"text":"usage","id":"usage","depth":4},{"text":"ua","id":"ua","depth":4},{"text":"off","id":"off","depth":4},{"text":"output.svgDefaultExport","id":"output.svgdefaultexport","depth":2}],"domain":"","content":"","frontmatter":{"extractApiHeaders":[2]}},{"id":7,"title":"Performance Config","routePath":"/builder/en/api/config-performance","lang":"en","toc":[{"text":"performance.buildCache","id":"performance.buildcache","depth":2},{"text":"performance.bundleAnalyze","id":"performance.bundleanalyze","depth":2},{"text":"performance.chunkSplit","id":"performance.chunksplit","depth":2},{"text":"chunkSplit.strategy","id":"chunksplit.strategy","depth":3},{"text":"Default Strategy","id":"default-strategy","depth":3},{"text":"chunkSplit.minSize","id":"chunksplit.minsize","depth":3},{"text":"chunkSplit.maxSize","id":"chunksplit.maxsize","depth":3},{"text":"chunkSplit.forceSplitting","id":"chunksplit.forcesplitting","depth":3},{"text":"chunkSplit.splitChunks","id":"chunksplit.splitchunks","depth":3},{"text":"chunkSplit.override","id":"chunksplit.override","depth":3},{"text":"performance.printFileSize","id":"performance.printfilesize","depth":2},{"text":"Example","id":"example","depth":3},{"text":"performance.profile","id":"performance.profile","depth":2},{"text":"Example","id":"example-1","depth":3},{"text":"performance.removeConsole","id":"performance.removeconsole","depth":2},{"text":"Remove all consoles","id":"remove-all-consoles","depth":4},{"text":"Remove specific console","id":"remove-specific-console","depth":4},{"text":"performance.removeMomentLocale","id":"performance.removemomentlocale","depth":2}],"domain":"","content":"#\n\nThis section describes some performance related configurations in Modern.js\nBuilder.\n\n\nperformance.buildCache#\n\n * Type:\n\ntype BuildCacheConfig =\n  | {\n      /**\n       * Base directory for the filesystem cache.\n       */\n      cacheDirectory?: string;\n    }\n  | boolean;\n\n\n * Default:\n\nconst defaultBuildCacheConfig = {\n  cacheDirectory: './node_modules/.cache/webpack',\n};\n\n\n * Bundler: only support webpack\n\nControls the Builder's caching behavior during the build process.\n\nBuilder will enable build cache by default to improve the compile speed, the\ngenerated cache files are write to the ./node_modules/.cache/webpack directory\nby default.\n\nYou can configure the cache path with buildCache, e.g.\n\nexport default {\n  performance: {\n    buildCache: {\n      cacheDirectory: './node_modules/.custom_cache/webpack',\n    },\n  },\n};\n\n\nYou can also disable the build cache by setting it to false:\n\nexport default {\n  performance: {\n    buildCache: false,\n  },\n};\n\n\n\nperformance.bundleAnalyze#\n\n * Type: Object | undefined\n\nYou have two ways to enable webpack-bundle-analyzer to analyze the size of\noutput files:\n\n * Add environment variable BUNDLE_ANALYZE=true.\n * Add performance.bundleAnalyze config.\n\nBy default, webpack-bundle-analyzer is not enabled. When enabled, its\nconfiguration is as follows:\n\n{\n  analyzerMode: 'static',\n  openAnalyzer: false,\n  // `target` is the compilation target, such as `web`, `node`, etc.\n  reportFilename: `report-${target}.html`,\n}\n\n\nYou can override the default config through performance.bundleAnalyze, for\nexample:\n\nexport default {\n  performance: {\n    bundleAnalyze: {\n      analyzerMode: 'server',\n      openAnalyzer: true,\n    },\n  },\n};\n\n\n\nperformance.chunkSplit#\n\n * Type: Object\n * Default: { strategy: 'split-by-experience' }\n\nperformance.chunkSplit is used to configure the chunk splitting strategy. The\ntype of ChunkSplit is as follows:\n\ntype ForceSplitting = RegExp[] | Record;\n\ninterface BaseChunkSplit {\n  strategy?:\n    | 'split-by-module'\n    | 'split-by-experience'\n    | 'all-in-one'\n    | 'single-vendor';\n  override?: SplitChunks;\n  forceSplitting?: ForceSplitting;\n}\n\ninterface SplitBySize {\n  strategy?: 'split-by-size';\n  minSize?: number;\n  maxSize?: number;\n  override?: SplitChunks;\n  forceSplitting?: ForceSplitting;\n}\n\ninterface SplitCustom {\n  strategy?: 'custom';\n  splitChunks?: SplitChunks;\n  forceSplitting?: ForceSplitting;\n}\n\nexport type ChunkSplit = BaseChunkSplit | SplitBySize | SplitCustom;\n\n\n\nchunkSplit.strategy#\n\nBuilder supports the following chunk splitting strategies:\n\n * split-by-experience: an empirical splitting strategy, automatically splits\n   some commonly used npm packages into chunks of moderate size.\n\n * split-by-module: split by NPM package granularity, each NPM package\n   corresponds to a chunk.\n\n * split-by-size: automatically split according to module size.\n\n * all-in-one: bundle all codes into one chunk.\n\n * single-vendor: bundle all NPM packages into a single chunk.\n\n * custom: custom chunk splitting strategy.\n\n\nDefault Strategy#\n\nBuilder adopts the split-by-experience strategy by default, which is a strategy\nwe have developed from experience. Specifically, when the following npm packages\nare referenced in your project, they will automatically be split into separate\nchunks:\n\n * lib-polyfill.js: includes core-js, @babel/runtime, @swc/helpers.\n * lib-react.js: includes react, react-dom.\n * lib-router.js: includes react-router, react-router-dom, history,\n   @remix-run/router.\n * lib-lodash.js: includes lodash, lodash-es.\n * lib-antd.js: includes antd.\n * lib-arco.js: includes @arco-design/web-react.\n * lib-semi.js: includes @douyinfe/semi-ui.\n\nTIP\nIf the above npm packages are not installed or used in the project, the\ncorresponding chunk will not be generated.\n\nIf you want to use other splitting strategies, you can specify it via\nperformance.chunkSplit.strategy.\n\nTIP\nThe split-by-module strategy is not supported when using Rspack as the bundler.\n\n\nchunkSplit.minSize#\n\n * Type: number\n * Default: 10000\n\nWhen performance.chunkSplit.strategy is split-by-size, you can specify the\nminimum size of a chunk via performance.chunkSplit.minSize, the unit is bytes.\nThe default value is 10000. For example:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-size',\n      minSize: 20000,\n    },\n  },\n};\n\n\n\nchunkSplit.maxSize#\n\n * Type: number\n * Default: Infinity\n\nWhen performance.chunkSplit.strategy is split-by-size, you can specify the\nmaximum size of a chunk via performance.chunkSplit.maxSize, the unit is bytes.\nThe default value is Infinity. For example:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-size',\n      maxSize: 50000,\n    },\n  },\n};\n\n\n\nchunkSplit.forceSplitting#\n\n * Type: RegExp[] | Record\n * Default: []\n\nVia performance.chunkSplit.forceSplitting, you can specify the NPM packages that\nneed to be forced to split.\n\nFor example, split the axios library under node_modules into axios.js:\n\nexport default {\n   performance: {\n     chunkSplit: {\n       strategy: 'split-by-experience',\n       forceSplitting: {\n         axios: /node_modules\\/axios/,\n       },\n     },\n   },\n};\n\n\nThis is an easier way than configuring webpack's splitChunks directly.\n\n\nchunkSplit.splitChunks#\n\nWhen performance.chunkSplit.strategy is custom, you can specify the custom\nwebpack chunk splitting config via performance.chunkSplit.splitChunks. This\nconfig will be merged with the webpack splitChunks config (the cacheGroups\nconfig will also be merged). For example:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'custom',\n      splitChunks: {\n        cacheGroups: {\n          react: {\n            test: /[\\\\/]node_modules[\\\\/](react|react-dom)[\\\\/]/,\n            name: 'react',\n            chunks: 'all',\n          },\n        },\n      },\n    },\n  },\n};\n\n\n\nchunkSplit.override#\n\nWhen performance.chunkSplit.strategy is split-by-experience, split-by-module,\nsplit-by-size or single-vendor, you can specify the custom webpack chunk\nsplitting config via performance.chunkSplit.override. This config will be merged\nwith the webpack splitChunks config (the cacheGroups config will also be\nmerged). For example:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-experience',\n      override: {\n        cacheGroups: {\n          react: {\n            test: /[\\\\/]node_modules[\\\\/](react|react-dom)[\\\\/]/,\n            name: 'react',\n            chunks: 'all',\n          },\n        },\n      },\n    },\n  },\n};\n\n\n> When the Builder target is \"node\", since Node Bundles do not need to be\n> splitted to optimize loading performance, the chunkSplit rule will not take\n> effect.\n\n\nperformance.printFileSize#\n\n * Type: boolean\n * Default: true\n\nWhether to print the file sizes after production build.\n\ninfo    File sizes after production build:\n\n  File                                     Size         Gzipped\n  dist/static/js/lib-corejs.1c836fe7.js    212.89 kB    66.57 kB\n  dist/static/js/lib-react.fcafbc5c.js     134.65 kB    43.45 kB\n  dist/static/js/main.6ff06f70.js          8.93 kB      3.73 kB\n  dist/static/css/main.9f48031b.css        2.64 kB      927 B\n  dist/html/main/index.html                1.64 kB      874 B\n\n\n\nExample#\n\nDisable the logs:\n\nexport default {\n  performance: {\n    printFileSize: false,\n  },\n};\n\n\n\nperformance.profile#\n\n * Type: boolean\n * Default: false\n * Bundler: only support webpack\n\nWhether capture timing information for each module, same as the profile config\nof webpack.\n\n\nExample#\n\nexport default {\n  performance: {\n    profile: true,\n  },\n};\n\n\nWhen turned on, webpack generates a JSON file with some statistics about the\nmodule that includes information about timing information for each module.\n\n\nperformance.removeConsole#\n\n * Type: boolean | ConsoleType[]\n * Default: false\n\nWhether to remove console.xx in production build.\n\nRemove all consoles#\n\nWhen removeConsole is set to true, all types of console.xx are removed:\n\nexport default {\n  performance: {\n    removeConsole: true,\n  },\n};\n\n\nRemove specific console#\n\nYou can also specify to remove only certain types of console.xx, such as\nconsole.log and console.warn:\n\nexport default {\n  performance: {\n    removeConsole: ['log', 'warn'],\n  },\n};\n\n\nThe following types of console are currently supported:\n\ntype ConsoleType = 'log' | 'info' | 'warn' | 'error' | 'table' | 'group';\n\n\n\nperformance.removeMomentLocale#\n\n * Type: boolean\n * Default: false\n * Bundler: only support webpack\n\nWhether to remove the locales of moment.js.\n\nmoment.js contains a lot of locales by default, which will increase the bundle\nsize.\n\nWhen moment.js is used in the project, it is recommended to enable this option\nto automatically exclude all locales:\n\nexport default {\n  performance: {\n    removeMomentLocale: true,\n  },\n};\n\n\nOnce enabled, you can load a specific locale via:\n\n\nimport 'moment/locale/zh-cn';\n\nmoment.locale('zh-cn');\n","frontmatter":{"extractApiHeaders":[2]}},{"id":8,"title":"Security Config","routePath":"/builder/en/api/config-security","lang":"en","toc":[{"text":"security.sri","id":"security.sri","depth":2},{"text":"Introduce SRI","id":"introduce-sri","depth":4},{"text":"Example","id":"example","depth":4},{"text":"security.checkSyntax","id":"security.checksyntax","depth":2},{"text":"Example","id":"example-1","depth":3},{"text":"Error Log","id":"error-log","depth":3},{"text":"Solution","id":"solution","depth":3}],"domain":"","content":"#\n\nThis section describes some security related configurations in Modern.js\nBuilder.\n\n\nsecurity.sri#\n\n * Type:\n\ntype SRIOptions =\n  | {\n      hashFuncNames?: string[];\n      enabled?: 'auto' | boolean;\n      hashLoading?: 'eager' | 'lazy';\n    }\n  | boolean;\n\n\n * Default: undefined\n * Bundler: only support webpack\n\nAdding an integrity attribute (integrity) to sub-resources introduced by HTML\nallows the browser to verify the integrity of the introduced resource, thus\npreventing tampering with the downloaded resource.\n\nEnabling this option will set the webpack output.crossOriginLoading\nconfiguration item to anonymous.\n\nIntroduce SRI#\n\nSubresource Integrity (SRI) is a security feature that enables browsers to\nverify that resources they fetch (for example, from a CDN) are delivered without\nunexpected manipulation. It works by allowing you to provide a cryptographic\nhash that a fetched resource must match.\n\nFor script tags, the result is to refuse to execute the code; for CSS links, the\nresult is not to load the styles.\n\nFor more on subresource integrity, see Subresource Integrity - MDN.\n\nExample#\n\nBy default, SRI is not turned on, and when it is, its default configuration is\nas follows:\n\n{\n  hashFuncNames: ['sha384'];\n  enabled: \"auto\",\n  hashLoading: \"eager\",\n}\n\n\nYou can customize the configuration items according to your own needs:\n\nexport default {\n  security: {\n    sri: {\n      hashFuncNames: ['sha-256'],\n      enabled: true,\n      hashLoading: 'lazy',\n    },\n  },\n};\n\n\n\nsecurity.checkSyntax#\n\n * Type:\n\ntype CheckSyntax =\n  | boolean\n  | {\n      targets: string[];\n      exclude?: RegExp | Array;\n    };\n\n\n * Default: false\n * Bundler: only support webpack\n\nAnalyzes the build output files for the presence of high-level syntax that is\nincompatible with the current browserslist. If present, the details will be\nprinted in the terminal.\n\n\nExample#\n\nexport default {\n  security: {\n    checkSyntax: true,\n    exclude: /node_modules\\/foo/,\n  },\n};\n\n\nIf security.checkSyntax is specified as true, targets will be recognized as the\nbrowserslist set by the project. For details, please refer to Browserslist.\n\nWhen enabled, it will be detected in the production environment, and when an\nincompatible advanced syntax is detected, it will not only print the error logs\non the terminal but also exit the build process.\n\n\nError Log#\n\nThe format of the error log is as follows, including the source file, output\nlocation, error reason and source code:\n\nerror [Syntax Checker] Find some syntax errors after production build:\n\n   ERROR#1:\n   source - /node_modules/foo/index.js:1:0\n   output - /Project/dist/static/js/main.3f7a4d7e.js:2:39400\n   reason - The keyword 'const' is reserved (2:39400)\n   code - const foo = 'bar';\n\n\n\nSolution#\n\nIf a syntax error is detected, you can handle it in the following ways:\n\n * If you want to downgrade this syntax to ensure good code compatibility, you\n   can compile the corresponding module through the source.include config.\n * If you don't want to downgrade the syntax, you can adjust the project's\n   browserslist to match the syntax.\n * If you do not want to check the syntax of certain products, you can use the\n   checkSyntax.exclude configuration to exclude the files to be checked.","frontmatter":{"extractApiHeaders":[2]}},{"id":9,"title":"Source Config","routePath":"/builder/en/api/config-source","lang":"en","toc":[{"text":"source.alias","id":"source.alias","depth":2},{"text":"Object Type","id":"object-type","depth":4},{"text":"Function Type","id":"function-type","depth":4},{"text":"source.include","id":"source.include","depth":2},{"text":"Compile Npm Packages","id":"compile-npm-packages","depth":3},{"text":"Compile Sub Dependencies","id":"compile-sub-dependencies","depth":3},{"text":"Compile Libraries in Monorepo","id":"compile-libraries-in-monorepo","depth":3},{"text":"Compile CommonJS Module","id":"compile-commonjs-module","depth":3},{"text":"Matching Symlink","id":"matching-symlink","depth":3},{"text":"Precautions","id":"precautions","depth":3},{"text":"source.exclude","id":"source.exclude","depth":2},{"text":"source.compileJsDataURI","id":"source.compilejsdatauri","depth":2},{"text":"Example","id":"example","depth":3},{"text":"source.define","id":"source.define","depth":2},{"text":"Example","id":"example-1","depth":3},{"text":"source.globalVars","id":"source.globalvars","depth":2},{"text":"Example","id":"example-2","depth":3},{"text":"source.moduleScopes","id":"source.modulescopes","depth":2},{"text":"Example","id":"example-3","depth":3},{"text":"Array Type","id":"array-type","depth":4},{"text":"Function Type","id":"function-type-1","depth":4},{"text":"source.transformImport","id":"source.transformimport","depth":2},{"text":"Example","id":"example-4","depth":3},{"text":"Configuration","id":"configuration","depth":3},{"text":"libraryName","id":"libraryname","depth":4},{"text":"libraryDirectory","id":"librarydirectory","depth":4},{"text":"style","id":"style","depth":4},{"text":"styleLibraryDirectory","id":"stylelibrarydirectory","depth":4},{"text":"camelToDashComponentName","id":"cameltodashcomponentname","depth":4},{"text":"transformToDefaultImport","id":"transformtodefaultimport","depth":4},{"text":"customName","id":"customname","depth":4},{"text":"customStyleName","id":"customstylename","depth":4},{"text":"source.preEntry","id":"source.preentry","depth":2},{"text":"Add a single script","id":"add-a-single-script","depth":4},{"text":"Add global style","id":"add-global-style","depth":4},{"text":"Add multiple scripts","id":"add-multiple-scripts","depth":4},{"text":"source.resolveExtensionPrefix","id":"source.resolveextensionprefix","depth":2},{"text":"Example","id":"example-5","depth":3},{"text":"Set according to Targets","id":"set-according-to-targets","depth":4},{"text":"source.resolveMainFields","id":"source.resolvemainfields","depth":2},{"text":"Example","id":"example-6","depth":3},{"text":"Set according to Targets","id":"set-according-to-targets-1","depth":4}],"domain":"","content":"#\n\nThis section describes configs related to source code parsing and compilation in\nModern.js Builder.\n\n\nsource.alias#\n\n * Type: Record | Function\n * Default: undefined\n\nCreate aliases to import or require certain modules, same as the resolve.alias\nconfig of webpack.\n\nTIP\nFor TypeScript projects, you only need to configure compilerOptions.paths in\ntsconfig.json, Builder will automatically recognize the aliases in\ntsconfig.json, so the alias config is unnecessary.\nTIP\nWhen using Rspack as the bundler, only the Record | Function type is supported.\n\nObject Type#\n\nThe alias can be an Object, and the relative path will be automatically\nconverted to absolute path.\n\nexport default {\n  source: {\n    alias: {\n      '@common': './src/common',\n    },\n  },\n};\n\n\nWith above configuration, if @common/Foo.tsx is import in the code, it will be\nmapped to the /src/common/Foo.tsx path.\n\nFunction Type#\n\nThe alias can be a function, it will accept the previous alias object, and you\ncan modify it.\n\nexport default {\n  source: {\n    alias: alias => {\n      alias['@common'] = './src/common';\n    },\n  },\n};\n\n\nYou can also return a new object as the final result in the function, which will\nreplace the previous alias object.\n\nexport default {\n  source: {\n    alias: alias => {\n      return {\n        '@common': './src/common',\n      };\n    },\n  },\n};\n\n\n\nsource.include#\n\n * Type: Array\n * Default: []\n\nIn order to maintain faster compilation speed, Builder will not compile\nJavaScript/TypeScript files under node_modules through babel-loader or ts-loader\nby default, as will as the JavaScript/TypeScript files outside the current\nproject directory.\n\nThrough the source.include config, you can specify directories or modules that\nneed to be compiled by Builder. The usage of source.include is consistent with\nRule.include in webpack, which supports passing in strings or regular\nexpressions to match the module path.\n\nFor example:\n\n\n\nexport default {\n  source: {\n    include: [path.resolve(__dirname, '../other-dir')],\n  },\n};\n\n\n\nCompile Npm Packages#\n\nA typical usage scenario is to compile npm packages under node_modules, because\nsome third-party dependencies have ES6+ syntax, which may cause them to fail to\nrun on low-version browsers. You can solve the problem by using this config to\nspecify the dependencies that need to be compiled.\n\nTake query-string as an example, you can add the following config:\n\n\n\nexport default {\n  source: {\n    include: [\n      // Method 1:\n      // First get the path of the module by require.resolve\n      // Then pass path.dirname to point to the corresponding directory\n      path.dirname(require.resolve('query-string')),\n      // Method 2:\n      // Match by regular expression\n      // All paths containing `/query-string/` will be matched\n      /\\/query-string\\//,\n    ],\n  },\n};\n\n\n> Note that this config will only compile the code of query-string itself, not\n> the sub-dependencies of query-string. If you need to compile a sub-dependency\n> of query-string, you need to add the corresponding npm package to\n> source.include.\n\n\nCompile Sub Dependencies#\n\nWhen you compile an npm package via source.include, Builder will only compile\nthe matching module by default, not the Sub Dependencies of the module.\n\nTake query-string for example, it depends on the decode-uri-component package,\nwhich also has ES6+ code, so you need to add the decode-uri-component package to\nsource.include as well.\n\nexport default {\n  source: {\n    include: [/\\/query-string\\//, /\\/decode-uri-component\\//],\n  },\n};\n\n\n\nCompile Libraries in Monorepo#\n\nWhen developing in Monorepo, if you need to refer to the source code of other\nlibraries in Monorepo, you can add the corresponding library to source.include:\n\n\n\nexport default {\n  source: {\n    include: [\n      // Method 1:\n      // Compile all files in Monorepo's package directory\n      path.resolve(__dirname, '../../packages'),\n\n      // Method 2:\n      // Compile the source code of a package in Monorepo's package directory\n      // This way of writing matches the range more accurately and has less impact on the overall build performance.\n      path.resolve(__dirname, '../../packages/xxx/src'),\n    ],\n  },\n};\n\n\n\nCompile CommonJS Module#\n\nBabel cannot compile CommonJS modules by default, and if you compile a CommonJS\nmodule, you may get a runtime error message exports is not defined.\n\nWhen you need to compile a CommonJS module using source.include, you can set\nBabel's sourceType configuration to unambiguous.\n\nexport default {\n  tools: {\n    babel(config) {\n      config.sourceType = 'unambiguous';\n    },\n  },\n};\n\n\nSetting sourceType to unambiguous may have some other effects, please refer to\nBabel official documentation.\n\n\nMatching Symlink#\n\nIf you match a module that is symlinked to the current project, then you need to\nmatch the real path of the module, not the symlinked path.\n\nFor example, if you symlink the packages/foo path in Monorepo to the\nnode_modules/foo path of the current project, you need to match the packages/foo\npath, not the node_modules/foo path.\n\nThis behavior can be controlled via webpack's resolve.symlinks config.\n\n\nPrecautions#\n\nNote that source.include should not be used to compile the entire node_modules\ndirectory. For example, the following usage is wrong:\n\nexport default {\n  source: {\n    include: [/\\/node_modules\\//],\n  },\n};\n\n\nIf you compile the entire node_modules, not only will the build time be greatly\nincreased, but also unexpected errors may occur. Because most of the npm\npackages in node_modules are already compiled, there is usually no need for a\nsecond compilation. In addition, exceptions may occur after npm packages such as\ncore-js are compiled.\n\n\nsource.exclude#\n\n * Type: Array\n * Default: []\n\nSpecifies JavaScript/TypeScript files that do not need to be compiled. The usage\nis consistent with Rule.exclude in webpack, which supports passing in strings or\nregular expressions to match the module path.\n\nFor example:\n\n\n\nexport default {\n  source: {\n    exclude: [path.resolve(__dirname, 'src/module-a'), /src\\/module-b/],\n  },\n};\n\n\n\nsource.compileJsDataURI#\n\n * Type: boolean\n * Default: true\n\nWhether to compile JavaScript code imported via Data URI.\n\nSuch as:\n\n\n\nimport 'data:text/javascript;charset=utf-8;base64,Y29uc29sZS5sb2coJ2lubGluZSAxJyk7';\n\n\n\nExample#\n\nAdd the following config to disable:\n\nexport default {\n  source: {\n    compileJsDataURI: false,\n  },\n};\n\n\n\nsource.define#\n\n * Type: Record\n * Default: {}\n\nReplaces variables in your code with other values or expressions at compile\ntime. This can be useful for allowing different behavior between development\nbuilds and production builds.\n\nEach key passed into options is an identifier or multiple identifiers joined\nwith ..\n\n * If the value is a string it will be used as a code fragment.\n * If the value isn't a string, it will be stringified (including functions).\n * If the value is an object all keys are defined the same way.\n * If you prefix typeof to the key, it's only defined for typeof calls.\n\nFor more information please visit https://webpack.js.org/plugins/define-plugin/.\n\nTIP\nWhen using Rspack as the bundler, the supported types can be found in\nRspack.builtins.define.\n\n\nExample#\n\nexport default {\n  source: {\n    define: {\n      PRODUCTION: JSON.stringify(true),\n      VERSION: JSON.stringify('5fa3b9'),\n      BROWSER_SUPPORTS_HTML5: true,\n      TWO: '1 + 1',\n      'typeof window': JSON.stringify('object'),\n      'process.env.NODE_ENV': JSON.stringify(process.env.NODE_ENV),\n      'import.meta': { test: undefined },\n    },\n  },\n};\n\n\nExpressions will be replaced with the corresponding code fragments:\n\nconst foo = TWO;\n\n//  Turn into being...\nconst foo = 1 + 1;\n\n\n\nsource.globalVars#\n\n * Type: Record\n * Default:\n\nconst defaultGlobalVars = {\n  // The environment variable `process.env.NODE_ENV` will be added by default,\n  // so you don't need to set it in manually.\n  'process.env.NODE_ENV': JSON.stringify(process.env.NODE_ENV),\n};\n\n\nDefine global variables. It can replace expressions like process.env.FOO in your\ncode after compile. Such as:\n\nconsole.log(process.env.NODE_ENV);\n\n//  Turn into being...\nconsole.log('development');\n\n\nDoesn't works with destructuring assignment, because builder does not know if\nNODE_ENV and process.env.NODE_ENV are associated:\n\nconst { NODE_ENV } = process.env;\nconsole.log(NODE_ENV);\n//  Won't get a string.\n\n\nYou can take source.globalVars as the syntax sugar of source.define, the only\ndifference is that source.globalVars will automatically stringify the value,\nwhich makes it easier to set the value of global variables. The values of\nglobalVars should be JSON-safe to ensure it can be serialized.\n\nexport default {\n  source: {\n    globalVars: {\n      'process.env.BUILD_VERSION': '0.0.1',\n      'import.meta.foo': { bar: 42 },\n      'import.meta.baz': false,\n    },\n    define: {\n      'process.env.BUILD_VERSION': JSON.stringify('0.0.1'),\n      'import.meta': {\n        foo: JSON.stringify({ bar: 42 }),\n        baz: JSON.stringify(false),\n      },\n    },\n  },\n};\n\n\n\nExample#\n\nAdd the following config to use:\n\nexport default {\n  source: {\n    globalVars: {\n      ENABLE_VCONSOLE: true,\n      APP_CONTEXT: { answer: 42 },\n    },\n  },\n};\n\n\n\nsource.moduleScopes#\n\n * Type: Array | Function\n * Default: undefined\n * Bundler: only support webpack\n\nRestrict importing paths. After configuring this option, all source files can\nonly import code from the specific paths, and import code from other paths is\nnot allowed.\n\n\nExample#\n\nFirst, we configure moduleScopes to only include the src directory:\n\nexport default {\n  source: {\n    moduleScopes: ['./src'],\n  },\n};\n\n\nThen we import the utils/a module outside the src directory in src/App.tsx:\n\n\n\n\nAfter compiling, there will be a reference path error:\n\n\n\nIf we configure the utils directory in moduleScopes, the error will disappear.\n\nexport default {\n  source: {\n    moduleScopes: ['./src', './utils'],\n  },\n};\n\n\nArray Type#\n\nYou can directly set several paths like this:\n\nexport default {\n  source: {\n    moduleScopes: ['./src', './shared', './utils'],\n  },\n};\n\n\nFunction Type#\n\nmoduleScopes also supports setting as a function, which can be modified instead\nof overriding the default value:\n\nexport default {\n  source: {\n    moduleScopes: scopes => {\n      scopes.push('./shared');\n    },\n  },\n};\n\n\n\nsource.transformImport#\n\nUsed to import the code and style of the component library on demand, which is\nequivalent to babel-plugin-import.\n\nThe difference from babel-plugin-import is that source.transformImport is not\ncoupled with Babel. The Builder will automatically identify whether the\ncurrently used tools is Babel, SWC or Rspack, and apply the corresponding\non-demand import configuration.\n\n * Type:\n\nArray<{\n  libraryName: string;\n  libraryDirectory?: string;\n  style?: string | boolean;\n  styleLibraryDirectory?: string;\n  camelToDashComponentName?: boolean;\n  transformToDefaultImport?: boolean;\n  customName?: ((member: string) => string | undefined) | string;\n  customStyleName?: ((member: string) => string | undefined) | string;\n}>;\n\n\n * Default:\n\nWhen the antd component library <= 4.x version is installed in the project,\nBuilder will automatically add the corresponding on-demand import configuration.\nThe default configuration is as follows:\n\n{\n  libraryName: 'antd',\n  libraryDirectory: target === 'node' ? 'lib' : 'es',\n  style: true,\n}\n\n\n\nExample#\n\nWhen using the above antd default configuration:\n\n{\n  libraryName: 'antd',\n  libraryDirectory: 'es',\n  style: true,\n}\n\n\nThe source code is as follows:\n\n\n\n\nIt will be transformed into:\n\n\nimport 'antd/es/button/style';\n\n\n\nConfiguration#\n\nlibraryName#\n\n * Type: string\n\nThe original import path that needs to be transformed.\n\nlibraryDirectory#\n\n * Type: string\n * Default: 'lib'\n\nUsed to splice the transformed path, the splicing rule is\n${libraryName}/${libraryDirectory}/${member}, where member is the imported\nmember.\n\nExample:\n\n\n\n\nOut:\n\n\n\n\nstyle#\n\n * Type: boolean\n * Default: undefined\n\nDetermines whether to import related styles. If it is true, the path\n${libraryName}/${libraryDirectory}/${member}/style will be imported. If it is\nfalse or undefined, the style will not be imported.\n\nWhen it is set to true:\n\n\n\n\nOut:\n\n\nimport 'foo/lib/button/style';\n\n\nstyleLibraryDirectory#\n\n * Type: string\n * Default: undefined\n\nThis configuration is used to splice the import path when importing styles. If\nthis configuration is specified, the style configuration item will be ignored.\nThe spliced import path is ${libraryName}/${styleLibraryDirectory}/${member}.\n\nWhen it is set to styles:\n\n\n\n\nOut:\n\n\nimport 'foo/styles/button';\n\n\ncamelToDashComponentName#\n\n * Type: boolean\n * Default: true\n\nWhether to convert camelCase imports to kebab-case.\n\nExample:\n\n\n\n\nOut:\n\n// set to true:\n\n// set to false:\n\n\n\ntransformToDefaultImport#\n\n * Type: boolean\n * Default: true\n\nWhether to convert import statements to default imports.\n\nExample:\n\n\n\n\nOut:\n\n// set to true:\n\n// set to false:\n\n\n\ncustomName#\n\n * Type: ((member: string) => string | undefined) | string\n * Default: undefined\n\nNote\n * Function-type configurations can only be used in Webpack builds.\n * Template-type configurations can only be used in Rspack builds or Webpack\n   builds that use SWC.\n\nCustomize the imported path after conversion. The input is the imported member.\nFor example, configure it as (member) => `my-lib/${member}` , which will convert\nto .\n\nWhen using Rspack to build, function configurations cannot be used, but you can\nuse handlebars template strings. For the above function configuration, you can\nuse the following template instead of my-lib/{{ member }}, or use some built-in\nhelper methods, such as my-lib/{{ kebabCase member }} to convert it to\nkebab-case format. In addition to kebabCase, there are also camelCase,\nsnakeCase, upperCase, and lowerCase that can be used.\n\ncustomStyleName#\n\n * Type: ((member: string) => string | undefined) | string\n * Default: undefined\n\nNote\n * Function-type configurations can only be used in Webpack builds.\n * Template-type configurations can only be used in Rspack builds or Webpack\n   builds that use SWC.\n\nCustomize the imported style path after conversion. The input is the imported\nmember. For example, configure it as (member) => `my-lib/${member}` , which will\nconvert to .\n\nWhen using Rspack to build, function configurations cannot be used, but you can\nuse handlebars template strings. For the above function configuration, you can\nuse the following template instead of my-lib/{{ member }}, or use some built-in\nhelper methods, such as my-lib/{{ kebabCase member }} to convert it to\nkebab-case format. In addition to kebabCase, there are also camelCase,\nsnakeCase, upperCase, and lowerCase that can be used.\n\n\nsource.preEntry#\n\n * Type: string | string[]\n * Default: undefined\n\nAdd a script before the entry file of each page. This script will be executed\nbefore the page code. It can be used to execute global logics, such as injecting\npolyfills, setting global styles, etc.\n\nAdd a single script#\n\nFirst create a src/polyfill.ts file:\n\nconsole.log('I am a polyfill');\n\n\nThen configure src/polyfill.ts to source.preEntry:\n\nexport default {\n  source: {\n    preEntry: './src/polyfill.ts',\n  },\n};\n\n\nRe-run the compilation and visit any page, you can see that the code in\nsrc/polyfill.ts has been executed, and the I am a polyfill is logged in the\nconsole.\n\nAdd global style#\n\nYou can also configure the global style through source.preEntry, this CSS code\nwill be loaded earlier than the page code, such as introducing a normalize.css\nfile:\n\nexport default {\n  source: {\n    preEntry: './src/normalize.css',\n  },\n};\n\n\nAdd multiple scripts#\n\nYou can add multiple scripts by setting preEntry to an array, and they will be\nexecuted in array order:\n\nexport default {\n  source: {\n    preEntry: ['./src/polyfill-a.ts', './src/polyfill-b.ts'],\n  },\n};\n\n\n\nsource.resolveExtensionPrefix#\n\n * Type: string | Record\n * Default: undefined\n\nAdd a prefix to resolve.extensions.\n\nIf multiple files share the same name but have different extensions, Builder\nwill resolve the one with the extension listed first in the array and skip the\nrest.\n\n\nExample#\n\nexport default {\n  source: {\n    resolveExtensionPrefix: '.web',\n  },\n};\n\n\nWith the configuration above, the extensions array will become:\n\n// before\nconst extensions = ['.js', '.ts', ...];\n\n// after\nconst extensions = ['.web.js', '.js', '.web.ts' , '.ts', ...];\n\n\nWhen import './foo' in the code, the foo.web.js file will be resolved first,\nthen the foo.js file.\n\nSet according to Targets#\n\nWhen you build multiple targets at the same time, you can set different\nextension prefix for different targets. At this point, you need to set\nresolveExtensionPrefix to an object whose key is the corresponding build target.\n\nFor example to set different extension prefix for web and node:\n\nexport default {\n  output: {\n    source: {\n      resolveExtensionPrefix: {\n        web: '.web',\n        node: '.node',\n      },\n    },\n  },\n};\n\n\nWhen import './foo' in the code, the foo.node.js file will be resolved for node\ntarget, and the foo.web.js file will be resolved for web target.\n\n\nsource.resolveMainFields#\n\n * Type:\n\ntype Fields = (string | string[])[];\n\ntype ResolveMainFields = Fields | Record;\n\n\n * Default: undefined\n\nThis config will determine which field of package.json you use to import the npm\nmodule. Same as the resolve.mainFields config of webpack.\n\n\nExample#\n\nexport default {\n  source: {\n    resolveMainFields: ['main', 'browser', 'exports'],\n  },\n};\n\n\nSet according to Targets#\n\nWhen you build multiple targets at the same time, you can set different\nmainFields for different targets. At this point, you need to set\nresolveMainFields to an object whose key is the corresponding build target.\n\nFor example to set different mainFields for web and node:\n\nexport default {\n  output: {\n    source: {\n      resolveMainFields: {\n        web: ['main', 'browser', 'exports'],\n        node: ['main', 'node', 'exports'],\n      },\n    },\n  },\n};\n","frontmatter":{"extractApiHeaders":[2]}},{"id":10,"title":"Tools Config","routePath":"/builder/en/api/config-tools","lang":"en","toc":[{"text":"tools.autoprefixer","id":"tools.autoprefixer","depth":2},{"text":"Object Type","id":"object-type","depth":3},{"text":"Function Type","id":"function-type","depth":3},{"text":"tools.babel","id":"tools.babel","depth":2},{"text":"Function Type","id":"function-type-1","depth":3},{"text":"Object Type","id":"object-type-1","depth":3},{"text":"Util Functions","id":"util-functions","depth":3},{"text":"addPlugins","id":"addplugins","depth":4},{"text":"addPresets","id":"addpresets","depth":4},{"text":"removePlugins","id":"removeplugins","depth":4},{"text":"removePresets","id":"removepresets","depth":4},{"text":"addIncludes","id":"addincludes","depth":4},{"text":"addExcludes","id":"addexcludes","depth":4},{"text":"modifyPresetEnvOptions","id":"modifypresetenvoptions","depth":4},{"text":"modifyPresetReactOptions","id":"modifypresetreactoptions","depth":4},{"text":"tools.bundlerChain","id":"tools.bundlerchain","depth":2},{"text":"Utils","id":"utils","depth":3},{"text":"env","id":"env","depth":4},{"text":"isProd","id":"isprod","depth":4},{"text":"target","id":"target","depth":4},{"text":"isServer","id":"isserver","depth":4},{"text":"isWebWorker","id":"iswebworker","depth":4},{"text":"HtmlPlugin","id":"htmlplugin","depth":3},{"text":"CHAIN_ID","id":"chain_id","depth":4},{"text":"CHAIN_ID.ONE_OF","id":"chain_id.one_of","depth":3},{"text":"CHAIN_ID.USE","id":"chain_id.use","depth":3},{"text":"CHAIN_ID.PLUGIN","id":"chain_id.plugin","depth":3},{"text":"Examples","id":"examples","depth":3},{"text":"tools.cssExtract","id":"tools.cssextract","depth":2},{"text":"Object Type","id":"object-type-2","depth":3},{"text":"Function Type","id":"function-type-2","depth":3},{"text":"tools.cssLoader","id":"tools.cssloader","depth":2},{"text":"Object Type","id":"object-type-3","depth":3},{"text":"Function Type","id":"function-type-3","depth":3},{"text":"tools.devServer","id":"tools.devserver","depth":2},{"text":"Options","id":"options","depth":3},{"text":"after","id":"after","depth":4},{"text":"before","id":"before","depth":4},{"text":"client","id":"client","depth":4},{"text":"devMiddleware","id":"devmiddleware","depth":4},{"text":"headers","id":"headers","depth":4},{"text":"historyApiFallback","id":"historyapifallback","depth":4},{"text":"hot","id":"hot","depth":4},{"text":"https","id":"https","depth":4},{"text":"liveReload","id":"livereload","depth":4},{"text":"setupMiddlewares","id":"setupmiddlewares","depth":4},{"text":"proxy","id":"proxy","depth":4},{"text":"watch","id":"watch","depth":4},{"text":"tools.htmlPlugin","id":"tools.htmlplugin","depth":2},{"text":"Object Type","id":"object-type-4","depth":3},{"text":"Function Type","id":"function-type-4","depth":3},{"text":"Boolean Type","id":"boolean-type","depth":3},{"text":"tools.inspector","id":"tools.inspector","depth":2},{"text":"Object Type","id":"object-type-5","depth":3},{"text":"Function Type","id":"function-type-5","depth":3},{"text":"tools.less","id":"tools.less","depth":2},{"text":"Object Type","id":"object-type-6","depth":3},{"text":"Function Type","id":"function-type-6","depth":3},{"text":"Util Function","id":"util-function","depth":3},{"text":"addExcludes","id":"addexcludes-1","depth":4},{"text":"tools.minifyCss","id":"tools.minifycss","depth":2},{"text":"Object Type","id":"object-type-7","depth":3},{"text":"Function Type","id":"function-type-7","depth":3},{"text":"tools.postcss","id":"tools.postcss","depth":2},{"text":"Function Type","id":"function-type-8","depth":3},{"text":"Object Type","id":"object-type-8","depth":3},{"text":"Util Functions","id":"util-functions-1","depth":3},{"text":"addPlugins","id":"addplugins-1","depth":4},{"text":"tools.pug","id":"tools.pug","depth":2},{"text":"Boolean Type","id":"boolean-type-1","depth":3},{"text":"Object Type","id":"object-type-9","depth":3},{"text":"Function Type","id":"function-type-9","depth":3},{"text":"tools.sass","id":"tools.sass","depth":2},{"text":"Object Type","id":"object-type-10","depth":3},{"text":"Function Type","id":"function-type-10","depth":3},{"text":"Utility Function","id":"utility-function","depth":3},{"text":"addExcludes","id":"addexcludes-2","depth":4},{"text":"tools.styleLoader","id":"tools.styleloader","depth":2},{"text":"Object Type","id":"object-type-11","depth":3},{"text":"Function Type","id":"function-type-11","depth":3},{"text":"tools.styledComponents","id":"tools.styledcomponents","depth":2},{"text":"tools.terser","id":"tools.terser","depth":2},{"text":"Object Type","id":"object-type-12","depth":3},{"text":"Function Type","id":"function-type-12","depth":3},{"text":"tools.tsLoader","id":"tools.tsloader","depth":2},{"text":"Object Type","id":"object-type-13","depth":3},{"text":"Function Type","id":"function-type-13","depth":3},{"text":"Util Functions","id":"util-functions-2","depth":3},{"text":"addIncludes","id":"addincludes-1","depth":4},{"text":"addExcludes","id":"addexcludes-3","depth":4},{"text":"tools.tsChecker","id":"tools.tschecker","depth":2},{"text":"Object Type","id":"object-type-14","depth":3},{"text":"Function Type","id":"function-type-14","depth":3},{"text":"tools.webpack","id":"tools.webpack","depth":2},{"text":"Object Type","id":"object-type-15","depth":3},{"text":"Function Type","id":"function-type-15","depth":3},{"text":"Utils","id":"utils-1","depth":3},{"text":"env","id":"env-1","depth":4},{"text":"isProd","id":"isprod-1","depth":4},{"text":"target","id":"target-1","depth":4},{"text":"isServer","id":"isserver-1","depth":4},{"text":"isWebWorker","id":"iswebworker-1","depth":4},{"text":"webpack","id":"webpack","depth":4},{"text":"HtmlWebpackPlugin","id":"htmlwebpackplugin","depth":3},{"text":"addRules","id":"addrules","depth":3},{"text":"prependPlugins","id":"prependplugins","depth":3},{"text":"appendPlugins","id":"appendplugins","depth":3},{"text":"removePlugin","id":"removeplugin","depth":3},{"text":"mergeConfig","id":"mergeconfig","depth":3},{"text":"tools.webpackChain","id":"tools.webpackchain","depth":2},{"text":"Utils","id":"utils-2","depth":3},{"text":"env","id":"env-2","depth":4},{"text":"isProd","id":"isprod-2","depth":4},{"text":"target","id":"target-2","depth":4},{"text":"isServer","id":"isserver-2","depth":4},{"text":"isWebWorker","id":"iswebworker-2","depth":4},{"text":"webpack","id":"webpack-1","depth":4},{"text":"HtmlWebpackPlugin","id":"htmlwebpackplugin-1","depth":3},{"text":"CHAIN_ID","id":"chain_id-1","depth":4},{"text":"CHAIN_ID.ONE_OF","id":"chain_id.one_of-1","depth":3},{"text":"CHAIN_ID.USE","id":"chain_id.use-1","depth":3},{"text":"CHAIN_ID.PLUGIN","id":"chain_id.plugin-1","depth":3},{"text":"CHAIN_ID.MINIMIZER","id":"chain_id.minimizer","depth":3},{"text":"Examples","id":"examples-1","depth":3},{"text":"Add/Modify/Delete loader","id":"add/modify/delete-loader","depth":4},{"text":"Add/Modify/Delete plugin","id":"add/modify/delete-plugin","depth":4},{"text":"tools.rspack","id":"tools.rspack","depth":2},{"text":"Object Type","id":"object-type-16","depth":3},{"text":"Function Type","id":"function-type-16","depth":3},{"text":"Utils","id":"utils-3","depth":3},{"text":"env","id":"env-3","depth":4},{"text":"isProd","id":"isprod-3","depth":4},{"text":"target","id":"target-3","depth":4},{"text":"isServer","id":"isserver-3","depth":4},{"text":"isWebWorker","id":"iswebworker-3","depth":4},{"text":"addRules","id":"addrules-1","depth":3},{"text":"prependPlugins","id":"prependplugins-1","depth":3},{"text":"appendPlugins","id":"appendplugins-1","depth":3},{"text":"removePlugin","id":"removeplugin-1","depth":3},{"text":"mergeConfig","id":"mergeconfig-1","depth":3}],"domain":"","content":"#\n\nThis section describes some low-level tools configurations in Modern.js Builder.\n\n\ntools.autoprefixer#\n\n * Type: Object | Function\n * Default:\n\n{\n  flexbox: 'no-2009',\n  // Depends on the browserslist config in the project\n  // and the `output.overrideBrowserslist` (higher priority) config\n  overrideBrowserslist: browserslist,\n}\n\n\nYou can modify the config of autoprefixer by tools.autoprefixer.\n\n\nObject Type#\n\nWhen tools.autoprefixer is configured as Object type, it is merged with the\ndefault config through Object.assign. For example:\n\nexport default {\n  tools: {\n    autoprefixer: {\n      flexbox: 'no-2009',\n    },\n  },\n};\n\n\n\nFunction Type#\n\nWhen tools.autoprefixer is a Function, the default config is passed as the first\nparameter and can be directly modified or returned as the final result. For\nexample:\n\nexport default {\n  tools: {\n    autoprefixer(config) {\n      // modify flexbox config\n      config.flexbox = 'no-2009';\n    },\n  },\n};\n\n\n\ntools.babel#\n\n * Type: Object | Function\n * Default: undefined\n\nBy tools.babel you can modify the options of babel-loader.\n\nWARNING\nWhen using Rspack as a packaging tool, using this configuration item will slow\ndown Rspack builds a bit. Because Rspack uses SWC compilation by default, there\nwill be additional compilation overhead when configuring the Babel.\n\n\nFunction Type#\n\nWhen tools.babel's type is Functionthe default babel config will be passed in\nas the first parameter, the config object can be modified directly, or a value\ncan be returned as the final result. The second parameter provides some util\nfunctions that can be called directly:\n\nexport default {\n  tools: {\n    babel(config) {\n      // Add a babel plugin\n      // note: the plugin have been added to the default config to support antd load on demand\n      config.plugins.push([\n        'babel-plugin-import',\n        {\n          libraryName: 'xxx-components',\n          libraryDirectory: 'es',\n          style: true,\n        },\n      ]);\n    },\n  },\n};\n\n\nTIP\nThe above example is just for reference, usually you don't need to manually\nconfigure babel-plugin-import, because the Builder already provides a more\ngeneral source.transformImport configuration.\n\n\nObject Type#\n\nWhen tools.babel's type is Object, the config will be shallow merged with\ndefault config by Object.assign.\n\nCAUTION\nNote that Object.assign is a shallow copy and will completely overwrite the\nbuilt-in presets or plugins array, please use it with caution.\n\nexport default {\n  tools: {\n    babel: {\n      plugins: [\n        [\n          'babel-plugin-import',\n          {\n            libraryName: 'xxx-components',\n            libraryDirectory: 'es',\n            style: true,\n          },\n        ],\n      ],\n    },\n  },\n};\n\n\n\nUtil Functions#\n\nWhen tools.babel is a Function, the tool functions available for the second\nparameter are as follows:\n\naddPlugins#\n\n * Type: (plugins: BabelPlugin[]) => void\n\nAdd some Babel plugins. For example:\n\nexport default {\n  tools: {\n    babel(config, { addPlugins }) {\n      addPlugins([\n        [\n          'babel-plugin-import',\n          {\n            libraryName: 'xxx-components',\n            libraryDirectory: 'es',\n            style: true,\n          },\n        ],\n      ]);\n    },\n  },\n};\n\n\naddPresets#\n\n * Type: (presets: BabelPlugin[]) => void\n\nAdd Babel preset configuration. (No need to add presets in most cases)\n\nexport default {\n  tools: {\n    babel(config, { addPresets }) {\n      addPresets(['@babel/preset-env']);\n    },\n  },\n};\n\n\nremovePlugins#\n\n * Type: (plugins: string | string[]) => void\n\nTo remove the Babel plugin, just pass in the name of the plugin to be removed,\nyou can pass in a single string or an array of strings.\n\nexport default {\n  tools: {\n    babel(config, { removePlugins }) {\n      removePlugins('babel-plugin-import');\n    },\n  },\n};\n\n\nremovePresets#\n\n * Type: (presets: string | string[]) => void\n\nTo remove the Babel preset configuration, pass in the name of the preset to be\nremoved, you can pass in a single string or an array of strings.\n\nexport default {\n  tools: {\n    babel(config, { removePresets }) {\n      removePresets('@babel/preset-env');\n    },\n  },\n};\n\n\naddIncludes#\n\n * Type: (includes: string | RegExp | (string | RegExp)[]) => void\n\nBy default, Babel will only compile the application code in the src directory.\nWith addIncludes you can specify that Babel compile some files in node_modules.\nFor example:\n\nexport default {\n  tools: {\n    babel(config, { addIncludes }) {\n      addIncludes(/\\/query-string\\//);\n    },\n  },\n};\n\n\nTIP\nThe usage of the addIncludes function is basically the same as the\nsource.include config, please see the source.include documentation for a more\ndetailed usage. You can also use source.include directly instead of the\naddIncludes function.\n\naddExcludes#\n\n * Type: (excludes: string | RegExp | (string | RegExp)[]) => void\n\nContrary to addIncludes, specifies that certain files are excluded from Babel's\ncompilation.\n\nFor example, without compiling files in the src/example directory:\n\nexport default {\n  tools: {\n    babel(config, { addExcludes }) {\n      addExcludes('src/example');\n    },\n  },\n};\n\n\nTIP\nThe usage of the addExcludes function is basically the same as the\nsource.exclude config, please see the source.exclude documentation for a more\ndetailed usage. You can also use source.exclude directly instead of the\naddExcludes function.\n\nmodifyPresetEnvOptions#\n\n * Type: (options: PresetEnvOptions) => void\n\nModify the configuration of @babel/preset-env, the configuration you pass in\nwill be shallowly merged with default config. For example:\n\nexport default {\n  tools: {\n    babel(config, { modifyPresetEnvOptions }) {\n      modifyPresetEnvOptions({\n        targets: {\n          browsers: ['last 2 versions'],\n        },\n      });\n    },\n  },\n};\n\n\nmodifyPresetReactOptions#\n\n * Type: (options: PresetReactOptions) => void\n\nModify the configuration of @babel/preset-react, the configuration you pass in\nwill be shallowly merged with default config. For example:\n\nexport default {\n  tools: {\n    babel(config, { modifyPresetReactOptions }) {\n      modifyPresetReactOptions({\n        pragma: 'React.createElement',\n      });\n    },\n  },\n};\n\n\n\ntools.bundlerChain#\n\n * Type: Function | undefined\n * Default: undefined\n\nYou can modify the webpack and Rspack configuration by configuring\ntools.bundlerChain which is type of Function. The function receives two\nparameters, the first is the original bundler chain object, and the second is an\nobject containing some utils.\n\nWhat is BundlerChain\n\nBundler chain is a subset of webpack chain, which contains part of the webpack\nchain API that you can use to modify both webpack and Rspack configuration.\n\nConfigurations modified via bundler chain will work on both webpack and Rspack\nbuilds. Note that the bundler chain only supports modifying the configuration of\nthe non-differentiated parts of webpack and Rspack. For example, modifying the\ndevtool configuration item (webpack and Rspack have the same devtool property\nvalue type), or adding an Rspack-compatible webpack plugin.\n\n> tools.bundlerChain is executed earlier than tools.webpackChain / tools.webpack\n> / tools.rspack and thus will be overridden by changes in others.\n\n\nUtils#\n\nenv#\n\n * Type: 'development' | 'production' | 'test'\n\nThe env parameter can be used to determine whether the current environment is\ndevelopment, production or test. For example:\n\nexport default {\n  tools: {\n    bundlerChain: (chain, { env }) => {\n      if (env === 'development') {\n        chain.devtool('cheap-module-eval-source-map');\n      }\n    },\n  },\n};\n\n\nisProd#\n\n * Type: boolean\n\nThe isProd parameter can be used to determine whether the current environment is\nproduction. For example:\n\nexport default {\n  tools: {\n    bundlerChain: (chain, { isProd }) => {\n      if (isProd) {\n        chain.devtool('source-map');\n      }\n    },\n  },\n};\n\n\ntarget#\n\n * Type: 'web' | 'node' | 'modern-web' | 'web-worker'\n\nThe target parameter can be used to determine the current environment. For\nexample:\n\nexport default {\n  tools: {\n    bundlerChain: (chain, { target }) => {\n      if (target === 'node') {\n        // ...\n      }\n    },\n  },\n};\n\n\nisServer#\n\n * Type: boolean\n\nDetermines whether the target environment is node, equivalent to target ===\n'node'.\n\nexport default {\n  tools: {\n    bundlerChain: (chain, { isServer }) => {\n      if (isServer) {\n        // ...\n      }\n    },\n  },\n};\n\n\nisWebWorker#\n\n * Type: boolean\n\nDetermines whether the target environment is web-worker, equivalent to target\n=== 'web-worker'.\n\nexport default {\n  tools: {\n    bundlerChain: (chain, { isWebWorker }) => {\n      if (isWebWorker) {\n        // ...\n      }\n    },\n  },\n};\n\n\n\nHtmlPlugin#\n\n * Type: typeof import('html-webpack-plugin') | import('@rspack/plugin-html')\n\nThe HtmlPlugin instance in webpack or Rspack:\n\nexport default {\n  tools: {\n    bundlerChain: (chain, { HtmlPlugin }) => {\n      console.log(HtmlPlugin);\n    },\n  },\n};\n\n\nCHAIN_ID#\n\nSome common Chain IDs are predefined in the Builder, and you can use these IDs\nto locate the built-in Rule or Plugin.\n\nCHAIN_ID.RULE#\n\nID          DESCRIPTION\nRULE.CSS    Rule for css\nRULE.LESS   Rule for less\nRULE.SASS   Rule for sass\nRULE.TOML   Rule for toml\nRULE.YAML   Rule for yaml\n\n\nCHAIN_ID.ONE_OF#\n\nONE_OF.XXX can match a certain type of rule in the rule array.\n\nID                  DESCRIPTION\nONE_OF.SVG          Rules for SVG, automatic choice between data URI and\n                    separate file\nONE_OF.SVG_URL      Rules for SVG, output as a separate file\nONE_OF.SVG_INLINE   Rules for SVG, inlined into bundles as data URIs\nONE_OF.SVG_ASSETS   Rules for SVG, automatic choice between data URI and\n                    separate file\n\n\nCHAIN_ID.USE#\n\nUSE.XXX can match a certain loader.\n\nID            DESCRIPTION\nUSE.LESS      correspond to less-loader\nUSE.SASS      correspond to sass-loader\nUSE.TOML      correspond to toml-loader\nUSE.YAML      correspond to yaml-loader\nUSE.SVGR      correspond to @svgr/webpack\nUSE.POSTCSS   correspond to postcss-loader\n\n\nCHAIN_ID.PLUGIN#\n\nPLUGIN.XXX can match a certain webpack plugin.\n\nID                          DESCRIPTION\nPLUGIN.HTML                 correspond to HtmlPlugin, you need to splice the entry name\n                            when using: ${PLUGIN.HTML}-${entryName}\nPLUGIN.APP_ICON             correspond to AppIconPlugin\nPLUGIN.INLINE_HTML          correspond to InlineChunkHtmlPlugin\nPLUGIN.BUNDLE_ANALYZER      correspond to WebpackBundleAnalyzer\nPLUGIN.BOTTOM_TEMPLATE      correspond to BottomTemplatePlugin\nPLUGIN.AUTO_SET_ROOT_SIZE   correspond to automatically set root font size plugin in\n                            Builder\n\n\nExamples#\n\nThe usage of BundlerChain can reference: WebpackChain Examples.\n\n\ntools.cssExtract#\n\n * Type: Object | Function\n * Default:\n\nconst defaultOptions = {\n  // The loader options\n  loaderOptions: {},\n  // The plugin options\n  pluginOptions: {\n    // The default value of cssPath is `static/css`\n    // while the default value of cssFilename is `[name].[contenthash:8].css`\n    filename: `${cssPath}/${cssFilename}`,\n    chunkFilename: `${cssPath}/async/${cssFilename}`,\n    ignoreOrder: true,\n  },\n};\n\n\n * Bundler: only support webpack\n\nThe config of mini-css-extract-plugin can be modified through tools.cssExtract.\n\n\nObject Type#\n\nWhen this value is an Object, it is merged with the default config via\nObject.assign. For example:\n\nexport default {\n  tools: {\n    cssExtract: {\n      pluginOptions: {\n        filename: 'static/css/[name].[contenthash:8].css',\n      },\n    },\n  },\n};\n\n\n\nFunction Type#\n\nWhen the value a Function, the default config is passed in as the first\nparameter. You can modify the config object directly, or return an object as the\nfinal config. For example:\n\nexport default {\n  tools: {\n    cssExtract: config => {\n      config.pluginOptions.filename = 'static/css/[name].[contenthash:8].css';\n      return config;\n    },\n  },\n};\n\n\nFor more config details, please refer to mini-css-extract-plugin.\n\n\ntools.cssLoader#\n\n * Type: Object | Function\n * Default: undefined\n * Bundler: only support webpack\n\nThe config of css-loader can be modified through tools.cssLoader. The default\nconfig is as follows:\n\n{\n  importLoaders: 1,\n  modules: {\n    auto: true,\n    exportLocalsConvention: 'camelCase',\n    localIdentName: config.output.cssModuleLocalIdentName,\n    // isServer indicates node (SSR) build\n    // isWebWorker indicates web worker build\n    exportOnlyLocals: isServer || isWebWorker,\n  },\n  // CSS Source Map enabled by default in development environment\n  sourceMap: isDev,\n}\n\n\n\nObject Type#\n\nWhen this value is an Object, it is merged with the default config via deep\nmerge. For example:\n\nexport default {\n  tools: {\n    cssLoader: {\n      modules: {\n        exportOnlyLocals: true,\n      },\n    },\n  },\n};\n\n\n\nFunction Type#\n\nWhen the value is a Function, the default config is passed in as the first\nparameter. You can modify the config object directly, or return an object as the\nfinal config. For example:\n\nexport default {\n  tools: {\n    cssLoader: config => {\n      config.modules.exportOnlyLocals = true;\n      return config;\n    },\n  },\n};\n\n\n\ntools.devServer#\n\n * Type: Object\n * Default: {}\n\nThe config of DevServer can be modified through tools.devServer.\n\n\nOptions#\n\nafter#\n\n * Type: Array\n * Default: []\n\nProvides the ability to execute custom middleware after all other middleware\ninternally within the server.\n\nexport default {\n  tools: {\n    devServer: {\n      after: [\n        async (req, res, next) => {\n          console.log('after dev middleware');\n          next();\n        },\n      ],\n    },\n  },\n};\n\n\nbefore#\n\n * Type: Array\n * Default: []\n\nProvides the ability to execute custom middleware prior to all other middleware\ninternally within the server.\n\nexport default {\n  tools: {\n    devServer: {\n      before: [\n        async (req, res, next) => {\n          console.log('before dev middleware');\n          next();\n        },\n      ],\n    },\n  },\n};\n\n\nclient#\n\n * Type:\n\n{\n    /** Specify a protocol to use */\n    protocol?: string;\n    /** The path which the middleware is serving the event stream on */\n    path?: string;\n    /** Specify a port number to listen for requests on */\n    port?: string;\n    /** Specify a host to use */\n    host?: string;\n}\n\n\n * Default:\n\n{\n    path: '/webpack-hmr',\n    port: '8080',\n    host: networkAddress || 'localhost',\n}\n\n\nThe config of hmr client.\n\ndevMiddleware#\n\n * Type:\n\n{\n  writeToDisk: boolean | ((filename: string) => boolean);\n}\n\n\n * Default:\n\n{\n  writeToDisk: (file: string) => !file.includes('.hot-update.'),\n}\n\n\nThe config of devMiddleware. Current options is the subset of\nwebpack-dev-middleware.\n\nheaders#\n\n * Type: Record\n * Default: undefined\n\nAdds headers to all responses.\n\nexport default {\n  tools: {\n    devServer: {\n      headers: {\n        'X-Custom-Foo': 'bar',\n      },\n    },\n  },\n};\n\n\nhistoryApiFallback#\n\n * Type: boolean | ConnectHistoryApiFallbackOptions\n * Default: false\n\nThe index.html page will likely have to be served in place of any 404 responses.\nEnable devServer.historyApiFallback by setting it to true:\n\nexport default {\n  tools: {\n    devServer: {\n      historyApiFallback: true,\n    },\n  },\n};\n\n\nFor more options and information, see the connect-history-api-fallback\ndocumentation.\n\nhot#\n\n * Type: boolean\n * Default: true\n\nEnable Hot Module Replacement feature.\n\nhttps#\n\n * Type: boolean | { key: string; cert: string }\n * Default: false\n\nBy default, DevServer will be served over HTTP. It can optionally be served over\nHTTPS by setting devServer.https to true, and will disable the HTTP server.\n\nYou can also manually pass in the certificate and corresponding private key\nrequired by the HTTPS server:\n\nexport default {\n  tools: {\n    devServer: {\n      https: {\n        key: fs.readFileSync('certificates/private.pem'),\n        cert: fs.readFileSync('certificates/public.pem'),\n      },\n    },\n  },\n};\n\n\nliveReload#\n\n * Type: boolean\n * Default: true\n\nBy default, the DevServer will reload/refresh the page when file changes are\ndetecteddevServer.hot option must be disabled in order for liveReload to take\neffect. Disable devServer.liveReload by setting it to false.\n\nsetupMiddlewares#\n\n * Type:\n\nArray<\n  (\n    middlewares: {\n      unshift: (...handlers: RequestHandler[]) => void;\n      push: (...handlers: RequestHandler[]) => void;\n    },\n    server: {\n      sockWrite: (\n        type: string,\n        data?: string | boolean | Record,\n      ) => void;\n    },\n  ) => void\n>;\n\n\n * Default: undefined\n\nProvides the ability to execute a custom function and apply custom middlewares.\n\nThe order among several different types of middleware is: devServer.before =>\nunshift => internal middlewares => push => devServer.after.\n\nexport default {\n  tools: {\n    devServer: {\n      setupMiddlewares: [\n        (middlewares, server) => {\n          middlewares.unshift((req, res, next) => {\n            next();\n          });\n\n          middlewares.push((req, res, next) => {\n            next();\n          });\n        },\n      ],\n    },\n  },\n};\n\n\nIt is possible to use some server api to meet special scenario requirements:\n\n * sockWrite. Allow send some message to hmr client, and then the hmr client\n   will take different actions depending on the message type. If you send a\n   \"content changed\" message, the page will reload.\n\nexport default {\n  tools: {\n    devServer: {\n      setupMiddlewares: [\n        (middlewares, server) => {\n          // add custom watch & trigger page reload when change\n          watcher.on('change', changed => {\n            server.sockWrite('content-changed');\n          });\n        },\n      ],\n    },\n  },\n};\n\n\nproxy#\n\n * Type: Record | Record\n * Default: undefined\n\nProxying some URLs.\n\nexport default {\n  tools: {\n    devServer: {\n      proxy: {\n        '/api': 'http://localhost:3000',\n      },\n    },\n  },\n};\n\n\nA request to /api/users will now proxy the request to\nhttp://localhost:3000/api/users.\n\nIf you don't want /api to be passed along, we need to rewrite the path:\n\nexport default {\n  tools: {\n    devServer: {\n      proxy: {\n        '/api': {\n          target: 'http://localhost:3000',\n          pathRewrite: { '^/api': '' },\n        },\n      },\n    },\n  },\n};\n\n\nThe DevServer Proxy makes use of the http-proxy-middleware package. Check out\nits documentation for more advanced usages.\n\nThe full type definition of DevServer Proxy is:\n\n\n\ntype ProxyDetail = HttpProxyOptions & {\n  bypass?: (\n    req: IncomingMessage,\n    res: ServerResponse,\n    proxyOptions: ProxyOptions,\n  ) => string | undefined | null | false;\n  context?: string | string[];\n};\n\ntype ProxyOptions =\n  | Record\n  | Record\n  | ProxyDetail[]\n  | ProxyDetail;\n\n\nIn addition to the http-proxy-middleware option, we also support the bypass and\ncontext configuration:\n\n * bypassbypass the proxy based on the return value of a function.\n   * Return null or undefined to continue processing the request with proxy.\n   * Return false to produce a 404 error for the request.\n   * Return a path to serve from, instead of continuing to proxy the request.\n * contextIf you want to proxy multiple, specific paths to the same target, you\n   can use an array of one or more objects with a context property.\n\n// custom bypass\nexport default {\n  tools: {\n    devServer: {\n      proxy: {\n        '/api': {\n          target: 'http://localhost:3000',\n          bypass: function (req, res, proxyOptions) {\n            if (req.headers.accept.indexOf('html') !== -1) {\n              console.log('Skipping proxy for browser request.');\n              return '/index.html';\n            }\n          },\n        },\n      },\n    },\n  },\n};\n\n\n// proxy multiple\nexport default {\n  tools: {\n    devServer: {\n      proxy: [\n        {\n          context: ['/auth', '/api'],\n          target: 'http://localhost:3000',\n        },\n      ],\n    },\n  },\n};\n\n\nwatch#\n\n * Type: boolean\n * Default: true\n\nWhether to watch files change in directories such as mock/, server/, api/.\n\n\ntools.htmlPlugin#\n\n * Type: false | Object | Function\n * Default:\n\nconst defaultHtmlPluginOptions = {\n  inject, // corresponding to the html.inject config\n  favicon, // corresponding to html.favicon config\n  filename, // generated based on output.distPath and entryName\n  template, // defaults to the built-in HTML template path\n  templateParameters, // corresponding to the html.templateParameters config\n  chunks: [entryName],\n  minify: {\n    removeComments: false,\n    useShortDoctype: true,\n    keepClosingSlash: true,\n    collapseWhitespace: true,\n    removeRedundantAttributes: true,\n    removeScriptTypeAttributes: true,\n    removeStyleLinkTypeAttributes: true,\n  },\n};\n\n\nThe configs of html-webpack-plugin or @rspack/plugin-html can be modified\nthrough tools.htmlPlugin.\n\n\nObject Type#\n\nWhen tools.htmlPlugin is Object type, the value will be merged with the default\nconfig via Object.assign.\n\nexport default {\n  tools: {\n    htmlPlugin: {\n      scriptLoading: 'blocking',\n    },\n  },\n};\n\n\n\nFunction Type#\n\nWhen tools.htmlPlugin is a Function:\n\n * The first parameter is the default config, which can be modified directly.\n * The second parameter is also an object, containing the entry name and the\n   entry value.\n * The Function can return a new object as the final config.\n\nexport default {\n  tools: {\n    htmlPlugin(config, { entryName, entryValue }) {\n      if (entryName === 'main') {\n        config.scriptLoading = 'blocking';\n      }\n    },\n  },\n};\n\n\n\nBoolean Type#\n\nThe built-in html-webpack-plugin plugins can be disabled by set tools.htmlPlugin\nto false.\n\nexport default {\n  tools: {\n    htmlPlugin: false,\n  },\n};\n\n\n\ntools.inspector#\n\n * Type: Object | Function | undefined\n * Default: undefined\n * Bundler: only support webpack\n\nYou can enable or configure the webpack inspector through tools.inspector.\n\nWhen the configuration is not undefined, it means that webpack-inspector is\nenabled, and the type of tools.inspector can be Object or Function.\n\n\nObject Type#\n\nWhen tools.inspector is configured with type Object, it is merged with the\ndefault configuration via Object.assign. For example:\n\nexport default {\n  tools: {\n    inspector: {\n      // The default port is 3333\n      port: 3334,\n    },\n  },\n};\n\n\n\nFunction Type#\n\nWhen tools.inspector is a Function, the default configuration is passed as the\nfirst parameter and can be directly modified or returned as the final result.\nFor example:\n\nexport default {\n  tools: {\n    inspector(config) {\n      config.port = 3334;\n    },\n  },\n};\n\n\n\ntools.less#\n\n * Type: Object | Function\n * Default:\n\nconst defaultOptions = {\n  lessOptions: {\n    javascriptEnabled: true,\n  },\n  // CSS Source Map enabled by default in development environment\n  sourceMap: isDev,\n};\n\n\nYou can modify the config of less-loader via tools.less.\n\n\nObject Type#\n\nWhen tools.less is configured as Object type, it is merged with the default\nconfig through Object.assign in a shallow way. It should be noted that\nlessOptions is merged through deepMerge in a deep way. For example:\n\nexport default {\n  tools: {\n    less: {\n      lessOptions: {\n        javascriptEnabled: false,\n      },\n    },\n  },\n};\n\n\n\nFunction Type#\n\nWhen tools.less is a Function, the default config is passed as the first\nparameter, which can be directly modified or returned as the final result. The\nsecond parameter provides some utility functions that can be called directly.\nFor example:\n\nexport default {\n  tools: {\n    less(config) {\n      // Modify the config of lessOptions\n      config.lessOptions = {\n        javascriptEnabled: false,\n      };\n    },\n  },\n};\n\n\n\nUtil Function#\n\naddExcludes#\n\n * Type: (excludes: RegExp | RegExp[]) => void\n\nUsed to specify which files less-loader does not compile, You can pass in one or\nmore regular expressions to match the path of less files, for example:\n\nexport default {\n  tools: {\n    less(config, { addExcludes }) {\n      addExcludes(/node_modules/);\n    },\n  },\n};\n\n\n\ntools.minifyCss#\n\n * Type: Object | Function | undefined\n * Default:\n\nconst defaultOptions = {\n  minimizerOptions: {\n    preset: [\n      'default',\n      {\n        mergeLonghand: false,\n      },\n    ],\n  },\n};\n\n\n * Bundler: only support webpack\n\nWhen building for production, Builder will minimize the CSS code through\ncss-minimizer-webpack-plugin. The config of css-minimizer-webpack-plugin can be\nmodified via tools.minifyCss.\n\n\nObject Type#\n\nWhen tools.minifyCss is Object type, it will be merged with the default config\nvia Object.assign.\n\nFor example, modify the preset config of cssnano:\n\nexport default {\n  tools: {\n    minifyCss: {\n      minimizerOptions: {\n        preset: require.resolve('cssnano-preset-simple'),\n      },\n    },\n  },\n};\n\n\n\nFunction Type#\n\nWhen tools.minifyCss is Function type, the default config is passed in as the\nfirst parameter, the config object can be modified directly, or a value can be\nreturned as the final result.\n\nexport default {\n   tools: {\n    minifyCss: options => {\n      options.minimizerOptions = {\n        preset: require.resolve('cssnano-preset-simple'),\n      },\n    }\n  }\n};\n\n\n\ntools.postcss#\n\n * Type: Object | Function\n * Default:\n\nconst defaultOptions = {\n  postcssOptions: {\n    plugins: [\n      require('postcss-flexbugs-fixes'),\n      require('postcss-custom-properties'),\n      require('postcss-initial'),\n      require('postcss-page-break'),\n      require('postcss-font-variant'),\n      require('postcss-media-minmax'),\n      require('postcss-nesting'),\n      require('autoprefixer')({\n        flexbox: 'no-2009',\n      }),\n    ],\n    // CSS Source Map enabled by default in development environment\n    sourceMap: isDev,\n  },\n};\n\n\nBuilder integrates PostCSS by default, you can configure postcss-loader through\ntools.postcss.\n\n\nFunction Type#\n\nWhen the value is a Function, the internal default config is passed as the first\nparameter, and the config object can be modified directly without returning, or\nan object can be returned as the final result; the second parameter is a set of\ntool functions for modifying the postcss-loader config.\n\nFor example, you need to add a PostCSS plugin on the basis of the original\nplugin, and push a new plugin to the postcssOptions.plugins array:\n\nexport default {\n  tools: {\n    postcss: opts => {\n      opts.postcssOptions.plugins.push(require('postcss-px-to-viewport'));\n    },\n  },\n};\n\n\nWhen you need to pass parameters to the PostCSS plugin, you can pass them in by\nfunction parameters:\n\nexport default {\n  tools: {\n    postcss: opts => {\n      const viewportPlugin = require('postcss-px-to-viewport')({\n        viewportWidth: 375,\n      });\n      opts.postcssOptions.plugins.push(viewportPlugin);\n    },\n  },\n};\n\n\ntools.postcss can return a config object and completely replace the default\nconfig:\n\nexport default {\n  tools: {\n    postcss: () => {\n      return {\n        postcssOptions: {\n          plugins: [require('postcss-px-to-viewport')],\n        },\n      };\n    },\n  },\n};\n\n\n\nObject Type#\n\nWhen this value is an Object, it is merged with the default config via\nObject.assign. Note that Object.assign is a shallow copy and will completely\noverwrite the built-in presets or plugins array, please use it with caution.\n\nexport default {\n  tools: {\n    postcss: {\n      // Because `Object.assign` is used, the default postcssOptions will be overwritten.\n      postcssOptions: {\n        plugins: [require('postcss-px-to-viewport')],\n      },\n    },\n  },\n};\n\n\n\nUtil Functions#\n\naddPlugins#\n\n * Type: (plugins: PostCSSPlugin | PostCSSPlugin[]) => void\n\nFor adding additional PostCSS plugins, You can pass in a single PostCSS plugin,\nor an array of PostCSS plugins.\n\nexport default {\n  tools: {\n    postcss: (config, { addPlugins }) => {\n      // Add a PostCSS Plugin\n      addPlugins(require('postcss-preset-env'));\n      // Add multiple PostCSS Plugins\n      addPlugins([require('postcss-preset-env'), require('postcss-import')]);\n    },\n  },\n};\n\n\nTIP\nBuilder uses the PostCSS v8 version. When you use third-party PostCSS plugins,\nplease pay attention to whether the PostCSS version is compatible. Some legacy\nplugins may not work in PostCSS v8.\n\n\ntools.pug#\n\n * Type: true | Object | Function | undefined\n * Default: false\n * Bundler: only support webpack\n\nConfigure the Pug template engine.\n\n\nBoolean Type#\n\nPug template engine is not enabled by default, you can enable it by setting\ntools.pug to true.\n\nexport default {\n  tools: {\n    pug: true,\n  },\n};\n\n\nWhen enabled, you can use index.pug as the template file in html.template\nconfig.\n\n\nObject Type#\n\nWhen tools.terser is Object type, you can passing the Pug options:\n\nexport default {\n  tools: {\n    pug: {\n      doctype: 'xml',\n    },\n  },\n};\n\n\nFor detailed options, please refer to Pug API Reference.\n\n\nFunction Type#\n\nWhen tools.pug is Function type, the default configuration is passed in as the\nfirst parameter, the configuration object can be modified directly, or a value\ncan be returned as the final result.\n\nexport default {\n  tools: {\n    pug(config) {\n      config.doctype = 'xml';\n    },\n  },\n};\n\n\n\ntools.sass#\n\n * Type: Object | Function\n * Default:\n\nconst defaultOptions = {\n  // CSS Source Map enabled by default in development environment\n  sourceMap: isDev,\n};\n\n\nYou can modify the config of sass-loader via tools.sass.\n\n\nObject Type#\n\nWhen tools.sass is Object type, it is merged with the default config through\nObject.assign. It should be noted that sassOptions is merged through deepMerge\nin a deep way.\n\nFor example:\n\nexport default {\n  tools: {\n    sass: {\n      sourceMap: true,\n    },\n  },\n};\n\n\n\nFunction Type#\n\nWhen tools.sass is a Function, the default config is passed as the first\nparameter, which can be directly modified or returned as the final result. The\nsecond parameter provides some utility functions that can be called directly.\nFor Example:\n\nexport default {\n  tools: {\n    sass(config) {\n      // Modify sourceMap config\n      config.additionalData = async (content, loaderContext) => {\n        // ...\n      };\n    },\n  },\n};\n\n\n\nUtility Function#\n\naddExcludes#\n\n * Type: (excludes: RegExp | RegExp[]) => void\n\nUsed to specify which files sass-loader does not compile, You can pass in one or\nmore regular expressions to match the path of sass files, for example:\n\nexport default {\n  tools: {\n    sass(config, { addExcludes }) {\n      addExcludes(/node_modules/);\n    },\n  },\n};\n\n\n\ntools.styleLoader#\n\n * Type: Object | Function\n * Default: {}\n * Bundler: only support webpack\n\nThe config of style-loader can be set through tools.styleLoader.\n\nIt is worth noting that Builder does not enable style-loader by default. You can\nuse output.disableCssExtract config to enable it\n\n\nObject Type#\n\nWhen this value is an Object, it is merged with the default config via\nObject.assign. For example:\n\nexport default {\n  tools: {\n    styleLoader: {\n      loaderOptions: {\n        insert: 'head',\n      },\n    },\n  },\n};\n\n\n\nFunction Type#\n\nWhen the value is a Function, the default config is passed in as the first\nparameter. You can modify the config object directly, or return an object as the\nfinal config. For example:\n\nexport default {\n  tools: {\n    styleLoader: config => {\n      config.loaderOptions.insert = 'head';\n      return config;\n    },\n  },\n};\n\n\n\ntools.styledComponents#\n\n * Type: Object | Function\n * Default\n\n{\n  displayName: true,\n  // `isSSR` is true in SSR build\n  ssr: isSSR,\n  // `pure` is enabled in production to reduce bundle size\n  pure: isProd,\n  transpileTemplateLiterals: true,\n}\n\n\n * Bundler: only support webpack\n\ntools.styledComponents config is corresponding to\nbabel-plugin-styled-components.\n\nWhen the value is an Object, use the Object.assign function to merge with the\ndefault config. For example:\n\nexport default {\n  tools: {\n    styledComponents: {\n      pure: false,\n    },\n  },\n};\n\n\nWhen the config is a Function, the first parameter is the default configuration,\nand the second parameter provides some utility functions that can be called\ndirectly:\n\nexport default {\n  tools: {\n    styledComponents(config) {\n      config.pure = false;\n    },\n  },\n};\n\n\n\ntools.terser#\n\n * Type: Object | Function | undefined\n * Default:\n\nconst defaultTerserOptions = {\n  terserOptions: {\n    mangle: {\n      safari10: true,\n    },\n  },\n};\n\n\n * Bundler: only support webpack\n\nWhen building for production, Builder will minimize the JavaScript code through\nterser-webpack-plugin. The config of terser-webpack-plugin can be modified via\ntools.terser.\n\n\nObject Type#\n\nWhen tools.terser is Object type, it will be merged with the default config via\nObject.assign.\n\nFor example, to exclude some files from minification:\n\nexport default {\n  tools: {\n    terser: {\n      exclude: /\\/excludes/,\n    },\n  },\n};\n\n\n\nFunction Type#\n\nWhen tools.terser is Function type, the default config is passed in as the first\nparameter, the config object can be modified directly, or a value can be\nreturned as the final result.\n\nexport default {\n  tools: {\n    terser: opts => {\n      opts.exclude = /\\/excludes/;\n    },\n  },\n};\n\n\n\ntools.tsLoader#\n\n * Type: Object | Function | undefined\n * Default: undefined\n * Bundler: only support webpack\n\nts-loader is not enabled by default in the project. When tools.tsLoader is not\nundefined, builder will use ts-loader instead of babel-loader to compile\nTypeScript code.\n\n\nObject Type#\n\nWhen this value is an Object, it is merged with the default configuration via\nObject.assign.\n\nThe default configuration is as follows:\n\n{\n  \"compilerOptions\": {\n    \"target\": \"es5\",\n    \"module\": \"ESNext\"\n  },\n  \"transpileOnly\": true,\n  \"allowTsInNodeModules\": true\n}\n\n\nYou can override the default configuration via the tools.tsLoader configuration\nitem:\n\nexport default {\n  tools: {\n    tsLoader: {\n      allowTsInNodeModules: false,\n    },\n  },\n};\n\n\n\nFunction Type#\n\nWhen this value is a Function, the default configuration is passed in as the\nfirst parameter, the configuration object can be modified directly, or an object\ncan be returned as the final configuration.The second parameter is the util\nfunctions to modify the ts-loader configuration. For example:\n\nexport default {\n  tools: {\n    tsLoader: opts => {\n      opts.allowTsInNodeModules = false;\n    },\n  },\n};\n\n\n\nUtil Functions#\n\nWhen the value of tools.tsLoader is a Function, the utils functions available\nfor the second parameter are as follows:\n\naddIncludes#\n\n * Type: (includes: string | RegExp | Array) => void\n\nBy default, only the application code in the src directory will be compiled. Use\naddIncludes to specify ts-loader to compile some files under node_modules. For\nexample:\n\nexport default {\n  tools: {\n    tsLoader: (config, { addIncludes }) => {\n      addIncludes([/node_modules\\/react/]);\n    },\n  },\n};\n\n\naddExcludes#\n\n * Type: (excludes: string | RegExp | Array) => void\n\nContrary to addIncludes, specify ts-loader to exclude certain files when\ncompiling.\n\nFor example, without compiling files in the src/example directory:\n\nexport default {\n  tools: {\n    tsLoader: (config, { addExcludes }) => {\n      addExcludes([/src\\/example\\//]);\n    },\n  },\n};\n\n\n\ntools.tsChecker#\n\n * Type: Object | Function\n * Default:\n\nconst defaultOptions = {\n  typescript: {\n    // avoid OOM issue\n    memoryLimit: 8192,\n    // use tsconfig of user project\n    configFile: tsconfigPath,\n    // use typescript of user project\n    typescriptPath: require.resolve('typescript'),\n  },\n  issue: {\n    exclude: [\n      { file: '**/*.(spec|test).ts' },\n      { file: '**/node_modules/**/*' },\n    ],\n  },\n  logger: {\n    log() {\n      // do nothing\n      // we only want to display error messages\n    },\n    error(message: string) {\n      console.error(message.replace(/ERROR/g, 'Type Error'));\n    },\n  },\n},\n\n\n * Bundler: only support webpack\n\nBy default, the fork-ts-checker-webpack-plugin is enabled for type checking. You\ncan use output.disableTsChecker config to disable it.\n\n\nObject Type#\n\nWhen this value is an Object, it is merged with the default config via\nObject.assign.\n\n\nFunction Type#\n\nWhen the value is a Function, the default config is passed in as the first\nparameter. You can modify the config object directly, or return an object as the\nfinal config.\n\n\ntools.webpack#\n\n * Type: Object | Function | undefined\n * Default: undefined\n * Bundler: only support webpack\n\ntools.webpack is used to configure webpack\n\n> tools.webpackChain is also used to modify the webpack configuration, and the\n> function is more powerful. It is recommended to use tools.webpackChain first.\n\n\nObject Type#\n\nYou can configure it as an object, which will be merged with the original\nwebpack configuration through webpack-merge. For example:\n\nexport default {\n  tools: {\n    webpack: {\n      resolve: {\n        alias: {\n          '@util': 'src/util',\n        },\n      },\n    },\n  },\n};\n\n\n\nFunction Type#\n\nYou can also configure it as a function, which accepts one parameter, the\noriginal webpack configuration, you can modify this configuration, and then\nreturn a new configuration. For example:\n\nexport default {\n  tools: {\n    webpack: config => {\n      config.resolve.alias['@util'] = 'src/util';\n      return config;\n    },\n  },\n};\n\n\nThe second parameter of this function is an object that contains some\ninformation about the tool collection. Details are as follows:\n\n\nUtils#\n\nenv#\n\n * Type: 'development' | 'production' | 'test'\n\nThe env parameter can be used to determine whether the current environment is\ndevelopment, production or test. For example:\n\nexport default {\n  tools: {\n    webpack: (config, { env }) => {\n      if (env === 'development') {\n        config.devtool = 'cheap-module-eval-source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\nisProd#\n\n * Type: boolean\n\nThe isProd parameter can be used to determine whether the current environment is\nproduction. For example:\n\nexport default {\n  tools: {\n    webpack: (config, { isProd }) => {\n      if (isProd) {\n        config.devtool = 'source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\ntarget#\n\n * Type: 'web' | 'node' | 'modern-web' | 'web-worker'\n\nThe target parameter can be used to determine the current target. For example:\n\nexport default {\n  tools: {\n    webpack: (config, { target }) => {\n      if (target === 'node') {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\nisServer#\n\n * Type: boolean\n\nDetermines whether the target environment is node, equivalent to target ===\n'node'.\n\nexport default {\n  tools: {\n    webpack: (config, { isServer }) => {\n      if (isServer) {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\nisWebWorker#\n\n * Type: boolean\n\nDetermines whether the target environment is web-worker, equivalent to target\n=== 'web-worker'.\n\nexport default {\n  tools: {\n    webpack: (config, { isWebWorker }) => {\n      if (isWebWorker) {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\nwebpack#\n\n * Type: typeof import('webpack')\n\nThe webpack instance. For example:\n\nexport default {\n  tools: {\n    webpack: (config, { webpack }) => {\n      config.plugins.push(new webpack.ProgressPlugin());\n      return config;\n    },\n  },\n};\n\n\n\nHtmlWebpackPlugin#\n\n * Type: typeof import('html-webpack-plugin')\n\nThe HtmlWebpackPlugin instance:\n\nexport default {\n  tools: {\n    webpackChain: (chain, { HtmlWebpackPlugin }) => {\n      console.log(HtmlWebpackPlugin);\n    },\n  },\n};\n\n\n\naddRules#\n\n * Type: (rules: RuleSetRule | RuleSetRule[]) => void\n\nAdd additional webpack rules.\n\nFor example:\n\nexport default {\n  tools: {\n    webpack: (config, { addRules }) => {\n      // add a single rule\n      addRules({\n        test: /\\.foo/,\n        loader: require.resolve('foo-loader'),\n      });\n\n      // Add multiple rules as an array\n      addRules([\n        {\n          test: /\\.foo/,\n          loader: require.resolve('foo-loader'),\n        },\n        {\n          test: /\\.bar/,\n          loader: require.resolve('bar-loader'),\n        },\n      ]);\n    },\n  },\n};\n\n\n\nprependPlugins#\n\n * Type: (plugins: WebpackPluginInstance | WebpackPluginInstance[]) => void\n\nAdd additional plugins to the head of the internal webpack plugins array, and\nthe plugin will be executed first.\n\nexport default {\n  tools: {\n    webpack: (config, { prependPlugins, webpack }) => {\n      // add a single plugin\n      prependPlugins(\n        new webpack.BannerPlugin({\n          banner: 'hello world!',\n        }),\n      );\n\n      // Add multiple plugins\n      prependPlugins([new PluginA(), new PluginB()]);\n    },\n  },\n};\n\n\n\nappendPlugins#\n\n * Type: (plugins: WebpackPluginInstance | WebpackPluginInstance[]) => void\n\nAdd additional plugins at the end of the internal webpack plugins array, the\nplugin will be executed last.\n\nexport default {\n  tools: {\n    webpack: (config, { appendPlugins, webpack }) => {\n      // add a single plugin\n      appendPlugins([\n        new webpack.BannerPlugin({\n          banner: 'hello world!',\n        }),\n      ]);\n\n      // Add multiple plugins\n      appendPlugins([new PluginA(), new PluginB()]);\n    },\n  },\n};\n\n\n\nremovePlugin#\n\n * Type: (name: string) => void\n\nRemove the internal webpack plugin, the parameter is the constructor.name of the\nplugin.\n\nFor example, remove the internal fork-ts-checker-webpack-plugin:\n\nexport default {\n  tools: {\n    webpack: (config, { removePlugin }) => {\n      removePlugin('ForkTsCheckerWebpackPlugin');\n    },\n  },\n};\n\n\n\nmergeConfig#\n\n * Type: (...configs: WebpackConfig[]) => WebpackConfig\n\nUsed to merge multiple webpack configs, same as webpack-merge\n\nexport default {\n  tools: {\n    webpack: (config, { mergeConfig }) => {\n      return mergeConfig(config, {\n        devtool: 'eval',\n      });\n    },\n  },\n};\n\n\n\ntools.webpackChain#\n\n * Type: Function | undefined\n * Default: undefined\n * Bundler: only support webpack\n\nYou can modify the webpack configuration by configuring tools.webpackChain which\nis type of Function. The function receives two parameters, the first is the\noriginal webpack chain object, and the second is an object containing some\nutils.\n\nCompared with tools.webpack, webpack-chain not only supports chained calls, but\nalso can locate built-in Rule or Plugin based on aliases, so as to achieve\nprecise config modification. We recommend using tools.webpackChain instead of\ntools.webpack.\n\n> tools.webpackChain is executed earlier than tools.webpack and thus will be\n> overridden by changes in tools.webpack.\n\n\nUtils#\n\nenv#\n\n * Type: 'development' | 'production' | 'test'\n\nThe env parameter can be used to determine whether the current environment is\ndevelopment, production or test. For example:\n\nexport default {\n  tools: {\n    webpackChain: (chain, { env }) => {\n      if (env === 'development') {\n        chain.devtool('cheap-module-eval-source-map');\n      }\n    },\n  },\n};\n\n\nisProd#\n\n * Type: boolean\n\nThe isProd parameter can be used to determine whether the current environment is\nproduction. For example:\n\nexport default {\n  tools: {\n    webpackChain: (chain, { isProd }) => {\n      if (isProd) {\n        chain.devtool('source-map');\n      }\n    },\n  },\n};\n\n\ntarget#\n\n * Type: 'web' | 'node' | 'modern-web' | 'web-worker'\n\nThe target parameter can be used to determine the current environment. For\nexample:\n\nexport default {\n  tools: {\n    webpackChain: (chain, { target }) => {\n      if (target === 'node') {\n        // ...\n      }\n    },\n  },\n};\n\n\nisServer#\n\n * Type: boolean\n\nDetermines whether the target environment is node, equivalent to target ===\n'node'.\n\nexport default {\n  tools: {\n    webpackChain: (chain, { isServer }) => {\n      if (isServer) {\n        // ...\n      }\n    },\n  },\n};\n\n\nisWebWorker#\n\n * Type: boolean\n\nDetermines whether the target environment is web-worker, equivalent to target\n=== 'web-worker'.\n\nexport default {\n  tools: {\n    webpackChain: (chain, { isWebWorker }) => {\n      if (isWebWorker) {\n        // ...\n      }\n    },\n  },\n};\n\n\nwebpack#\n\n * Type: typeof import('webpack')\n\nThe webpack instance. For example:\n\nexport default {\n  tools: {\n    webpackChain: (chain, { webpack }) => {\n      chain.plugin('my-progress').use(webpack.ProgressPlugin);\n    },\n  },\n};\n\n\n\nHtmlWebpackPlugin#\n\n * Type: typeof import('html-webpack-plugin')\n\nThe HtmlWebpackPlugin instance:\n\nexport default {\n  tools: {\n    webpackChain: (chain, { HtmlWebpackPlugin }) => {\n      console.log(HtmlWebpackPlugin);\n    },\n  },\n};\n\n\nCHAIN_ID#\n\nSome common Chain IDs are predefined in the Builder, and you can use these IDs\nto locate the built-in Rule or Plugin.\n\nCHAIN_ID.RULE#\n\nID           DESCRIPTION\nRULE.MJS     Rule for mjs\nRULE.JS      Rule for js\nRULE.TS      Rule for ts\nRULE.CSS     Rule for css\nRULE.LESS    Rule for less\nRULE.SASS    Rule for sass\nRULE.PUG     Rule for pug\nRULE.TOML    Rule for toml\nRULE.YAML    Rule for yaml\nRULE.FONT    Rule for font\nRULE.IMAGE   Rule for image\nRULE.MEDIA   Rule for media\n\n\nCHAIN_ID.ONE_OF#\n\nONE_OF.XXX can match a certain type of rule in the rule array.\n\nID                  DESCRIPTION\nONE_OF.SVG          Rules for SVG, automatic choice between data URI and\n                    separate file\nONE_OF.SVG_URL      Rules for SVG, output as a separate file\nONE_OF.SVG_INLINE   Rules for SVG, inlined into bundles as data URIs\nONE_OF.SVG_ASSETS   Rules for SVG, automatic choice between data URI and\n                    separate file\n\n\nCHAIN_ID.USE#\n\nUSE.XXX can match a certain loader.\n\nID                     DESCRIPTION\nUSE.TS                 correspond to ts-loader\nUSE.CSS                correspond to css-loader\nUSE.LESS               correspond to less-loader\nUSE.SASS               correspond to sass-loader\nUSE.PUG                correspond to pug-loader\nUSE.TOML               correspond to toml-loader\nUSE.YAML               correspond to yaml-loader\nUSE.FILE               correspond to file-loader\nUSE.URL                correspond to url-loader\nUSE.SVGR               correspond to @svgr/webpack\nUSE.BABEL              correspond to babel-loader\nUSE.STYLE              correspond to style-loader\nUSE.POSTCSS            correspond to postcss-loader\nUSE.MARKDOWN           correspond to markdown-loader\nUSE.CSS_MODULES_TS     correspond to css-modules-typescript-loader\nUSE.MINI_CSS_EXTRACT   correspond to mini-css-extract-plugin.loader\n\n\nCHAIN_ID.PLUGIN#\n\nPLUGIN.XXX can match a certain webpack plugin.\n\nID                             DESCRIPTION\nPLUGIN.HMR                     correspond to HotModuleReplacementPlugin\nPLUGIN.COPY                    correspond to CopyWebpackPlugin\nPLUGIN.HTML                    correspond to HtmlWebpackPlugin, you need to splice the\n                               entry name when using: ${PLUGIN.HTML}-${entryName}\nPLUGIN.DEFINE                  correspond to DefinePlugin\nPLUGIN.IGNORE                  correspond to IgnorePlugin\nPLUGIN.BANNER                  correspond to BannerPlugin\nPLUGIN.PROGRESS                correspond to Webpackbar\nPLUGIN.APP_ICON                correspond to AppIconPlugin\nPLUGIN.LOADABLE                correspond to LoadableWebpackPlugin\nPLUGIN.MANIFEST                correspond to WebpackManifestPlugin\nPLUGIN.TS_CHECKER              correspond to ForkTsCheckerWebpackPlugin\nPLUGIN.INLINE_HTML             correspond to InlineChunkHtmlPlugin\nPLUGIN.BUNDLE_ANALYZER         correspond to WebpackBundleAnalyzer\nPLUGIN.BOTTOM_TEMPLATE         correspond to BottomTemplatePlugin\nPLUGIN.MINI_CSS_EXTRACT        correspond to MiniCssExtractPlugin\nPLUGIN.REACT_FAST_REFRESH      correspond to ReactFastRefreshPlugin\nPLUGIN.NODE_POLYFILL_PROVIDE   correspond to ProvidePlugin for node polyfills\nPLUGIN.INSPECTOR               correspond to @modern-js/inspector-webpack-plugin\nPLUGIN.SUBRESOURCE_INTEGRITY   correspond to webpack-subresource-integrity\nPLUGIN.ASSETS_RETRY            correspond to webpack static asset retry plugin in Builder\nPLUGIN.AUTO_SET_ROOT_SIZE      correspond to automatically set root font size plugin in\n                               Builder\n\n\nCHAIN_ID.MINIMIZER#\n\nMINIMIZER.XXX can match a certain minimizer.\n\nID                  DESCRIPTION\nMINIMIZER.JS        correspond to TerserWebpackPlugin\nMINIMIZER.CSS       correspond to CssMinimizerWebpackPlugin\nMINIMIZER.ESBUILD   correspond to ESBuildPlugin\nMINIMIZER.SWC       correspond to SwcWebpackPlugin\n\n\nExamples#\n\nThe following are some common configuration examples, see the full webpack-chain\nAPI webpack-chain documentation.\n\nAdd/Modify/Delete loader#\n\nexport default {\n  tools: {\n    webpackChain: (chain, { CHAIN_ID }) => {\n      // Add loader\n      chain.module\n        .rule('md')\n        .test(/\\.md$/)\n        .use('md-loader')\n        .loader('md-loader');\n\n      // Modify loader\n      chain.module\n        .rule(CHAIN_ID.RULE.JS)\n        .use(CHAIN_ID.USE.BABEL)\n        .tap(options => {\n          options.plugins.push('babel-plugin-xxx');\n          return options;\n        });\n\n      // Delete loader\n      chain.module.rule(CHAIN_ID.RULE.JS).uses.delete(CHAIN_ID.USE.BABEL);\n    },\n  },\n};\n\n\nAdd/Modify/Delete plugin#\n\nexport default {\n  tools: {\n    webpackChain: (chain, { webpack, CHAIN_ID }) => {\n      // Add plugin\n      chain.plugin('custom-define').use(webpack.DefinePlugin, [\n        {\n          'process.env': {\n            NODE_ENV: JSON.stringify(process.env.NODE_ENV),\n          },\n        },\n      ]);\n\n      // Modify plugin\n      chain.plugin(CHAIN_ID.PLUGIN.HMR).tap(options => {\n        options[0].fullBuildTimeout = 200;\n        return options;\n      });\n\n      // Delete plugin\n      chain.plugins.delete(CHAIN_ID.PLUGIN.HMR);\n    },\n  },\n};\n\n\n\ntools.rspack#\n\n * Type: Object | Function | undefined\n * Default: undefined\n * Bundler: only support Rspack\n\ntools.rspack is used to configure Rspack.\n\n\nObject Type#\n\nYou can configure it as an object, which will be merged with the original Rspack\nconfiguration through webpack-merge. For example:\n\nexport default {\n  tools: {\n    rspack: {\n      resolve: {\n        alias: {\n          '@util': 'src/util',\n        },\n      },\n    },\n  },\n};\n\n\n\nFunction Type#\n\nYou can also configure it as a function, which accepts one parameter, the\noriginal Rspack configuration, you can modify this configuration, and then\nreturn a new configuration. For example:\n\nexport default {\n  tools: {\n    rspack: config => {\n      config.resolve.alias['@util'] = 'src/util';\n      return config;\n    },\n  },\n};\n\n\nThe second parameter of this function is an object that contains some\ninformation about the tool collection. Details are as follows:\n\n\nUtils#\n\nenv#\n\n * Type: 'development' | 'production' | 'test'\n\nThe env parameter can be used to determine whether the current environment is\ndevelopment, production or test. For example:\n\nexport default {\n  tools: {\n    rspack: (config, { env }) => {\n      if (env === 'development') {\n        config.devtool = 'cheap-module-eval-source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\nisProd#\n\n * Type: boolean\n\nThe isProd parameter can be used to determine whether the current environment is\nproduction. For example:\n\nexport default {\n  tools: {\n    rspack: (config, { isProd }) => {\n      if (isProd) {\n        config.devtool = 'source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\ntarget#\n\n * Type: 'web' | 'node' | 'modern-web' | 'web-worker'\n\nThe target parameter can be used to determine the current target. For example:\n\nexport default {\n  tools: {\n    rspack: (config, { target }) => {\n      if (target === 'node') {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\nisServer#\n\n * Type: boolean\n\nDetermines whether the target environment is node, equivalent to target ===\n'node'.\n\nexport default {\n  tools: {\n    rspack: (config, { isServer }) => {\n      if (isServer) {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\nisWebWorker#\n\n * Type: boolean\n\nDetermines whether the target environment is web-worker, equivalent to target\n=== 'web-worker'.\n\nexport default {\n  tools: {\n    rspack: (config, { isWebWorker }) => {\n      if (isWebWorker) {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\n\naddRules#\n\n * Type: (rules: RuleSetRule | RuleSetRule[]) => void\n\nAdd additional Rspack rules.\n\nFor example:\n\nexport default {\n  tools: {\n    rspack: (config, { addRules }) => {\n      // add a single rule\n      addRules({\n        test: /\\.foo/,\n        loader: require.resolve('foo-loader'),\n      });\n\n      // Add multiple rules as an array\n      addRules([\n        {\n          test: /\\.foo/,\n          loader: require.resolve('foo-loader'),\n        },\n        {\n          test: /\\.bar/,\n          loader: require.resolve('bar-loader'),\n        },\n      ]);\n    },\n  },\n};\n\n\n\nprependPlugins#\n\n * Type: (plugins: RspackPluginInstance | RspackPluginInstance[]) => void\n\nAdd additional plugins to the head of the internal Rspack plugins array, and the\nplugin will be executed first.\n\nexport default {\n  tools: {\n    rspack: (config, { prependPlugins }) => {\n      // add a single plugin\n      prependPlugins(new PluginA());\n\n      // Add multiple plugins\n      prependPlugins([new PluginA(), new PluginB()]);\n    },\n  },\n};\n\n\n\nappendPlugins#\n\n * Type: (plugins: RspackPluginInstance | RspackPluginInstance[]) => void\n\nAdd additional plugins at the end of the internal Rspack plugins array, the\nplugin will be executed last.\n\nexport default {\n  tools: {\n    rspack: (config, { appendPlugins }) => {\n      // add a single plugin\n      appendPlugins([new PluginA()]);\n\n      // Add multiple plugins\n      appendPlugins([new PluginA(), new PluginB()]);\n    },\n  },\n};\n\n\n\nremovePlugin#\n\n * Type: (name: string) => void\n\nRemove the internal Rspack plugin, the parameter is the constructor.name of the\nplugin.\n\nFor example, remove the internal webpack-bundle-analyzer:\n\nexport default {\n  tools: {\n    rspack: (config, { removePlugin }) => {\n      removePlugin('BundleAnalyzerPlugin');\n    },\n  },\n};\n\n\n\nmergeConfig#\n\n * Type: (...configs: RspackConfig[]) => RspackConfig\n\nUsed to merge multiple Rspack configs, same as webpack-merge\n\nexport default {\n  tools: {\n    rspack: (config, { mergeConfig }) => {\n      return mergeConfig(config, {\n        devtool: 'eval',\n      });\n    },\n  },\n};\n","frontmatter":{"extractApiHeaders":[2]}},{"id":11,"title":"API","routePath":"/builder/en/api/","lang":"en","toc":[],"domain":"","content":"#","frontmatter":{"overview":true}},{"id":12,"title":"Plugin Core","routePath":"/builder/en/api/plugin-core","lang":"en","toc":[{"text":"BuilderPlugin","id":"builderplugin","depth":2},{"text":"BuilderPluginAPI","id":"builderpluginapi","depth":2},{"text":"Plugin for webpack-provider","id":"plugin-for-webpack-provider","depth":3},{"text":"Plugins for rspack-provider","id":"plugins-for-rspack-provider","depth":3},{"text":"Plugins for both webpack-provider and rspack-provider","id":"plugins-for-both-webpack-provider-and-rspack-provider","depth":3},{"text":"api.context","id":"api.context","depth":2},{"text":"api.getBuilderConfig","id":"api.getbuilderconfig","depth":2},{"text":"api.getNormalizedConfig","id":"api.getnormalizedconfig","depth":2},{"text":"api.isPluginExists","id":"api.ispluginexists","depth":2},{"text":"api.getHTMLPaths","id":"api.gethtmlpaths","depth":2}],"domain":"","content":"#\n\nThis section describes the core plugin types and APIs.\n\n\nBuilderPlugin#\n\nThe type of the plugin object. The plugin object contains the following\nproperties:\n\n * name: The name of the plugin, a unique identifier.\n * setup: The setup function of the plugin, which can be an asynchronous\n   function. This function will only be executed once when the plugin is\n   initialized.\n\nexport type BuilderPlugin = {\n  name: string;\n  setup: (api: API) => Promise | void;\n};\n\n\nYou can import this type from @modern-js/builder:\n\n\n\nexport default (): BuilderPlugin => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.onAfterBuild(() => {\n      console.log('after build!');\n    });\n  },\n});\n\n\n\nBuilderPluginAPI#\n\nThe type of plugin API. The plugin API provides the context info, utility\nfunctions and lifecycle hooks.\n\nFor a complete introduction to lifecycle hooks, please read the Plugin Hooks\nchapter.\n\nWhen using webpack-provider or rspack-provider, the type definition of\nBuilderPluginAPI is somewhat different, and you can introduce the corresponding\ntype according to the usage scenario of the plugin.\n\n\nPlugin for webpack-provider#\n\nWhen developing plugins for webpack-provider, please import BuilderPluginAPI\nfrom @modern-js/builder-webpack-provider.\n\n\n\n\nexport default (): BuilderPlugin => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.modifyWebpackConfig(config => {\n      config.devtool = false;\n    });\n  },\n});\n\n\n\nPlugins for rspack-provider#\n\nWhen developing plugins for rspack-provider, please import BuilderPluginAPI from\n@modern-js/builder-rspack-provider.\n\n\n\n\nexport default (): BuilderPlugin => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.modifyRspackConfig(config => {\n      config.devtool = false;\n    });\n  },\n});\n\n\n\nPlugins for both webpack-provider and rspack-provider#\n\nWhen developing plugins for both webpack-provider and rspack-provider, please\nimport DefaultBuilderPlugin from @modern-js/builder-shared.\n\nNote that developing plugins that can support both webpack and Rspack at the\nsame time means that you cannot use any APIs with webpack / Rspack identifiers,\nsuch as modifyWebpackConfig or modifyRspackConfig.\n\nYou can use modifyBundlerChain to modify the configuration that applies to both\nwebpack and Rspack.\n\n\n\n\nexport default (): BuilderPlugin => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.modifyBundlerChain(chain => {\n      chain.devtool(false);\n    });\n  },\n});\n\n\n\napi.context#\n\napi.context is a read-only object that provides some context information.\n\nThe content of api.context is exactly the same as builder.context, please refer\nto builder.context.\n\n * Example\n\nconst builderPluginFoo = () => ({\n   setup(api) {\n     console.log(api.context.distPath);\n   }\n);\n\n\n\napi.getBuilderConfig#\n\nGet the Builder config, this method must be called after the modifyBuilderConfig\nhook is executed.\n\n * Type\n\nfunction GetBuilderConfig(): Readonly;\n\n\n * Example\n\nconst builderPluginFoo = () => ({\n   setup(api) {\n     const config = api.getBuilderConfig();\n     console.log(config.html?.title);\n   }\n);\n\n\n\napi.getNormalizedConfig#\n\nGet the normalized Builder config, this method must be called after the\nmodifyBuilderConfig hook is executed.\n\nCompared with the api.getBuilderConfig method, the config returned by this\nmethod has been normalized, and the type definition of the config will be\nnarrowed. For example, the undefined type of config.html will be removed.\n\nIt is recommended to use this method to get the Builder config.\n\n * Type\n\nfunction GetNormalizedConfig(): Readonly;\n\n\n * Example\n\nconst builderPluginFoo = () => ({\n   setup(api) {\n     const config = api.getNormalizedConfig();\n     console.log(config.html.title);\n   }\n);\n\n\n\napi.isPluginExists#\n\nDetermines whether a plugin has been registered.\n\n * Type\n\nfunction IsPluginExists(pluginName: string): boolean;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    console.log(api.isPluginExists('builder-plugin-foo'));\n  },\n});\n\n\n\napi.getHTMLPaths#\n\nGet path information for all HTML assets.\n\nThis method will return an object, the key is the entry name and the value is\nthe relative path of the HTML file in the dist directory.\n\n * Type\n\nfunction GetHTMLPaths(): Record;\n\n\n * Example\n\nconst builderPluginFoo = () => ({\n   setup(api) {\n     api.modifyWebpackChain(() => {\n       const htmlPaths = api.getHTMLPaths();\n       console.log(htmlPaths); // { main: 'html/main/index.html' };\n     });\n   }\n);\n","frontmatter":{"extractApiHeaders":[2]}},{"id":13,"title":"Plugin Hooks","routePath":"/builder/en/api/plugin-hooks","lang":"en","toc":[{"text":"Overview","id":"overview","depth":2},{"text":"Common Hooks","id":"common-hooks","depth":2},{"text":"modifyBuilderConfig","id":"modifybuilderconfig","depth":3},{"text":"modifyBundlerChain experimental","id":"modifybundlerchain-experimental","depth":3},{"text":"modifyWebpackChain","id":"modifywebpackchain","depth":3},{"text":"modifyWebpackConfig","id":"modifywebpackconfig","depth":3},{"text":"modifyRspackConfig","id":"modifyrspackconfig","depth":3},{"text":"onBeforeCreateCompiler","id":"onbeforecreatecompiler","depth":3},{"text":"onAfterCreateCompiler","id":"onaftercreatecompiler","depth":3},{"text":"Build Hooks","id":"build-hooks","depth":2},{"text":"onBeforeBuild","id":"onbeforebuild","depth":3},{"text":"onAfterBuild","id":"onafterbuild","depth":3},{"text":"Dev Server Hooks","id":"dev-server-hooks","depth":2},{"text":"onBeforeStartDevServer","id":"onbeforestartdevserver","depth":3},{"text":"onAfterStartDevServer","id":"onafterstartdevserver","depth":3},{"text":"onDevCompileDone","id":"ondevcompiledone","depth":3},{"text":"Other Hooks","id":"other-hooks","depth":2},{"text":"onExit","id":"onexit","depth":3}],"domain":"","content":"#\n\nThis section describes the lifetime hooks provided by Builder plugin.\n\n\nOverview#\n\nCommon Hooks\n\n * modifyBuilderConfig: Modify raw config of Builder.\n * modifyBundlerChain (experimental): Modify config of webpack or Rspack via the\n   bundler chain api.\n * modifyWebpackChain: Modify webpack-chain.\n * modifyWebpackConfig: Modify raw config of webpack.\n * modifyRspackConfig: Modify raw config of Rspack.\n * onBeforeCreateCompiler: Called before creating compiler instance.\n * onAfterCreateCompiler: Called after the compiler object is created, but\n   before the build is executed.\n\nBuild HooksCalled only when the build method is executed to build the\nproduction outputs.\n\n * onBeforeBuild: Called before the production build is executed.\n * onAfterBuild: Called after executing the production build, you can get the\n   build stats.\n\nDev Server Hooks: Called only when the startDevServer method is executed to run\nthe development server.\n\n * onBeforeStartDevServer: Called before starting the development server.\n * onAfterStartDevServer: Called after starting the development server.\n * onDevCompileDone: Called after each development compile.\n\nOther Hooks\n\n * onExit: Called when the process is going to exit.\n\n\nCommon Hooks#\n\n\nmodifyBuilderConfig#\n\nModify the config passed to the Builder, you can directly modify the config\nobject, or return a new object to replace the previous object.\n\n * Type\n\ntype ModifyWebpackChainUtils = {\n  mergeBuilderConfig: typeof mergeBuilderConfig;\n};\n\nfunction ModifyBuilderConfig(\n  callback: (\n    config: BuilderConfig,\n    utils: ModifyWebpackChainUtils,\n  ) => PromiseOrNot,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.modifyBuilderConfig((config, { mergeBuilderConfig }) => {\n      config.html = config.html || {};\n      config.html.title = 'Hello World!';\n      return mergeBuilderConfig(config, {\n        source: { preEntry: 'foo.js' },\n      });\n    });\n  },\n});\n\n\n\nmodifyBundlerChain experimental#\n\nBundler chain is a subset of webpack chain, which contains part of the webpack\nchain API that you can use to modify both webpack and Rspack configuration.\n\nmodifyBundlerChain is used to call the bundler chain to modify the webpack /\nRspack configuration. You can use this hook when using webpack-provider or\nrspack-provider.\n\nThis hook only supports modifying the configuration of the non-differentiated\nparts of webpack and Rspack. For example, modifying the devtool configuration\nitem (webpack and Rspack have the same devtool property value type), or adding\nan Rspack-compatible webpack plugin.\n\n * Type\n\ntype ModifyBunlderChainUtils = {\n  env: NodeEnv;\n  isProd: boolean;\n  target: BuilderTarget;\n  isServer: boolean;\n  isWebWorker: boolean;\n  CHAIN_ID: ChainIdentifier;\n  HtmlPlugin: typeof import('html-webpack-plugin');\n};\n\nfunction ModifyBundlerChain(\n  callback: (\n    chain: BundlerChain,\n    utils: ModifyBunlderChainUtils,\n  ) => Promise | void,\n): void;\n\n\n * Example\n\n\n\nexport default () => ({\n  setup: api => {\n    api.modifyBundlerChain((chain, utils) => {\n      if (utils.env === 'development') {\n        chain.devtool('eval');\n      }\n\n      chain.plugin('bundle-analyze').use(BundleAnalyzerPlugin);\n    });\n  },\n});\n\n\n\nmodifyWebpackChain#\n\nModify the webpack config through the webpack chain. This method is only called\nwhen using webpack-provider.\n\n * Type\n\ntype ModifyWebpackChainUtils = {\n  env: NodeEnv;\n  isProd: boolean;\n  target: BuilderTarget;\n  webpack: typeof import('webpack');\n  isServer: boolean;\n  isWebWorker: boolean;\n  CHAIN_ID: ChainIdentifier;\n  getCompiledPath: (name: string) => string;\n  HtmlWebpackPlugin: typeof import('html-webpack-plugin');\n};\n\nfunction ModifyWebpackChain(\n  callback: (\n    chain: WebpackChain,\n    utils: ModifyWebpackChainUtils,\n  ) => Promise | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.modifyWebpackChain((chain, utils) => {\n      if (utils.env === 'development') {\n        chain.devtool('eval');\n      }\n    });\n  },\n});\n\n\n\nmodifyWebpackConfig#\n\nTo modify the final webpack config object, you can directly modify the config\nobject, or return a new object to replace the previous object. This method is\nonly called when using webpack-provider.\n\nThis method is called later than the modifyWebpackChain hook.\n\n * Type\n\ntype ModifyWebpackConfigUtils = {\n  env: NodeEnv;\n  isProd: boolean;\n  target: BuilderTarget;\n  webpack: typeof import('webpack');\n  isServer: boolean;\n  isWebWorker: boolean;\n  CHAIN_ID: ChainIdentifier;\n  getCompiledPath: (name: string) => string;\n  HtmlWebpackPlugin: typeof import('html-webpack-plugin');\n  addRules: (rules: RuleSetRule | RuleSetRule[]) => void;\n  prependPlugins: (\n    plugins: WebpackPluginInstance | WebpackPluginInstance[],\n  ) => void;\n  appendPlugins: (\n    plugins: WebpackPluginInstance | WebpackPluginInstance[],\n  ) => void;\n  removePlugin: (pluginName: string) => void;\n};\n\nfunction ModifyWebpackConfig(\n  callback: (\n    config: WebpackConfig,\n    utils: ModifyWebpackConfigUtils,\n  ) => Promise | WebpackConfig | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.modifyWebpackConfig((config, utils) => {\n      if (utils.env === 'development') {\n        config.devtool = 'eval';\n      }\n    });\n  },\n});\n\n\n\nmodifyRspackConfig#\n\nTo modify the final Rspack config object, you can directly modify the config\nobject, or return a new object to replace the previous object. This method is\nonly called when using rspack-provider.\n\n * Type\n\ntype ModifyRspackConfigUtils = {\n  env: NodeEnv;\n  isProd: boolean;\n  target: BuilderTarget;\n  isServer: boolean;\n  isWebWorker: boolean;\n  getCompiledPath: (name: string) => string;\n};\n\nfunction ModifyRspackConfig(\n  callback: (\n    config: RspackConfig,\n    utils: ModifyRspackConfigUtils,\n  ) => Promise | RspackConfig | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.modifyRspackConfig((config, utils) => {\n      if (utils.env === 'development') {\n        config.devtool = 'eval';\n      }\n    });\n  },\n});\n\n\n\nonBeforeCreateCompiler#\n\nCalled before creating the compiler instance, when you execute\nbuilder.startDevServer, builder.build or builder.createCompiler, this hook will\nbe called. You can get the final config object of the bundler through the\nbundlerConfigs parameter.\n\n * Type\n\nfunction OnBeforeCreateCompiler(\n  callback: (params: {\n    bundlerConfigs: WebpackConfig[] | RspackConfig[];\n  }) => Promise | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onBeforeCreateCompiler(({ bundlerConfigs }) => {\n      console.log('the bundler config is ', bundlerConfigs);\n    });\n  },\n});\n\n\n\nonAfterCreateCompiler#\n\nCalled after creating a compiler instance, before executing a build, when you\nexecute builder.startDevServer, builder.build or builder.createCompiler, this\nhook will be called. You can get the compiler instance through the compiler\nparameter.\n\n * Type\n\nfunction OnAfterCreateCompiler(callback: (params: {\n  compiler: Compiler | MultiCompiler;\n}) => Promise | void;): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onAfterCreateCompiler(({ compiler }) => {\n      console.log('the compiler is ', compiler);\n    });\n  },\n});\n\n\n\nBuild Hooks#\n\n\nonBeforeBuild#\n\nCalled before executing the production environment build, you can get the final\nconfig object of the bundler through the bundlerConfigs parameter.\n\n * Type\n\nfunction OnBeforeBuild(\n  callback: (params: {\n    bundlerConfigs?: WebpackConfig[] | RspackConfig[];\n  }) => Promise | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onBeforeBuild(({ bundlerConfigs }) => {\n      console.log('the bundler config is ', bundlerConfigs);\n    });\n  },\n});\n\n\n\nonAfterBuild#\n\nCalled after executing the production build, you can get the build result\ninformation through the stats parameter.\n\n * Type\n\nfunction OnAfterBuild(\n  callback: (params: { stats?: Stats | MultiStats }) => Promise | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onAfterBuild(({ stats }) => {\n      console.log(stats?.toJson());\n    });\n  },\n});\n\n\n\nDev Server Hooks#\n\n\nonBeforeStartDevServer#\n\nCalled before starting the development server.\n\n * Type\n\nfunction OnBeforeStartDevServer(callback: () => Promise | void): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onBeforeStartDevServer(() => {\n      console.log('before start!');\n    });\n  },\n});\n\n\n\nonAfterStartDevServer#\n\nCalled after starting the development server, you can get the port number\nthrough the port parameter.\n\n * Type\n\nfunction OnAfterStartDevServer(\n  callback: (params: { port: number }) => Promise | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onAfterStartDevServer(({ port }) => {\n      console.log('this port is: ', port);\n    });\n  },\n});\n\n\n\nonDevCompileDone#\n\nCalled after each development environment build, you can use isFirstCompile to\ndetermine whether it is the first build.\n\n * Type\n\nfunction OnDevCompileDone(\n  callback: (params: { isFirstCompile: boolean }) => Promise | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onDevCompileDone(({ isFirstCompile }) => {\n      if (isFirstCompile) {\n        console.log('first compile!');\n      } else {\n        console.log('re-compile!');\n      }\n    });\n  },\n});\n\n\n\nOther Hooks#\n\n\nonExit#\n\nCalled when the process is going to exit, this hook can only execute synchronous\ncode.\n\n * Type\n\nfunction OnExit(callback: () => void): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onExit(() => {\n      console.log('exit!');\n    });\n  },\n});\n","frontmatter":{"extractApiHeaders":[2]}},{"id":110,"title":"Alias","routePath":"/builder/en/guide/advanced/alias","lang":"en","toc":[{"text":"Using source.alias config","id":"using-source.alias-config","depth":2},{"text":"Using paths config in tsconfig.json","id":"using-paths-config-in-tsconfig.json","depth":2}],"domain":"","content":"#\n\nAlias is a way to specify a short name for a module or a path to a directory or\nfile. This can be useful when you want to use a short, easy-to-remember name for\na module instead of a long, complex path.\n\nFor example, if you have a file at src/common/request.ts, you could create an\nalias called @request for it, so you could `. This makes it easier to reference\nthe file in your code, and also allows you to move the file to a different\nlocation without having to update all the import statements in your code.\n\nIn Builder, you can set aliases in two ways:\n\n * source.alias\n * paths in tsconfig.json\n\n\nUsing source.alias config#\n\nsource.alias corresponds to webpack's native resolve.alias config, you can\nconfigure it as an object or a function.\n\nFirst, you can configure it as an object, for example:\n\nexport default {\n  source: {\n    alias: {\n      '@common': './src/common',\n    },\n  },\n};\n\n\nThe relative path in it will be parsed as an absolute path in Builder.\n\nYou can also configure it as a function to get the preset alias object and\nmodify it, for example:\n\nexport default {\n  source: {\n    alias: alias => {\n      alias['@common'] = './src/common';\n      return alias;\n    },\n  },\n};\n\n\n\nUsing paths config in tsconfig.json#\n\nIn addition to source.alias, you can also configure it by paths in\ntsconfig.json. We recommend to use this way in TypeScript projects, because it\ncan solve type problem of alias path.\n\nFor example:\n\n{\n  \"compilerOptions\": {\n    \"paths\": {\n      \"@common/*\": [\"./src/common/*\"]\n    }\n  }\n}\n\n\nPriority\nThe paths config has higher priority than source.alias.","frontmatter":{}},{"id":111,"title":"Browser Compatibility","routePath":"/builder/en/guide/advanced/browser-compatibility","lang":"en","toc":[{"text":"Set browserslist","id":"set-browserslist","depth":2},{"text":"Background knowledge","id":"background-knowledge","depth":2},{"text":"Syntax downgrade and API downgrade","id":"syntax-downgrade-and-api-downgrade","depth":3},{"text":"Syntax transpilation","id":"syntax-transpilation","depth":3},{"text":"API Polyfill","id":"api-polyfill","depth":3},{"text":"Downgrade method","id":"downgrade-method","depth":2},{"text":"Downgrade the current project code","id":"downgrade-the-current-project-code","depth":3},{"text":"Downgrade third-party dependencies","id":"downgrade-third-party-dependencies","depth":3},{"text":"Downgrade the code out of the current project","id":"downgrade-the-code-out-of-the-current-project","depth":3},{"text":"Polyfill mode","id":"polyfill-mode","depth":2},{"text":"entry mode","id":"entry-mode","depth":3},{"text":"usage mode","id":"usage-mode","depth":3},{"text":"Disable Polyfill","id":"disable-polyfill","depth":3}],"domain":"","content":"#\n\nThis chapter introduces how to use the capabilities provided by Builder to deal\nwith browser compatibility issues.\n\n\nSet browserslist#\n\nBefore dealing with compatibility issues, you first need to clarify which\nbrowsers your project needs to support, and add the corresponding browserslist\nconfig.\n\n * If you haven't set browserslist yet, please read the Browserslist chapter\n   first.\n\n * If you have set a browserslist, Builder will automatically compile according\n   to that scope, downgrade JavaScript syntax and CSS syntax, and inject the\n   required polyfill. In most cases, you can safely use modern ECMAScript\n   features without worrying about compatibility issues.\n\nAfter setting the browserslist, if you still encountered some compatibility\nissues, please continue reading below contents to find some solutions.\n\n\nBackground knowledge#\n\nBefore dealing with compatibility issues, it is recommended that you understand\nthe following background knowledge to better handle related issues.\n\n\nSyntax downgrade and API downgrade#\n\nWhen you use higher-version syntax and API in your project, in order to make the\ncompiled code run stably in lower-version browsers, we need to downgrade two\nparts: syntax downgrade and API downgrade.\n\nBuilder downgrades syntax through syntax transpilation, and downgrades API\nthrough inject polyfill.\n\n> Grammar and API are not strongly bound. When browser manufacturers implement\n> the engine, they will support some syntax or implement some APIs in advance\n> according to the specification or their own needs. Therefore, browsers from\n> different manufacturers in the same period are not necessarily compatible with\n> syntax and API. So in general practice, syntax and API are handled in two\n> parts.\n\n\nSyntax transpilation#\n\nSyntax is a series of rules for how a programming language organizes code, and\ncode that does not follow these rules cannot be correctly recognized by the\nprogramming language's engine and therefore cannot be run. In JavaScript, the\nfollowing examples are syntax rules:\n\n * In const foo = 1, const means to declare an immutable constant.\n * In foo?.bar?.baz, ?. indicates optional chaining of access properties.\n * In async function () {}, async means to declare an asynchronous function.\n\nBecause the parsers of different browsers can support different syntax,\nespecially the old version of the browser engine can support less grammar, so\nwhen some syntax are run in the lower version of the browser engine, an error\nwill be reported at the stage of parsing the AST .\n\nFor example, the following code will report an error in IE browser or a lower\nversion of Node.js:\n\nconst foo = {};\nfoo?.bar();\n\n\nWhen we run this code in a low version of Node.js, the following error message\nwill appear:\n\nSyntaxError: Unexpected token.\n   at Object.exports.runInThisContext (vm.js:73:16)\n   at Object. ([eval]-wrapper:6:22)\n   at Module._compile (module.js:460:26)\n   at evalScript (node.js:431:25)\n   at startup (node.js:90:7)\n   at node.js:814:3\n\n\nIt is obvious from the error message that this is a syntax error. This means\nthat this syntax is not supported in lower versions of the engine.\n\nSyntax can not be supported by polyfill or shim. If you want to run some syntax\nthat it does not originally support in a low-version browser, you need to\ntranspile the code into a syntax that the low-version engine can support.\n\nTranspile the above code into the following code to run in lower version\nengines:\n\nvar foo = {};\nfoo === null || foo === void 0 ? void 0 : foo.bar();\n\n\nAfter transpilation, the syntax of the code has changed, and some syntax that\nthe engine of the lower version cannot understand has been replaced with the\nsyntax it can understand, but the meaning of the code itself has not changed.\n\nIf the engine encounters an unrecognized syntax when converting to AST, it will\nreport a syntax error and abort the code execution process. In this case, if\nyour project does not use capabilities such as SSR or SSG, the page will be\nblank, making the page unavailable.\n\nIf the code is successfully converted to AST, the engine will convert the AST\ninto executable code and execute it normally inside the engine.\n\n\nAPI Polyfill#\n\nJavaScript is an interpreted scripting language, unlike compiled languages like\nRust. Rust will check the calls in the code during the compilation phase, and\nJavaScript does not know whether the function called by this line of code exists\nbefore it actually runs to a certain line of code, so some errors will only\nappear at runtime.\n\nFor example:\n\nvar str = 'Hello world!';\nconsole.log(str.notExistedMethod());\n\n\nThe above code has correct syntax and can be converted to AST correctly in the\nfirst stage of the engine runtime, but when it is actually running, because the\nmethod notExistedMethod does not exist on String.prototype, an error will be\nreported:\n\nUncaught TypeError: str.notExistedMethod is not a function\n   at :2:17\n\n\nWith the iteration of ECMAScript, some new methods will be added to be built-in\nobjects. For example, String.prototype.replaceAll was introduced in ES2021, then\nthe replaceAll method does not exist in the built-in object String.prototype of\nmost browser engines before 2021, so the following code works in the latest\nChrome, but not in earlier versions:\n\n'abc'.replaceAll('abc', 'xyz');\n\n\nIn order to solve the problem that String.prototype lacks replaceAll in older\nbrowsers, we can extend the String.prototype object in older browsers and add\nthe replaceAll method to it, for example:\n\n// The implementation of this polyfill does not necessarily conform to the standard, it is only used as an example.\nif (!String.prototype.replaceAll) {\n  String.prototype.replaceAll = function (str, newStr) {\n    // If a regex pattern\n    if (\n      Object.prototype.toString.call(str).toLowerCase() === '[object regexp]'\n    ) {\n      return this.replace(str, newStr);\n    }\n    // If a string\n    return this.replace(new RegExp(str, 'g'), newStr);\n  };\n}\n\n\n> This technique of providing implementations for legacy environments to align\n> new APIs is called polyfill.\n\n\nDowngrade method#\n\nIn Builder, we divide code into three categories:\n\n * The first category is the source code in the current project.\n * The second category is third-party dependencies installed through npm.\n * The third category is the code out of the current project, such as the code\n   in other directories in the monorepo.\n\nBy default, Builder will only compile and downgrade the first category, other\ncategories will not be downgraded by default.\n\nThere are several considerations for this approach:\n\n * Downgrading all third-party party dependencies will significantly reduce\n   build performance.\n * Most third-party dependencies have been downgraded before release, and the\n   second downgrade may introduce new problems.\n * The code out of the current project may have been compiled, or the\n   compilation config may be different.\n\n\nDowngrade the current project code#\n\nThe code of the current project will be downgraded by default, so you don't need\nto add additional config, just make sure that the browserslist config is set\ncorrectly.\n\n\nDowngrade third-party dependencies#\n\nWhen you find that a third-party dependencies causes compatibility issues, you\ncan add this dependency to Builder's source.include config, Make Builder do\nextra compilation for this dependency.\n\nTaking the npm package query-string as an example, you can add the following\nconfig:\n\n\n\nexport default {\n  source: {\n    include: [/\\/query-string\\//],\n  },\n};\n\n\nPlease refer to source.include document for detailed usage guide.\n\n\nDowngrade the code out of the current project#\n\nWhen you import the code out of the current project, if the code has not been\ncompiled, then you also need to configure source.include to it to compile.\n\nFor example, if you need to reference a module under the packages directory in\nthe monorepo, you can add the following config:\n\n\n\nexport default {\n  source: {\n    include: [\n      // method one:\n      // Compile all files in the package directory of Monorepo\n      path.resolve(__dirname, '../../packages'),\n\n      // Method Two:\n      // Compile the source code of a package in the Monorepo's package directory\n      // The matching range of this writing method is more precise, and has less impact on the overall compilation performance\n      path.resolve(__dirname, '../../packages/xxx/src'),\n    ],\n  },\n};\n\n\n\nPolyfill mode#\n\nBuilder compiles JavaScript code through babel or SWC, and injects polyfill\nlibraries like core-js, @babel/runtime and @swc/helpers.\n\nIn different usage scenarios, you may need different polyfill solutions. Builder\nprovides output.polyfill config to switch between different polyfill modes.\n\n\nentry mode#\n\nentry is the default mode and does not need to be set manually.\n\nWhen using the entry mode, Builder will analyze which core-js methods need to be\ninjected according to the browserslist set by the current project, and inject\nthem to the entry file of each page. The polyfill injected in this way is more\ncomprehensive, and there is no need to worry about the project source code and\nthird-party dependencies polyfill issues. However, because some unused polyfill\ncodes are included, the bundle size may increase.\n\nThe config of entry mode is:\n\nexport default {\n  output: {\n    polyfill: 'entry',\n  },\n};\n\n\n\nusage mode#\n\nThe usage mode allows more precise control over which core-js polyfills need to\nbe injected.\n\nWhen you enable the usage mode, Builder will analyze the source code in the\nproject and determine which polyfills need to be injected.\n\nFor example, the code uses the Map object:\n\nvar b = new Map();\n\n\nAfter compilation, only the polyfills for Map will be injected into this file:\n\nimport 'core-js/modules/es.map';\nvar b = new Map();\n\n\nThe advantage of this method is that the size of the injected polyfill is\nsmaller, which is suitable for projects with higher requirements on bundle size.\nThe disadvantage is that polyfill may not be fully injected, because third-party\ndependencies will not be compiled and downgraded by default, so the polyfill\nrequired by third-party dependencies will not be analyzed. If you need to\nanalyze a third-party dependency, you also need to add it to source.include\nconfig.\n\nThe config of usage mode is:\n\nexport default {\n  output: {\n    polyfill: 'usage',\n  },\n};\n\n\n\nDisable Polyfill#\n\nYou can disable polyfill injection behavior by setting output.polyfill to 'off'.\n\nexport default {\n  output: {\n    polyfill: 'off',\n  },\n};\n\n\nWhen using this config, you need to ensure compatibility by yourself, such as\nmanually import the required polyfill code through source.preEntry.","frontmatter":{}},{"id":112,"title":"Browserslist","routePath":"/builder/en/guide/advanced/browserslist","lang":"en","toc":[{"text":"What is Browserslist","id":"what-is-browserslist","depth":2},{"text":"Set Browserslist","id":"set-browserslist","depth":2},{"text":"Example","id":"example","depth":3},{"text":"Use output.overrideBrowserslist config","id":"use-output.overridebrowserslist-config","depth":3},{"text":"Commonly used Browserslist","id":"commonly-used-browserslist","depth":2},{"text":"Mobile H5 scene","id":"mobile-h5-scene","depth":3},{"text":"Desktop PC scene","id":"desktop-pc-scene","depth":3},{"text":"Default Browserslist","id":"default-browserslist","depth":2},{"text":"Web Target","id":"web-target","depth":3},{"text":"Node Target","id":"node-target","depth":3},{"text":"Web Worker Target","id":"web-worker-target","depth":3},{"text":"Modern Web Target","id":"modern-web-target","depth":3},{"text":"Query browser support","id":"query-browser-support","depth":2}],"domain":"","content":"#\n\nBuilder supports using Browserslist to specify which browsers should be\nsupported in your Web application.\n\n\nWhat is Browserslist#\n\nSince different browsers support ECMAScript and CSS differently, developers need\nto set the correct browser range for web applications.\n\nBrowserslist can specify which browsers your web application can run in, it\nprovides a configuration for specifying browsers range. Browserslist has become\na standard in the industry, it is used by libraries such as Autoprefixer, Babel,\nESLint, PostCSS, SWC and Webpack.\n\nWhen you specify a browser range through Browserslist, Builder will compile\nJavaScript and CSS code to the specified syntax, and inject the corresponding\npolyfill code. When you only need to be compatible with modern browsers, the\ncompilation process will introduce less compatible code and polyfills, and the\nperformance of the page will be better.\n\nFor example, when you need to be compatible with IE11 browser, Builder will\ncompile the code to ES5 and inject the polyfill required by IE11 through\ncore-js.\n\nWhat is polyfill\nA polyfill is a piece of code that provides the functionality of a newer feature\nto older browsers that do not support that feature natively. It is used to fill\nin the gaps in older browsers' implementations of web standards, allowing\ndevelopers to use newer features safely without having to worry about whether or\nnot they will work in older browsers. For example, if a browser does not support\nthe Array.map() method, a polyfill can be used to provide that functionality,\nallowing code that uses Array.prototype.flat() to work in that browser.\nPolyfills are commonly used to ensure that web applications can work on a wide\nrange of browsers, including older ones.\n\n\nSet Browserslist#\n\nYou can set the Browserslist value in the package.json or .browserslistrc file\nin the root directory of the current project.\n\n\nExample#\n\nSet via browserslist in package.json:\n\n{\n  \"browserslist\": [\n    \"iOS >= 9\",\n    \"Android >= 4.4\",\n    \"last 2 versions\",\n    \"> 0.2%\",\n    \"not dead\"\n  ]\n}\n\n\nSet via a separate .browserslistrc file:\n\niOS >= 9\nAndroid >= 4.4\nlast 2 versions\n> 0.2%\nnot dead\n\n\n\nUse output.overrideBrowserslist config#\n\nIn addition to the above standard usage, Builder also provides\noutput.overrideBrowserslist config, which can also set the value of\nBrowserslist.\n\nexport default {\n  output: {\n    overrideBrowserslist: [\n      'iOS >= 9',\n      'Android >= 4.4',\n      'last 2 versions',\n      '> 0.2%',\n      'not dead',\n    ],\n  },\n};\n\n\nWhen you build multiple targets at the same time, you can set different browser\nranges for different targets. At this point, you need to set\noverrideBrowserslist to an object whose key is the corresponding build target.\n\nFor example to set different ranges for web and node:\n\nexport default {\n  output: {\n    overrideBrowserslist: {\n      web: [\n        'iOS >= 9',\n        'Android >= 4.4',\n        'last 2 versions',\n        '> 0.2%',\n        'not dead',\n      ],\n      node: ['node >= 14'],\n    },\n  },\n};\n\n\nIn most cases, it is recommended to use the .browserslistrc file rather than the\noverrideBrowserslist config. Because the .browserslistrc file is the official\nconfig file, it is more general and can be recognized by other libraries in the\ncommunity.\n\n\nCommonly used Browserslist#\n\nThe following are some commonly used Browserslist, you can choose according to\nyour project type.\n\n\nMobile H5 scene#\n\nThe mobile H5 scene is mainly compatible with iOS and Android systems, usually\nwe set Browserslist as:\n\niOS >= 9\nAndroid >= 4.4\nlast 2 versions\n> 0.2%\nnot dead\n\n\nThe above Browserslist will compile the code to the ES5 specification, which is\ncompatible with most mobile scenarios on the market. For the detailed browsers\nlist, please check browserslist.dev.\n\n\n\nYou can also choose to use the ES6 specification in the H5 scene, which will\nmake the performance of the page better. The corresponding Browserslist is as\nfollows:\n\niOS >= 10\nChrome >= 51\n> 0.5%\nnot dead\nnot op_mini all\n\n\n\nDesktop PC scene#\n\nIn the desktop PC scenario, if you need to be compatible with IE 11 browsers,\nyou can set Browserslist to:\n\n> 0.5%\nnot dead\nInternet Explorer 11\n\n\nThe above Browserslist will compile the code to the ES5 specification. For the\nspecific browser list, please check browserslist.dev.\n\nIf you don't need to be compatible with IE 11 browsers, you can adjust\nBrowserslist to get a more performant output, such as setting it to browsers\nthat supports native ES Modules:\n\nchrome >= 61\nedge >= 16\nfirefox >= 60\nsafari >= 11\nios_saf >= 11\n\n\n\nDefault Browserslist#\n\nBuilder will set different default values of Browserslist according to build\ntarget, but we recommend that you explicitly set Browserslist in your project,\nwhich will make the compatible scope of the project more clear.\n\n\nWeb Target#\n\nThe default values of web target are as follows:\n\n> 0.01%\nnot dead\nnot op_mini all\n\n\nUnder this browser range, JavaScript code will be compiled to ES5 syntax.\n\n\nNode Target#\n\nNode target will be compatible with Node.js 14.0 by default.\n\nnode >= 14\n\n\n\nWeb Worker Target#\n\nThe default Browserslist of the Web Worker target is consistent with the Web\ntarget.\n\n> 0.01%\nnot dead\nnot op_mini all\n\n\n\nModern Web Target#\n\nModern Web target will be compatible with browsers that support native ES\nModules by default.\n\nchrome >= 61\nedge >= 16\nfirefox >= 60\nsafari >= 11\nios_saf >= 11\n\n\n\nQuery browser support#\n\nWhen developing, we need to know the browser support of certain features or\nAPIs. At this time, we can check on the caniuse website.\n\nFor example, we need to know the browser support of Promise, just enter Promise\nin caniuse, and you can see the following results:\n\n\n\nAs can be seen from the above table, Promise is natively supported in Chrome 33\nand iOS 8, but not in IE 11.","frontmatter":{}},{"id":113,"title":"Custom webpack config","routePath":"/builder/en/guide/advanced/custom-webpack-config","lang":"en","toc":[{"text":"Modify the webpack configuration object","id":"modify-the-webpack-configuration-object","depth":2},{"text":"Using webpack-chain","id":"using-webpack-chain","depth":2},{"text":"tools.webpackChain config","id":"tools.webpackchain-config","depth":3},{"text":"webpack-chain Basics","id":"webpack-chain-basics","depth":2},{"text":"How does webpack-chain locate","id":"how-does-webpack-chain-locate","depth":3},{"text":"webpack-chain id type","id":"webpack-chain-id-type","depth":3},{"text":"webpack-chain Demo","id":"webpack-chain-demo","depth":2},{"text":"Add/Modify/Delete loader","id":"add/modify/delete-loader","depth":3},{"text":"Add/Modify/Delete plugin","id":"add/modify/delete-plugin","depth":3},{"text":"Modify the config according to environment","id":"modify-the-config-according-to-environment","depth":3}],"domain":"","content":"#\n\nBuilder supports directly modifying webpack configuration objects, and also\nsupports deep customization of webpack configuration through webpack-chain.\n\n\nModify the webpack configuration object#\n\nYou can use tools.webpack to modify the webpack configuration object.\n\nexport default {\n  tools: {\n    webpack: (config, { env }) => {\n      if (env === 'development') {\n        config.devtool = 'cheap-module-eval-source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\nWhen to use\nWhen you only need to modify a small amount of webpack configuration, you can\nuse tools.webpack. But if you need to modify the built-in webpack plugins or\nloaders of Builder, please use tools.webpackChain to modify.\n\n\nUsing webpack-chain#\n\nwebpack-chain is a configuration modification tools that is different from\nmodifying webpack configuration objects. Compared with modifying webpack\nconfiguration objects, webpack-chain not only supports chain calls, but also can\nmodify built-in Rule or Plugin based on id.\n\n\ntools.webpackChain config#\n\nBuilder provides tools.webpackChain config to modify webpack-chain.\n\nThe value of tools.webpackChain is Function type, which receives two parameters:\n\n * The first parameter is the webpack-chain instance, you can use this instance\n   to modify the default webpack config.\n * The second parameter is a utils collection, including env, isProd, CHAIN_ID,\n   etc.\n\nHere's a basic example:\n\nexport default {\n  tools: {\n    webpackChain: (chain, { env }) => {\n      if (env === 'development') {\n        chain.devtool('cheap-module-eval-source-map');\n      }\n    },\n  },\n};\n\n\n\nwebpack-chain Basics#\n\nBefore you start using webpack-chain to modify your webpack configuration, it is\nrecommended that you understand some basics.\n\n\nHow does webpack-chain locate#\n\nSimply put, webpack-chain requires users to set a unique id for each Rule,\nLoader, Plugin, and Minimizer. Through these ids, you can easily find the\ndesired object from deeply nested webpack configuration object.\n\nBuilder exports all internally defined ids through the CHAIN_ID object, so you\ncan use these exported ids to locate the Loader or Plugin you want to modify,\nwithout having to search through complex traversal in the webpack configuration\nobject.\n\nFor example, to delete the built-in HTML plugin via CHAIN_ID.PLUGIN.HTML:\n\nexport default {\n  tools: {\n    webpackChain: (chain, { webpack, CHAIN_ID }) => {\n      //\n      chain.plugins.delete(CHAIN_ID.PLUGIN.HTML);\n    },\n  },\n};\n\n\n\nwebpack-chain id type#\n\nThe CHAIN_ID object contains some ids, which have different meanings:\n\nCHAIN_ID FIELD            CORRESPONDING CONFIGURATION   DESCRIPTION\nCHAIN_ID.PLUGIN           plugins[i]                    corresponds to a plugin in the webpack configuration\nCHAIN_ID.RULE             module.rules[i]               corresponds to a Rule in the webpack configuration\nCHAIN_ID.USE              module.rules[i].loader        corresponds to a Loader in the webpack configuration\nCHAIN_ID.MINIMIZER        optimization.minimizer        corresponds to a compression tool in webpack configuration\nCHAIN_ID.RESOLVE_PLUGIN   resolve.plugins[i]            corresponds to a Resolve plugin in the webpack configuration\n\n\nwebpack-chain Demo#\n\n\nAdd/Modify/Delete loader#\n\nexport default {\n  tools: {\n    webpackChain: (chain, { CHAIN_ID }) => {\n      // Add loader\n      chain.module\n        .rule('md')\n        .test(/\\.md$/)\n        .use('md-loader')\n        .loader('md-loader');\n\n      // Modify loader\n      chain.module\n        .rule(CHAIN_ID.RULE.JS)\n        .use(CHAIN_ID.USE.BABEL)\n        .tap(options => {\n          options.plugins.push('babel-plugin-xxx');\n          return options;\n        });\n\n      // Delete loader\n      chain.module.rule(CHAIN_ID.RULE.JS).uses.delete(CHAIN_ID.USE.BABEL);\n    },\n  },\n};\n\n\n\nAdd/Modify/Delete plugin#\n\nexport default {\n  tools: {\n    webpackChain: (chain, { webpack, CHAIN_ID }) => {\n      // Add plugin\n      chain.plugin('custom-define').use(webpack.DefinePlugin, [\n        {\n          'process.env': {\n            NODE_ENV: JSON.stringify(process.env.NODE_ENV),\n          },\n        },\n      ]);\n\n      // Modify plugin\n      chain.plugin(CHAIN_ID.PLUGIN.HMR).tap(options => {\n        options[0].fullBuildTimeout = 200;\n        return options;\n      });\n\n      // Delete plugin\n      chain.plugins.delete(CHAIN_ID.PLUGIN.HMR);\n    },\n  },\n};\n\n\n\nModify the config according to environment#\n\nIn the tool collection, you can get the flag of various environments, such as\ndevelopment/production/test environment, SSR build, and Web Worker build, so as\nto modify the config in different environments.\n\nexport default {\n  tools: {\n    webpackChain: (chain, { env, isProd, target, isServer, isWebWorker }) => {\n      if (utils.env === 'development' || utils.env === 'test') {\n        // ...\n      }\n      if (utils.isProd) {\n        // ...\n      }\n      if (utils.target === 'node') {\n        // ...\n      }\n      if (utils.isServer) {\n        // ...\n      }\n      if (utils.isWebWorker) {\n        // ...\n      }\n    },\n  },\n};\n\n\nThe above are some common config examples. For the complete webpack-chain API,\nplease refer to webpack-chain documentation.","frontmatter":{}},{"id":114,"title":"Using define config","routePath":"/builder/en/guide/advanced/define","lang":"en","toc":[{"text":"Default environment variables","id":"default-environment-variables","depth":2},{"text":"Replace Expressions","id":"replace-expressions","depth":3},{"text":"Setup Environment Variables","id":"setup-environment-variables","depth":2},{"text":"Declare type of environment variable","id":"declare-type-of-environment-variable","depth":2},{"text":"Tree Shaking","id":"tree-shaking","depth":2},{"text":"In-source testing","id":"in-source-testing","depth":2}],"domain":"","content":"Environment Variables#\n\nBuilder supports injecting environment variables or expressions into the code\nduring compilation, which is helpful for distinguishing the running environment\nor injecting constant values. This chapter introduces how to use environment\nvariables.\n\n\nDefault environment variables#\n\nBy default, Builder will automatically set the process.env.NODE_ENV environment\nvariable to 'development' in development mode and 'production' in production\nmode.\n\nYou can use process.env.NODE_ENV directly in configuration files and in\nfront-end code.\n\nif (process.env.NODE_ENV === 'development') {\n  console.log('this is a development log');\n}\n\n\nIn the development environment, the above code will be compiled as:\n\nif (true) {\n  console.log('this is a development log');\n}\n\n\nIn the production environment, the above code will be compiled as:\n\nif (false) {\n  console.log('this is a development log');\n}\n\n\nAfter code minification, if (false) { ... } will be recognized as invalid code\nand removed automatically.\n\n\nUsing define config#\n\nBy configuring the source.define, you can replace expressions with other\nexpressions or values in compile time.\n\nDefine looks like macro definitions in other programming languages. But\nJavaScript has powerful runtime capabilities, so you don't need to use it as a\ncomplicated code generator. You can use it to pass simple data, such as\nenvironment variables, from compile time to runtime. Almost there, it can be\nused to work with Builder to shake trees.\n\n\nReplace Expressions#\n\nThe most basic use case for Define is to replace expressions in compile time.\n\nThe value of the environment variable NODE_ENV will change the behavior of many\nvendor packages. Usually, we need to set it to production.\n\nexport default {\n  source: {\n    define: {\n      'process.env.NODE_ENV': JSON.stringify(process.env.NODE_ENV),\n    },\n  },\n};\n\n\nNote that the value provided here must be a JSON string, e.g.\nprocess.env.NODE_ENV with a value of \"production\" should be passed in as\n\"\\\"production\\\"\" to be processed correctly.\n\nSimilarly { foo: \"bar\" } should be converted to \"{\\\"foo\\\":\\\"bar\\\"}\", which if\npassed directly into the original object would mean replacing the expression\nprocess.env.NODE_ENV.foo with the identifier bar.\n\nFor more about source.define, just refer to API References\n\nTIP\nThe environment variable NODE_ENV shown in the example above is already injected\nby the Builder, and you usually do not need to configure it manually.\n\n\nSetup Environment Variables#\n\nYou may often need to set environment variables, in which case you can instead\nuse the source.globalVars configuration to simplify configuration. It is a\nsyntax sugar of source.define, the only difference is that source.globalVars\nwill automatically stringify the value, which makes it easier to set the value\nof global variables and avoid writing a lot of JSON.stringify(...) stuffs.\n\nexport default {\n  source: {\n    globalVars: {\n      'process.env.NODE_ENV': 'production',\n      'import.meta.foo': { bar: 42 },\n      'import.meta.baz': false,\n    },\n  },\n};\n\n\nNote that either of these methods will only match the full expression;\ndestructing the expression will prevent the Builder from correctly recognizing\nit.\n\nconsole.log(process.env.NODE_ENV);\n// => production\n\nconst { NODE_ENV } = process.env;\nconsole.log(NODE_ENV);\n// => undefined\n\nconst vars = process.env;\nconsole.log(vars.NODE_ENV);\n// => undefined\n\n\n\nDeclare type of environment variable#\n\nWhen you read an environment variable in a TypeScript file, TypeScript may\nprompt that the variable lacks a type definition, and you need to add the\ncorresponding type declaration.\n\nFor example, if you reference a CUSTOM_VAR variable, the following prompt will\nappear in the TypeScript file:\n\nTS2304: Cannot find name 'CUSTOM_VAR'.\n\n\nTo fix this, you can create a src/env.d.ts file in your project and add the\nfollowing content:\n\nsrc/env.d.ts\n\ndeclare const CUSTOM_VAR: string;\n\n\n\nTree Shaking#\n\nDefine can also be used to mark dead code to assist the Builder with Tree\nShaking optimization.\n\nBuilding products for different regions is achieved by replacing\nprocess.env.REGION with a specific value, for example.\n\nexport default {\n  source: {\n    define: {\n      'process.env.REGION': JSON.stringify(process.env.REGION),\n    },\n    // or...\n    globalVars: {\n      'process.env.REGION': process.env.REGION,\n    },\n  },\n};\n\n\nFor an internationalized app:\n\nconst App = () => {\n  if (process.env.REGION === 'cn') {\n    return ;\n  } else if (process.env.REGION === 'sg') {\n    return ;\n  } else {\n    return ;\n  }\n};\n\n\nSpecifying the environment variable REGION=sg and then executing build will\neliminate any dead code.\n\nconst App = () => {\n  if (false) {\n  } else if (true) {\n    return ;\n  } else {\n  }\n};\n\n\nUnused components are not packaged into the product, and their external\ndependencies can be optimized accordingly, resulting in a destination with\nbetter size and performance.\n\n\nIn-source testing#\n\nVitest supports writing tests inside source files to test the behavior of\nprivate features without exporting them. Set up Define to remove the test code\nfrom the production build. Please refer to the Vitest's documentation for\ndetailed guidelines\n\n// the implementation\nfunction add(...args) {\n  return args.reduce((a, b) => a + b, 0);\n}\n\n// in-source test suites\nif (import.meta.vitest) {\n  const { it, expect } = import.meta.vitest;\n  it('add', () => {\n    expect(add()).toBe(0);\n    expect(add(1)).toBe(1);\n    expect(add(1, 2, 3)).toBe(6);\n  });\n}\n","frontmatter":{}},{"id":115,"title":"Hot Module Replacement","routePath":"/builder/en/guide/advanced/hmr","lang":"en","toc":[{"text":"Enabling HMR","id":"enabling-hmr","depth":2},{"text":"Specify HMR URL","id":"specify-hmr-url","depth":2},{"text":"Live reloading vs Hot reloading","id":"live-reloading-vs-hot-reloading","depth":2},{"text":"FAQ","id":"faq","depth":2},{"text":"HMR not work when external react/reactDom?","id":"hmr-not-work-when-external-react/reactdom?","depth":3},{"text":"HMR not work when use https?","id":"hmr-not-work-when-use-https?","depth":3},{"text":"React component state lost after HMR?","id":"react-component-state-lost-after-hmr?","depth":3}],"domain":"","content":"#\n\nHot Module Replacement (HMR) exchanges, adds, or removes modules while an\napplication is running, without a full reload. This can significantly speed up\ndevelopment in a few ways:\n\n * Retain application state which is lost during a full reload.\n * Save valuable development time by only updating what's changed.\n * Instantly update the browser when modifications are made to CSS/JS in the\n   source code, which is almost comparable to changing styles directly in the\n   browser's dev tools.\n\n\nEnabling HMR#\n\nBuilder has built-in support for HMR. By default, HMR is enabled in development.\n\nBy setting dev.hmr to false, HMR can be disabled, which the HMR and\nreact-refresh will no longer work.\n\nexport default {\n  dev: {\n    hmr: false,\n  },\n};\n\n\n\nSpecify HMR URL#\n\nBy default, builder get HMR client URL by local-ip and current port.\n\nIn the event of a connection failure you can specify an available URL by custom\nconfiguration.\n\nFor example, set HMR client and port empty to auto derived from browser:\n\nexport default {\n  tools: {\n    devServer: {\n      client: {\n        host: '',\n        port: '',\n      },\n    },\n  },\n};\n\n\n\nLive reloading vs Hot reloading#\n\n * Live reloading: After modifying the file, webpack recompiles and forces a\n   browser refresh, which is a global (application-wide) refresh, equivalent to\n   window.location.reload().\n * Hot reloading: After modifying the file, webpack recompiles the corresponding\n   module and remembers the state of the application when it is refreshed, thus\n   enabling a partial refresh, i.e. hot update.\n\nDevServer provides two configuration items, hot and liveReload, to control how\nupdates are made. When both hot and liveReload are open, DevServer will attempt\nto use hot mode (HMR) first, and will degrade to reloading the page if the HMR\nupdate fails.\n\n\nFAQ#\n\n\nHMR not work when external react/reactDom?#\n\nHMR work requires the development mode of react & react-dom. The cdn version of\nreact normally used the production mode. You need to switch to development mode\nor make it not external when development.\n\nIf you're not sure which React mode you're using, you can see: Check React Mode\n\n\nHMR not work when use https?#\n\nWhen https is enabled, the HMR perhaps connection fail due to a certificate\nissue, and if you open the console, you will get an HMR connect failed error.\n\n\n\nThe solution to this problem is to click on \"Advanced\" -> \"Proceed to xxx\n(unsafe)\" on the Chrome problem page.\n\n\n\n> Tips: When accessing the page through Localhost, the words \"Your connection is\n> not private\" may not appear and can be handled by visiting the Network domain.\n\n\nReact component state lost after HMR?#\n\nBuilder uses React's official Fast Refresh capability for component hot update.\n\nWhen using Fast Refresh, it is required that the component cannot be an\nanonymous function, otherwise the state of the React component cannot be\npreserved after hot update.\n\nThe following spellings are incorrect:\n\n// wrong spelling 1\nexport default function () {\n  return \nHello World;\n}\n\n// wrong spelling 2\nexport default () => \nHello World;\n\n\nThe correct spelling is:\n\n// Correct spelling 1\nexport default function MyComponent() {\n  return \nHello World;\n}\n\n// Correct spelling 2\nconst MyComponent = () => \nHello World\n\nexport default MyComponent;\n","frontmatter":{}},{"id":116,"title":"REM adaptation","routePath":"/builder/en/guide/advanced/rem","lang":"en","toc":[{"text":"Enabling REM adaptability","id":"enabling-rem-adaptability","depth":2},{"text":"CSS conversion properties","id":"css-conversion-properties","depth":2},{"text":"Setting the page rootFontSize","id":"setting-the-page-rootfontsize","depth":2},{"text":"Customize maxRootFontSize","id":"customize-maxrootfontsize","depth":2},{"text":"How to determine if REM is in effect","id":"how-to-determine-if-rem-is-in-effect","depth":2},{"text":"How to get the rootFontSize value that is actually in effect on the page?","id":"how-to-get-the-rootfontsize-value-that-is-actually-in-effect-on-the-page?","depth":2}],"domain":"","content":"#\n\nBuilder supports REM adaptation via output.convertToRem, which can dynamically\nadjusts the font size according to the screen size, so that the page will be\ndisplayed correctly on different screen sizes.\n\n\nEnabling REM adaptability#\n\nBy setting output.convertToRem, the Builder can do the following things:\n\n * Convert px to rem in CSS.\n * Dynamic setting the fontSize of the root element.\n\nexport default {\n  output: {\n    convertToRem: true,\n  },\n};\n\n\n\nCSS conversion properties#\n\nBy default, rootFontSize is 50. So the CSS styles value are converted according\nto the ratio of 1rem : 50px.\n\n/* input */\nh1 {\n  margin: 0 0 16px;\n  font-size: 32px;\n  line-height: 1.2;\n  letter-spacing: 1px;\n}\n\n/* output */\nh1 {\n  margin: 0 0 0.32rem;\n  font-size: 0.64rem;\n  line-height: 1.2;\n  letter-spacing: 0.02rem;\n}\n\n\nBy default, builder converts all CSS properties from px to rem. If you want to\nconvert only the font-size property, you can setting pxtorem.propList is\n['font-size'].\n\nexport default {\n  output: {\n    convertToRem: {\n      pxtorem: {\n        propList: ['font-size'],\n      },\n    },\n  },\n};\n\n\n\nSetting the page rootFontSize#\n\nThe formula for calculating the font size of the page root element is:\n\npageRootFontSize = clientWidth * rootFontSize / screenWidth\n\n\nIn a mobile browser with a screen width of 390, the default value for\nrootFontSize is 50 and the screenWidth of the UI design is 375.\n\nThe calculated font size for the root element of the page is 52 (390 * 50 /\n375).\n\nAt this point, 1 rem is 52px, 32px0.64 rem in the CSS style, the actual size\nin page is 33.28 px.\n\nexport default {\n  output: {\n    convertToRem: {\n      rootFontSize: 50,\n      screenWidth: 375,\n    },\n  },\n};\n\n\n\nCustomize maxRootFontSize#\n\nIn the desktop browser, the page rootFontSize obtained from the calculation\nformula is often too large. When the calculated result large than the\nmaxRootFontSize, the maxRootFontSize will used as the page rootFontSize.\n\nIn the desktop browser with a screen width of 1920, the calculated rootFontSize\nis 349, which exceeds the default maxRootFontSize of 64. 64 is used as the\ncurrent root element font value.\n\nexport default {\n  output: {\n    convertToRem: {\n      maxRootFontSize: 64,\n    },\n  },\n};\n\n\n\nHow to determine if REM is in effect#\n\n 1. CSSCheck the generated .css file to see if the value of the corresponding\n    property is converted from px to rem.\n 2. HTMLOpen the Page Console to see if a valid value exists for\n    document.documentElement.style.fontSize.\n\n\nHow to get the rootFontSize value that is actually in effect on the page?#\n\nThe actual rootFontSize in effect for the page is calculated dynamically based\non the current page. It can be seen by printing\ndocument.documentElement.style.fontSize or obtained by window.ROOT_FONT_SIZE.","frontmatter":{}},{"id":117,"title":"Using Rspack","routePath":"/builder/en/guide/advanced/rspack-start","lang":"en","toc":[{"text":"Enable Rspack","id":"enable-rspack","depth":2},{"text":"Enable in Modern.js framework","id":"enable-in-modern.js-framework","depth":3},{"text":"Use Builder in a front-end framework","id":"use-builder-in-a-front-end-framework","depth":3},{"text":"Migrating from webpack to Rspack","id":"migrating-from-webpack-to-rspack","depth":2},{"text":"Builder configuration differences","id":"builder-configuration-differences","depth":3},{"text":"Source Config","id":"source-config","depth":4},{"text":"Html Config","id":"html-config","depth":4},{"text":"Security Config","id":"security-config","depth":4},{"text":"Dev Config","id":"dev-config","depth":4},{"text":"Output Config","id":"output-config","depth":4},{"text":"Experiments Config","id":"experiments-config","depth":4},{"text":"Performance Config","id":"performance-config","depth":4},{"text":"Tools Config","id":"tools-config","depth":4},{"text":"Modify the Rspack Configuration Object","id":"modify-the-rspack-configuration-object","depth":3},{"text":"A more flexible way to modify Rspack configuration","id":"a-more-flexible-way-to-modify-rspack-configuration","depth":3}],"domain":"","content":"#\n\nThis document will show you how to enable Rspack build mode in the Builder.\n\nWhat is Rspack\n\nRspack is a high performance Rust-based JavaScript bundler that offers strong\ninteroperability with the webpack ecosystem, enabling faster development cycles\nand efficient collaboration between the two tools.\n\nRspack's build performance is significantly better than Webpack, not only due to\nthe language benefits of Rust, but also due to its parallel architecture and\nincremental compilation features. Benchmarking has shown that Rspack can deliver\na 5-10x improvement in compilation performance.\n\n\nEnable Rspack#\n\n\nEnable in Modern.js framework#\n\nWe recommend enabling Rspack as the bundler for Modern.js framework through the\nModern.js generator if you prefer it over the default webpack bundler.\n\nOf course, you can also access it manually by following the steps below:\n\n 1. Install @modern-js/builder-rspack-providerThe version needs to be the same\n    as the Modern.js version).\n\npnpm add @modern-js/builder-rspack-provider -D\n\n\nConfirm the Modern.js version via package.json or lock file:\n\npackage.json\n\n{\n  \"devDependencies\": {\n    \"@modern-js/app-tools\": \"2.8.0\"\n  }\n}\n\n\n 2. Declare the use of Rspack in the Modern.js configuration file:\n\nmodern.config.ts\n\n\n\n+ export default defineConfig<'rspack'>({\n  plugins: [\n    appTools({\n+     bundler: 'experimental-rspack',\n    }),\n  ],\n});\n\n\n\nUse Builder in a front-end framework#\n\nIntegrating rspack-provider into a frontend framework is similar to integrating\nwebpack-provider. You only need to change the dependency from\n@modern-js/builder-webpack-provider to @modern-js/builder-rspack-provider.\n\nmodern.config.ts\n\n\n\n\nconst provider = builderRspackProvider({\n  builderConfig: {\n    // some configs\n  },\n});\n\n\n\nMigrating from webpack to Rspack#\n\nBuilder aims to eliminate the main differences between different bundlers and\nhelp users migrate at a lower cost. However, due to the different capabilities\nof each bundler, you still need to be aware of some differences.\n\nThis article will introduce the differences between webpack and Rspack from the\nperspective of Builder. If you need to know more in-depth differences, please\nrefer to the Rspack documentation.\n\n\nBuilder configuration differences#\n\nCurrently, most of configuration options in Builder have been adapted for\nRspack. Throughout this process, Builder's work includes but is not limited to:\n\n * Replace features that rely on webpack loader/plugin (which are not supported\n   in Rspack) with alternative solutions provided by Rspack. For example, use\n   css/module instead of css-loader modules.\n * Validating and encapsulating webpack plugins such as @svgr/webpack and\n   webpack-bundle-analyzer;\n * Encapsulating Rspack built-in features such as css and minify.\n\nSource Config#\n\n> Source code parsing and compilation related configurations in Builder.\n\nUnsupported configurations and capabilities include:\n\n * source.moduleScopes\n\nHtml Config#\n\n> HTML related configurations in Builder.\n\nAll configurations and capabilities under html are available within rspack.\n\nSecurity Config#\n\n> Security related configurations in Builder.\n\nAll configurations and capabilities under security are not supported for use\nwithin rspack.\n\nDev Config#\n\n> Dev related configurations in Builder.\n\nAll configurations and capabilities under dev are available within rspack.\n\nOutput Config#\n\n> Output related configurations in Builder.\n\nUnsupported configurations and capabilities include:\n\n * output.disableCssExtract\n * output.enableAssetManifest\n * output.enableCssModuleTSDeclaration\n * output.legalComments\n * output.enableInlineScripts\n * tsChecker ability\n   * output.disableTsChecker\n\nExperiments Config#\n\n> Experimental related configurations in the Builder\n\nAll configurations and capabilities under experiments are not supported for use\nwithin rspack.\n\nPerformance Config#\n\n> Performance related configurations in Builder.\n\nUnsupported configurations and capabilities include:\n\n * performance.profile\n * performance.removeMomentLocale\n * performance.buildCache\n\nTools Config#\n\n> Low-level tools configurations in Builder.\n\nUnsupported configurations and capabilities include:\n\n * tools.terser\n * tools.cssExtract\n * tools.cssLoader\n * tools.inspector\n * tools.minifyCss\n * tools.pug\n * tools.styleLoader\n * tools.styledComponents\n * tools.tsLoader\n * tools.tsChecker\n * tools.webpack\n * tools.webpackChain\n\nTIP\nIn addition to the above configurations, some of the supported configurations\nmay have differences in their capabilities. For specific differences in\nconfigurations, please refer to the corresponding API for each configuration.\n\n\nModify the Rspack Configuration Object#\n\nBefore modify the Rspack configuration object, you may should know the config\ndiff between Rspack and Webapck.\n\nYou can use tools.rspack to modify the Rspack configuration object.\n\nexport default {\n  tools: {\n    rspack: (config, { env }) => {\n      if (env === 'development') {\n        config.devtool = 'cheap-module-eval-source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\nMore information about Rspack, please refer to the Rspack website.\n\n\nA more flexible way to modify Rspack configuration#\n\nBuilder supports modifying Rspack config via bundler-chain. Configurations\nmodified via bundler chain will take effect on both webpack and Rspack builds.","frontmatter":{}},{"id":118,"title":"Build Target","routePath":"/builder/en/guide/basic/build-target","lang":"en","toc":[{"text":"Default Target","id":"default-target","depth":2},{"text":"Optional Targets","id":"optional-targets","depth":2},{"text":"Multiple Targets","id":"multiple-targets","depth":2},{"text":"Node Target","id":"node-target","depth":2},{"text":"Web Worker Target","id":"web-worker-target","depth":2},{"text":"Modern Web Target","id":"modern-web-target","depth":2}],"domain":"","content":"#\n\nBuilder supports build multiple target types for running in different target\nenvironments. After setting the correct target type, Builder will optimize the\nbuild results for the environment, and enable some plugins or configs for the\ntarget environment during the build process.\n\nYou can set the type through the target parameter of the createBuilder method.\n\n\nDefault Target#\n\nBy default, the build target is 'web', and the build result can run in a browser\nenvironment.\n\nthe Builder will read the Browserslist config in the project to determine the\nrange of browsers.\n\n\nOptional Targets#\n\ntarget can also be set to the following values:\n\n * 'node': Build for Node.js environment, usually used in SSR and other\n   scenarios.\n * 'web-worker': Build for Web Worker environment.\n * 'modern-web': Build for modern browsers.\n\nFor example, to build for the Node.js environment:\n\nconst builder = await createBuilder(provider, {\n  target: 'node',\n});\n\n\n\nMultiple Targets#\n\nWhen target is an array containing multiple values, Builder will perform\nmultiple builds at the same time.\n\nFor example, we can build a browser target and an node target at the same time:\n\nconst builder = await createBuilder(provider, {\n  target: ['web', 'node'],\n});\n\n\n\nNode Target#\n\nRefers to the build target running in the Node.js environment, usually used in\nscenarios such as SSR.\n\nWhen target is set to 'node', Builder will:\n\n * No HTML files will be generated, and HTML-related logic will not be executed,\n   since HTML is not required by the Node.js environment.\n * CSS code will not be bundled or extracted, but the id information of CSS\n   Modules will be included in the bundle.\n * The default code split strategy will be disabled, but dynamic import can\n   still work.\n * Disable the HMR.\n * Adjust the default value of Browserslist to ['node >= 14']\n\nTIP\nIf target is an array, such as building web and node targets at the same time,\nthen the above processing will not affect the web target, The HTML, CSS and\nother files required for the web target will still be generated correctly.\n\n\nWeb Worker Target#\n\nRefers to the build target running in the Web Worker environment.\n\nWeb Worker\nA web worker is a type of JavaScript program that runs in the background,\nindependently of other scripts, without affecting the performance of the page.\nThis makes it possible to run long-running scripts, such as ones that handle\ncomplex calculations or access remote resources, without blocking the user\ninterface or other scripts. Web workers provide an easy way to run tasks in the\nbackground and improve the overall performance of web applications.\n\nWhen target is set to 'web-worker', Builder will:\n\n * No HTML files will be generated, and HTML-related logic will not be executed,\n   since HTML is not required by the Web Worker environment.\n * CSS code will not be bundled or extracted, but the id information of CSS\n   Modules will be included in the bundle.\n * The default code split strategy will be disabled, and dynamic import can not\n   work, because the Web Worker only runs a single JavaScript file.\n * Disable the HMR.\n\n\nModern Web Target#\n\nRefers to the build target running in the modern browsers.\n\nWhat are modern browsers?\nModern browsers are one of our conventions to refer to browsers that support\nnative ES Modules.\n\nWhen target is set to 'modern-web', Builder will:\n\n * Adjust the default value of Browserslist to\n\nconst browserslist = [\n  'chrome >= 61',\n  'edge >= 16',\n  'firefox >= 60',\n  'safari >= 11',\n  'ios_saf >= 11',\n];\n","frontmatter":{}},{"id":119,"title":"Builder Config","routePath":"/builder/en/guide/basic/builder-config","lang":"en","toc":[{"text":"Config Categories","id":"config-categories","depth":2},{"text":"Default Values","id":"default-values","depth":2},{"text":"Use Config","id":"use-config","depth":2},{"text":"In the Upper Framework","id":"in-the-upper-framework","depth":3},{"text":"Using the Node API","id":"using-the-node-api","depth":3},{"text":"Relationship with Framework Config","id":"relationship-with-framework-config","depth":2},{"text":"Debug the config","id":"debug-the-config","depth":2}],"domain":"","content":"#\n\nBuilder provides a wealth of configs to help users customize the build behavior.\n\n\nConfig Categories#\n\nBuilder Configs are divided into the following categories:\n\n * Dev Config: Config related to local development.\n * Html Config: Config related to HTML.\n * Tools Config: Config related to the low-level tools.\n * Source Config: Config related to source code parsing and compilation.\n * Output Config: Config related to output.\n * Security Config: Config related to security.\n * Performance Config: Config related to performance.\n\nYou can find detailed descriptions of all configs on the API Reference page.\n\n\nDefault Values#\n\nThe Builder presets a default value for each config, and the default value is\nsuitable for most scenarios. At the same time, the upper-level framework will\nalso override some of the default values based on the requirements of the\nvertical scene.\n\nIn most cases, you don't need to define any Builder config, just use it right\nout of the box.\n\n\nUse Config#\n\n\nIn the Upper Framework#\n\nWhen you use a Builder-based upper-level framework, you can define the Builder\nconfig directly through the framework's config file, and the upper-level\nframework will pass the config to the Builder.\n\nFor example, in the Modern.js framework, you can define the Builder's\nsource.alias config in modern.config.ts file.\n\nmodern.config.ts\n\nexport default {\n  source: {\n    alias: {\n      '@common': './src/common',\n    },\n  },\n};\n\n\nCommonly used framework config files include:\n\nFRAMEWORK   CONFIG FILE\nModern.js   modern.config.ts\nEdenX       edenx.config.ts\nPIA         pia.config.ts\n\n\nUsing the Node API#\n\nWhen you call the Builder through the Node API, you can pass in the Builder\nconfig through the Provider's builderConfig option:\n\n\n\nconst provider = builderWebpackProvider({\n  builderConfig: {\n    // some configs\n  },\n});\n\n\nPlease refer to API - createBuilder for details.\n\n\nRelationship with Framework Config#\n\nGenerally speaking, the Builder config is a subset of the framework config.\n\nBuilder config only deals with build-related behaviors, while framework config\ncovers a wider range, including runtime, server, deployment, etc., so framework\nconfig is extended from Builder config.\n\n\nDebug the config#\n\nYou can enable Builder's debug mode by adding the DEBUG=builder environment\nvariable when executing a build.\n\nDEBUG=builder pnpm dev\n\n\nIn debug mode, Builder will write the Builder config to the dist directory,\nwhich is convenient for developers to view and debug.\n\nInspect config succeed, open the following files to view the content:\n\n   - Builder Config: /Project/demo/dist/builder.config.js\n   - Webpack Config (web): /Project/demo/dist/webpack.config.web.js\n\n\nOpen the generated /dist/builder.config.js file to see the complete content of\nthe Builder config.\n\nFor a complete introduction to debug mode, see the Debug Mode chapter.","frontmatter":{}},{"id":120,"title":"Use CSS Modules","routePath":"/builder/en/guide/basic/css-modules","lang":"en","toc":[{"text":"Example","id":"example","depth":2},{"text":"Enable CSS Modules for all CSS files","id":"enable-css-modules-for-all-css-files","depth":2},{"text":"Custom Class Names","id":"custom-class-names","depth":2},{"text":"Add Type Declaration","id":"add-type-declaration","depth":2},{"text":"Generate exact type definitions","id":"generate-exact-type-definitions","depth":2},{"text":"Example","id":"example-1","depth":3},{"text":"Related configuration","id":"related-configuration","depth":3}],"domain":"","content":"#\n\nCSS Modules allows us to write CSS code in a modular way, and these styles can\nbe imported and used in JavaScript files. Using CSS Modules can automatically\ngenerate unique class names, isolate styles between different modules, and avoid\nclass name conflicts.\n\nBuilder supports CSS Modules by default, you don't need to add additional\nconfiguration. Our convention is to use the [name].module.css filename to enable\nCSS Modules.\n\nThe following style files are considered CSS Modules:\n\n * *.module.scss\n * *.module.less\n * *.module.css\n\n\nExample#\n\n * Write style:\n\n/* button.module.css */\n.error {\n  background: red;\n}\n\n\n * Using styles:\n\n// Button.tsx\n\n// import style file\n\n\nexport default () => {\n  return Error Button;\n};\n\n\n\nEnable CSS Modules for all CSS files#\n\nBy default, only files ending in *.module.css are treated CSS Modules.\n\nIf you want to treat all CSS files in the source directory as CSS Modules, you\ncan enable the output.disableCssModuleExtension config, for example:\n\nexport default {\n  output: {\n    disableCssModuleExtension: true,\n  },\n};\n\n\nWhen set, the following two files are treated as CSS Modules:\n\n\n\n\n\nTIP\nWe do not recommend enabling this config, because after enabling\ndisableCssModuleExtension, CSS Modules files and ordinary CSS files cannot be\nclearly distinguished, which is not conducive to long-term maintenance.\n\n\nCustom Class Names#\n\nCustomizing the class names generated by CSS Modules is also a commonly used\nfunction, you can use output.cssModuleLocalIdentName to configure it.\n\nexport default {\n  output: {\n    cssModuleLocalIdentName: '[hash:base64:4]',\n  },\n};\n\n\nIf you need to customize other configs of CSS Modules, you can set them via\ntools.cssLoader.\n\n\nAdd Type Declaration#\n\nWhen you import CSS Modules in TypeScript code, TypeScript may prompt that the\nmodule is missing a type definition:\n\nTS2307: Cannot find module './index.module.css' or its corresponding type declarations.\n\n\nTo fix this, you need to add a type declaration file for the CSS Modules, please\ncreate a src/global.d.ts file, and add the corresponding type declaration:\n\nsrc/global.d.ts\n\ndeclare module '*.module.css' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.scss' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.sass' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.less' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.styl' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\n\nIf you enabled the disableCssModuleExtension config, you also need to add the\nfollowing types:\n\nsrc/global.d.ts\n\ndeclare module '*.css' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.scss' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.sass' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.less' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.styl' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\n\nAfter adding the type declaration, if the type error still exists, you can try\nto restart the current IDE, or adjust the directory where global.d.ts is\nlocated, making sure the TypeScript can correctly identify the type definition.\n\n\nGenerate exact type definitions#\n\nAlthough the above method can provide the type of CSS Modules, it cannot\naccurately prompt which classNames are exported by a certain CSS file.\n\nBuilder supports generating accurate type declarations for CSS Modules, you only\nneed to enable the output.enableCssModuleTSDeclaration config, and then execute\nthe build, Builder will generate type declaration files for all CSS Modules.\n\nexport default {\n  output: {\n    enableCssModuleTSDeclaration: true,\n  },\n};\n\n\n\nExample#\n\nFor example, there are two files src/index.ts and src/index.module.scss under a\ncertain folder:\n\nsrc/index.ts\n\n\n\nexport default () => {\n  \n\n    \nPage Header\n  ;\n};\n\n\nsrc/index.module.scss\n\n.page-header {\n  color: black;\n}\n\n\nAfter executing the build, the src/index.module.scss.d.ts type declaration file\nwill be automatically generated:\n\nsrc/index.module.scss.d.ts\n\n// This file is automatically generated.\n// Please do not change this file!\ninterface CssExports {\n  'page-header': string;\n  pageHeader: string;\n}\nexport const cssExports: CssExports;\nexport default cssExports;\n\n\nThen open the src/index.ts file again, you will see that the styles object\nalready has a exact type.\n\n\nRelated configuration#\n\nIn the above example, src/index.module.scss.d.ts is generated by compilation,\nyou can choose to commit them to the Git repository, or you can choose to ignore\nthem in the .gitignore file:\n\n# Ignore auto generated CSS declarations\n*.module.css.d.ts\n*.module.sass.d.ts\n*.module.scss.d.ts\n*.module.less.d.ts\n*.module.styl.d.ts\n\n\nIn addition, if the generated code causes ESLint to report errors, you can also\nadd the above configuration to the .eslintignore file.","frontmatter":{}},{"id":121,"title":"CSS Usage","routePath":"/builder/en/guide/basic/css-usage","lang":"en","toc":[{"text":"Using Less, Sass and Stylus","id":"using-less,-sass-and-stylus","depth":2},{"text":"Using PostCSS","id":"using-postcss","depth":2},{"text":"Builtin PostCSS plugins","id":"builtin-postcss-plugins","depth":3},{"text":"Using CSS Modules","id":"using-css-modules","depth":2},{"text":"CSS Minify","id":"css-minify","depth":2},{"text":"Inline CSS Files","id":"inline-css-files","depth":2},{"text":"Import CSS in node_modules","id":"import-css-in-node_modules","depth":2}],"domain":"","content":"#\n\nBuilder has built-in multiple style resource processing capabilities, including\nLess / Sass preprocessor, PostCSS, CSS Modules, CSS inline and CSS compression.\n\nIn addition, Builder also provides multiple configs to customize the compile\nrules of style resources.\n\n\nUsing Less, Sass and Stylus#\n\nThe Builder has built-in community popular CSS preprocessors such as Less, Sass.\n\nBy default, you don't need to configure anything for Less and Sass. If you need\nto customize loader config, you can configure tools.less, tools.sass to set it\nup.\n\nYou can also use Stylus in Builder, just install the Stylus plugin provided by\nBuilder, please refer to Stylus Plugin for usage.\n\n\nUsing PostCSS#\n\nBuilder has built-in PostCSS to transform the CSS code. You can configure the\npostcss-loader via tools.postcss.\n\nexport default {\n  tools: {\n    postcss: opts => {\n      const viewportPlugin = require('postcss-px-to-viewport')({\n        viewportWidth: 375,\n      });\n      opts.postcssOptions.plugins.push(viewportPlugin);\n    },\n  },\n};\n\n\n\nBuiltin PostCSS plugins#\n\nBuilder has some builtin PostCSS plugins, which will perform the following\ntransformations on CSS:\n\n * autoprefixer: we have enabled autoprefixer to add vendor prefixes to CSS\n   rules. If you want to configure the target browser, you can use\n   output.overrideBrowserslist config.\n * postcss-nesting: Provide CSS Nesting support, you can Use nested writing in\n   CSS, such as:\n\n.my-table {\n  & td {\n    text-align: center;\n\n    &.c {\n      text-transform: uppercase;\n    }\n  }\n}\n\n\n * postcss-flexbugs-fixes: Used to fix known Flex Bugs.\n * postcss-initial: Enabled only when it needs to be compatible with legacy\n   browsers, providing the initial attribute value compatible.\n * postcss-page-break: Enabled only when compatibility with legacy browsers is\n   required, providing support for break- attribute.\n * postcss-font-variant: Enabled only when compatibility with legacy browsers is\n   required, providing support for font-variant.\n * postcss-media-minmax: Enabled only when compatibility with legacy browsers is\n   required, providing support for Media Query Ranges compatibility.\n * postcss-custom-properties: Only enabled when compatibility with legacy\n   browsers is required, providing support for Custom Properties, you can define\n   and use custom variables in CSS, such as:\n\n:root {\n  --main-bg-color: pink;\n}\n\nbody {\n  background-color: var(--main-bg-color);\n}\n\n\n\nUsing CSS Modules#\n\nPlease read the Using CSS Modules chapter for a complete usage of CSS Modules.\n\n\nCSS Minify#\n\nUsually, in production environments we compress static resources such as CSS,\nJS, etc. to achieve better transfer efficiency.\n\nBuilder automatically compresses CSS code at production build time with\ncss-minimizer-webpack-plugin (The compression tool used at the bottom is\ncssnano).\n\nYou can configure tools.minifyCss to make it more customizable.\n\nAbout cssnano\ncssnano is a tool for optimizing and minifying CSS files. It reduces the size of\nCSS files by removing unused rules, merging similar rules, removing comments and\nwhitespace, and converting length units, among other techniques, to improve the\nloading speed of websites.\n\n\nInline CSS Files#\n\nBy default, Builder will extract CSS into a separate .css file and output it to\nthe dist directory.\n\nIf you want to inline styles into your JS file, you can set\noutput.disableCssExtract to true to disable CSS extraction logic.When the JS\nfile is requested by the browser, JS dynamically inserts the","frontmatter":{}},{"id":122,"title":"HTML Template","routePath":"/builder/en/guide/basic/html-template","lang":"en","toc":[{"text":"Set Template","id":"set-template","depth":2},{"text":"Set Page Title","id":"set-page-title","depth":2},{"text":"Set Page Icon","id":"set-page-icon","depth":2},{"text":"Set Meta Tags","id":"set-meta-tags","depth":2},{"text":"Set Template Parameters","id":"set-template-parameters","depth":2},{"text":"Template Engine","id":"template-engine","depth":2},{"text":"","id":"","depth":3},{"text":"","id":"-1","depth":3},{"text":"","id":"-2","depth":3},{"text":"Injecting Tags","id":"injecting-tags","depth":2},{"text":"Tag Object","id":"tag-object","depth":3},{"text":"Tags Handler","id":"tags-handler","depth":3}],"domain":"","content":"#\n\nDuring the build process, Builder will compile based on the HTML template and\ntemplate parameters to generate several HTML files.\n\nBuilder provides some configs to set the HTML template. Through this chapter,\nyou can learn the basic usage of these configs.\n\n\nSet Template#\n\nHTML templates are usually predefined by the upper framework.\n\nFor example, in the Modern.js framework, the HTML template is preset by default,\nand users can also customize the content of the template. You can read the\n\"Modern.js - HTML Template\" chapter to learn about it.\n\nIn Builder, you can use html.template and html.templateByEntries configs to\ndefine the path to the custom HTML template.\n\nexport default {\n  html: {\n    template: './static/index.html',\n  },\n};\n\n\n\nSet Page Title#\n\nYou can set the HTML </code> tag through the <a\nhref=\"/en/api/config-html\">html.title</a> and <a\nhref=\"/en/api/config-html\">html.titleByEntries</a> configs.</p> <p>When there is\nonly one page in your project, just use the <code>html.title</code> setting\ndirectly:</p> <div className=\"\"><div className=\"\"><button\nclassName=\"\"></button><pre className=\"\"><code className=\"\">export default {\nhtml: { title: 'example', }, }; </code></pre></div></div> <p>When there are\nmultiple pages in your project, please use <code>html.titleByEntries</code> to\nset corresponding titles for different pages. <code>html.titleByEntries</code>\nuses the page's \"entry name\" as the key.</p> <div className=\"\"><div\nclassName=\"\"><button className=\"\"></button><pre className=\"\"><code\nclassName=\"\">export default { html: { titleByEntries: { foo: 'Foo', bar: 'Bar',\n}, }, }; </code></pre></div></div> <h2 id=\"set-page-icon\">Set Page Icon<a\nclassName=\"\" aria-hidden=\"true\" href=\"#set-page-icon\">#</a></h2> <p>Builder\nsupports setting <a\nhref=\"https://developer.mozilla.org/en-US/docs/Glossary/Favicon\" target=\"_blank\"\nrel=\"noopener noreferrer\">favicon</a> icon and <a\nhref=\"https://webhint.io/docs/user-guide/hints/hint-apple-touch-icons/\"\ntarget=\"_blank\" rel=\"noopener noreferrer\">apple-touch-icon</a> icon.</p> <p>You\ncan set the favicon through the <a href=\"/en/api/config-html\">html.favicon</a>\nand <a href=\"/en/api/config-html\">html.faviconByEntries</a> configs.</p> <div\nclassName=\"\"><div className=\"\"><button className=\"\"></button><pre\nclassName=\"\"><code className=\"\">export default { html: { favicon:\n'./src/assets/icon.png', }, }; </code></pre></div></div> <p>You can also set the\napple-touch-icon for iOS system through the <a\nhref=\"/en/api/config-html\">html.appIcon</a> config.</p> <div className=\"\"><div\nclassName=\"\"><button className=\"\"></button><pre className=\"\"><code\nclassName=\"\">export default { html: { appIcon: './src/assets/icon.png', }, };\n</code></pre></div></div> <h2 id=\"set-meta-tags\">Set Meta Tags<a className=\"\"\naria-hidden=\"true\" href=\"#set-meta-tags\">#</a></h2> <p>You can set the meta tags\nthrough the <a href=\"/en/api/config-html\">html.meta</a> and <a\nhref=\"/en/api/config-html\">html.metaByEntries</a> configs.</p> <p>For example to\nsetting description:</p> <div className=\"\"><div className=\"\"><button\nclassName=\"\"></button><pre className=\"\"><code className=\"\">export default {\nhtml: { meta: { description: 'a description of the page', }, }, };\n</code></pre></div></div> <p>The generated meta tag in HTML is:</p> <div\nclassName=\"\"><div className=\"\"><button className=\"\"></button><pre\nclassName=\"\"><code className=\"\"><meta name=\"description\" content=\"a description\nof the page\" /> </code></pre></div></div> <h2 id=\"set-template-parameters\">Set\nTemplate Parameters<a className=\"\" aria-hidden=\"true\"\nhref=\"#set-template-parameters\">#</a></h2> <p>In HTML templates, you can use a\nvariety of template parameters. The template parameters injected by Builder by\ndefault include:</p> <div className=\"\"><div className=\"\"><button\nclassName=\"\"></button><pre className=\"\"><code className=\"\">type\nDefaultParameters = { meta: string; // corresponding to html.meta config title:\nstring; // corresponding to html.title config mountId: string; // corresponding\nto html.mountId config entryName: string; // entry name assetPrefix: string; //\ncorresponding to output.assetPrefix config compilation: webpack.Compilation; //\nCompilation object corresponding to webpack webpackConfig: config; // webpack\nconfig // htmlWebpackPlugin built-in parameters // See\nhttps://github.com/jantimon/html-webpack-plugin for details htmlWebpackPlugin: {\ntags: object; files: object; options: object; }; }; </code></pre></div></div>\n<p>You can also use the <a\nhref=\"/en/api/config-html\">html.templateParameters</a> and <a\nhref=\"/en/api/config-html\">html.templateParametersByEntries</a> configs to pass\nin custom template parameters.</p> <p>For example:</p> <div className=\"\"><div\nclassName=\"\"><button className=\"\"></button><pre className=\"\"><code\nclassName=\"\">export default { html: { templateParameters: { text: 'World', }, },\n}; </code></pre></div></div> <p>Then you can read parameters in the HTML\ntemplate with <code><%= text %></code>:</p> <div className=\"\"><div\nclassName=\"\"><button className=\"\"></button><pre className=\"\"><code\nclassName=\"\"><div>hello <%= text %>!</div> </code></pre></div></div> <p>The\ngenerated HTML code is as follows:</p> <div className=\"\"><div\nclassName=\"\"><button className=\"\"></button><pre className=\"\"><code\nclassName=\"\"><div>hello world!</div> </code></pre></div></div> <h2\nid=\"template-engine\">Template Engine<a className=\"\" aria-hidden=\"true\"\nhref=\"#template-engine\">#</a></h2> <p>Builder supports using <a\nhref=\"https://www.lodashjs.com/docs/lodash.template\" target=\"_blank\"\nrel=\"noopener noreferrer\">Lodash Template</a>, <a href=\"https://ejs.co/\"\ntarget=\"_blank\" rel=\"noopener noreferrer\">EJS</a>, <a href=\"https://pugjs.org/\"\ntarget=\"_blank\" rel=\"noopener noreferrer\">Pug</a> as template engines, the most\nbasic Lodash Template is used as the default template engine.</p> <h3 id=\"\"><a\nhref=\"https://www.lodashjs.com/docs/lodash.template\" target=\"_blank\"\nrel=\"noopener noreferrer\">Lodash Template</a><a className=\"\" aria-hidden=\"true\"\nhref=\"#\">#</a></h3> <p>When the suffix of the template is <code>.html</code>,\nBuilder will use Lodash Template to compile it.</p> <p>For example, if you\ndefine a <code>text</code> parameter in a template with a value of\n<code>'world'</code>, Builder will automatically replace <code><%= text\n%></code> with the value.</p> <div className=\"\"><div className=\"\"><button\nclassName=\"\"></button><pre className=\"\"><code className=\"\"><!-- input -->\n<div>hello <%= text %>!</div> <!-- output --> <div>hello world!</div>\n</code></pre></div></div> <p>Please read the <a\nhref=\"https://www.lodashjs.com/docs/lodash.template\" target=\"_blank\"\nrel=\"noopener noreferrer\">Lodash Template</a> documentation for details.</p> <h3\nid=\"-1\"><a href=\"https://ejs.co/\" target=\"_blank\" rel=\"noopener\nnoreferrer\">EJS</a><a className=\"\" aria-hidden=\"true\" href=\"#-1\">#</a></h3>\n<p>When the suffix of the template is <code>.ejs</code>, Builder will use the\nEJS template engine to compile it. EJS is a simple templating language that lets\nyou generate HTML markup with plain JavaScript.</p> <p>For example, you can\nfirst refer to a <code>.ejs</code> template through the <a\nhref=\"/en/api/config-html\">html.template</a> config:</p> <div className=\"\"><div\nclassName=\"\"><button className=\"\"></button><pre className=\"\"><code\nclassName=\"\">export default { html: { template: './static/index.ejs', }, };\n</code></pre></div></div> <p>Then define a <code>user</code> parameter in the\ntemplate with a value of <code>{ name: 'Jack' }</code>. Builder will\nautomatically replace <code><%= user.name %></code> with the value.</p> <div\nclassName=\"\"><div className=\"\"><button className=\"\"></button><pre\nclassName=\"\"><code className=\"\"><!-- input --> <% if (user) { %> <h2><%=\nuser.name %></h2> <% } %> <!-- output --> <h2>Jack</h2>\n</code></pre></div></div> <p>Please read the <a href=\"https://ejs.co/\"\ntarget=\"_blank\" rel=\"noopener noreferrer\">EJS</a> documentation for details.</p>\n<h3 id=\"-2\"><a href=\"https://pugjs.org/\" target=\"_blank\" rel=\"noopener\nnoreferrer\">Pug</a><a className=\"\" aria-hidden=\"true\" href=\"#-2\">#</a></h3>\n<p>When the suffix of the template is <code>.pug</code>, Builder will use the\nPug template engine to compile it. Pug is a robust, elegant, feature rich\ntemplate engine for Node.js.</p> <p>Before using the Pug template, you need to\nenable the <a href=\"/en/api/config-tools\">tools.pug</a> config, and define the\n<a href=\"/en/api/config-html\">html.template</a> config to reference a\n<code>.pug</code> template:</p> <div className=\"\"><div className=\"\"><button\nclassName=\"\"></button><pre className=\"\"><code className=\"\">export default {\nhtml: { template: './static/index.pug', }, tools: { pug: true, }, };\n</code></pre></div></div> <p>Then you can use Pug syntax in <code>.pug</code>\ntemplates:</p> <div className=\"\"><div className=\"\"><button\nclassName=\"\"></button><pre className=\"\"><code className=\"\"><!-- input --> p\nHello #{text}! <!-- output --> <p>Hello World!</p> </code></pre></div></div>\n<p>Please read the <a href=\"https://pugjs.org/\" target=\"_blank\" rel=\"noopener\nnoreferrer\">Pug</a> documentation for details.</p> <h2\nid=\"injecting-tags\">Injecting Tags<a className=\"\" aria-hidden=\"true\"\nhref=\"#injecting-tags\">#</a></h2> <p>The <code>html.tags</code> option can be\nconfigured to insert any tags into the final generated HTML product.</p> <div\nclassName=\"\"><div className=\"\">Usage Cases</div><div className=\"\">The products\nof the web application will eventually be referenced directly or indirectly by\nHTML entries, but most of the time injecting tags directly into HTML is not\npreferred.</div></div> <p>All tags that need to be injected into HTML can be\naccessed in the template file via the variable\n<code>htmlWebpackPlugin.tags</code>.</p> <div className=\"\"><div\nclassName=\"\"><button className=\"\"></button><pre className=\"\"><code\nclassName=\"\"><html> <head> <%= htmlWebpackPlugin.tags.headTags %> </head> <body>\n<%= htmlWebpackPlugin.tags.bodyTags %> </body> </html> </code></pre></div></div>\n<p>The purpose of <code>html.tags</code> is to adjust these template variables\nand thus modify the HTML, as defined in <a href=\"/en/api/config-html\">API\nReferences</a>.</p> <h3 id=\"tag-object\">Tag Object<a className=\"\"\naria-hidden=\"true\" href=\"#tag-object\">#</a></h3> <div className=\"\"><div\nclassName=\"\"><button className=\"\"></button><pre className=\"\"><code\nclassName=\"\">export default { output: { assetPrefix: '//example.com/' }, html: {\ntags: [ { tag: 'script', attrs: { src: 'a.js' } }, { tag: 'script', attrs: {\nsrc: 'b.js' }, append: false }, { tag: 'link', attrs: { href: 'style.css', rel:\n'stylesheet' }, append: true } { tag: 'link', attrs: { href: 'page.css', rel:\n'stylesheet' }, publicPath: false } { tag: 'script', attrs: { src: 'c.js' },\nhead: false }, { tag: 'meta', attrs: { name: 'referrer', content: 'origin' } },\n], }, }; </code></pre></div></div> <p>The final insertion position of the tag is\ndetermined by the <code>head</code> and <code>append</code> options, and two\nelements with the same configuration will be inserted into the same area and\nhold their relative positions to each other.</p> <p>The <code>publicPath</code>\nconfiguration is enabled by default for tags, the value of\n<code>output.assetPrefix</code> will be stitched to the <code>src</code>\nproperty of the <code>script</code> tag that represents the path.</p> <p>So the\nHTML output built with the above configuration will look like this.</p> <div\nclassName=\"\"><div className=\"\"><button className=\"\"></button><pre\nclassName=\"\"><code className=\"\"><html> <head> <script\nsrc=\"//example.com/b.js\"></script> <link href=\"//example.com/style.css\"\nrel=\"stylesheet\" /> <link href=\"page.css\" rel=\"stylesheet\" /> <!-- some other\nheadTags... --> <script src=\"//example.com/a.js\"></script> <meta name=\"referrer\"\ncontent=\"origin\" /> </head> <body> <!-- some other bodyTags... --> <script\nsrc=\"//example.com/c.js\"></script> </body> </html> </code></pre></div></div> <h3\nid=\"tags-handler\">Tags Handler<a className=\"\" aria-hidden=\"true\"\nhref=\"#tags-handler\">#</a></h3> <p><code>html.tags</code> also accepts a\ncallback function, which is often used to modify the list of tags or to ensure\ntheir relative position while inserting them.</p> <div className=\"\"><div\nclassName=\"\"><button className=\"\"></button><pre className=\"\"><code\nclassName=\"\">export default { html: { tags: [ tags => { tags.splice(0, 1); }, {\ntag: 'script', attrs: { src: 'a.js' }, head: false }, { tag: 'script', attrs: {\nsrc: 'b.js' }, append: false }, { tag: 'script', attrs: { src: 'c.js' } }, tags\n=> [...tags, { tag: 'script', attrs: { src: 'd.js' } }], ], }, };\n</code></pre></div></div> <p>And you will get:</p> <div className=\"\"><div\nclassName=\"\"><button className=\"\"></button><pre className=\"\"><code\nclassName=\"\"><html> <head> <!-- some other headTags... --> <script\nsrc=\"//example.com/c.js\"></script> <script src=\"//example.com/d.js\"></script>\n</head> <body> <!-- some other bodyTags... --> <script\nsrc=\"//example.com/a.js\"></script> </body> </html> </code></pre></div></div>","frontmatter":{}},{"id":123,"title":"Import JSON Files","routePath":"/builder/en/guide/basic/json-files","lang":"en","toc":[{"text":"JSON file","id":"json-file","depth":2},{"text":"Example","id":"example","depth":3},{"text":"Named Import","id":"named-import","depth":3},{"text":"YAML file","id":"yaml-file","depth":2},{"text":"Example","id":"example-1","depth":3},{"text":"Add type declaration","id":"add-type-declaration","depth":3},{"text":"Toml file","id":"toml-file","depth":2},{"text":"Example","id":"example-2","depth":3},{"text":"Add type declaration","id":"add-type-declaration-1","depth":3}],"domain":"","content":"#\n\nBuilder supports import JSON files in code, and also supports import YAML and\nToml files and converting them to JSON format.\n\n\nJSON file#\n\nYou can import JSON files directly in JavaScript files.\n\n\nExample#\n\nexample.json\n\n{\n  \"name\": \"foo\",\n  \"items\": [1, 2]\n}\n\n\nindex.js\n\n\n\nconsole.log(example.name); // 'foo';\nconsole.log(example.items); // [1, 2];\n\n\n\nNamed Import#\n\nBuilder does not support importing JSON files via named import yet:\n\n\n\n\n\nYAML file#\n\nYAML is a data serialization language commonly used for writing configuration\nfiles.\n\nYou can directly import .yaml or .yml files in JavaScript and they will be\nautomatically converted to JSON format.\n\n\nExample#\n\nexample.yaml\n\n---\nhello: world\nfoo:\n  bar: baz\n\n\n\n\nconsole.log(example.hello); // 'world';\nconsole.log(example.foo); // { bar: 'baz' };\n\n\n\nAdd type declaration#\n\nWhen you import a YAML file in your TypeScript code, please create a\nsrc/global.d.ts file in your project and add the corresponding type declaration:\n\nsrc/global.d.ts\n\ndeclare module '*.yaml' {\n  const content: Record;\n  export default content;\n}\n\ndeclare module '*.yml' {\n  const content: Record;\n  export default content;\n}\n\n\n\nToml file#\n\nToml is a semantically explicit, easy-to-read configuration file format.\n\nYou can directly import .toml files in JavaScript and it will be automatically\nconverted to JSON format.\n\n\nExample#\n\nexample.toml\n\nhello = \"world\"\n\n[foo]\nbar = \"baz\"\n\n\n\n\nconsole.log(example.hello); // 'world';\nconsole.log(example.foo); // { bar: 'baz' };\n\n\n\nAdd type declaration#\n\nWhen you import Toml files in TypeScript code, please create a src/global.d.ts\nfile in your project and add the corresponding type declarations:\n\nsrc/global.d.ts\n\ndeclare module '*.toml' {\n  const content: Record;\n  export default content;\n}\n","frontmatter":{}},{"id":124,"title":"Output Files","routePath":"/builder/en/guide/basic/output-files","lang":"en","toc":[{"text":"Default Directory Structure","id":"default-directory-structure","depth":2},{"text":"Modify the Directory","id":"modify-the-directory","depth":2},{"text":"Static Assets","id":"static-assets","depth":2},{"text":"Node.js Output Directory","id":"node.js-output-directory","depth":2},{"text":"Flatten the Directory","id":"flatten-the-directory","depth":2},{"text":"Not Written to Disk","id":"not-written-to-disk","depth":2}],"domain":"","content":"#\n\nThis chapter will introduces the directory structure of output files and how to\ncontrol the output directory of different types of files.\n\n\nDefault Directory Structure#\n\nThe following is a basic directory for output files. By default, the compiled\nfiles will be output in the dist directory of current project.\n\ndist\n static\n    css\n       [name].[hash].css\n       [name].[hash].css.map\n   \n    js\n        [name].[hash].js\n        [name].[hash].js.LICENSE.txt\n        [name].[hash].js.map\n\n html\n     [name]\n         index.html\n\n\nThe most common output files are HTML files, JS files, and CSS files:\n\n * HTML files: default output to the html directory.\n * JS files: default output to static/js directory,\n * CSS files: default output to the static/css directory.\n\nIn addition, JS files and CSS files sometimes generate some related files:\n\n * License files: contains open source license, which is output to the same\n   level directory of the JS file, and adds .LICENSE.txt suffix.\n * Source Map files: contains the source code mappings, which is output to the\n   same level directory of JS files and CSS files, and adds a .map suffix.\n\nIn the filename, [name] represents the entry name corresponding to this file,\nsuch as index, main. [hash] is the hash value generated based on the content of\nthe file.\n\n\nModify the Directory#\n\nBuilder provides some configs to modify the directory or filename, you can:\n\n * Modify the filename through output.filename.\n * Modify the output path of through output.distPath.\n * Modify the license file through output.legalComments.\n * Remove Source Map file through output.disableSourceMap.\n * Remove the folder corresponding to the HTML files through\n   html.disableHtmlFolder.\n\n\nStatic Assets#\n\nWhen you import static assets such as images, SVG, fonts, media, etc. in the\ncode, they will also be output to the dist/static directory, and automatically\nassigned to the corresponding subdirectories according to the file type:\n\ndist\n static\n     image\n        foo.[hash].png\n    \n     svg\n        bar.[hash].svg\n    \n     font\n        baz.[hash].woff2\n    \n     media\n         qux.[hash].mp4\n\n\nYou can use the output.distPath config to uniformly input these static assets\ninto a directory, for example, output to the assets directory:\n\nexport default {\n  output: {\n    distPath: {\n      image: 'assets',\n      svg: 'assets',\n      font: 'assets',\n      media: 'assets',\n    },\n  },\n};\n\n\nThe above config produces the following directory structure:\n\ndist\n assets\n     foo.[hash].png\n     bar.[hash].svg\n     baz.[hash].woff2\n     qux.[hash].mp4\n\n\n\nNode.js Output Directory#\n\nWhen the Build Target of Builder contains 'node', or you have enabled\nserver-side features such as SSR in the upper framework, Builder will generate\nsome output files for Node.js and output them to the bundles directory:\n\ndist\n bundles\n    [name].js\n static\n html\n\n\nNode.js files usually only contain JS files, no HTML or CSS. Also, JS file names\nwill not contain hash.\n\nYou can modify the output path of Node.js files through the\noutput.distPath.server config.\n\nFor example, output Node.js files to the server directory:\n\nexport default {\n  output: {\n    distPath: {\n      server: 'server',\n    },\n  },\n};\n\n\n\nFlatten the Directory#\n\nSometimes you don't want the dist directory to have too many levels, you can set\nthe directory to an empty string to flatten the generated directory.\n\nSee the example below:\n\nexport default {\n  output: {\n    distPath: {\n      js: '',\n      css: '',\n      html: '',\n    },\n    disableHtmlFolder: true,\n  },\n};\n\n\nThe above config produces the following directory structure:\n\ndist\n [name].[hash].css\n [name].[hash].css.map\n [name].[hash].js\n [name].[hash].js.map\n [name].html\n\n\n\nNot Written to Disk#\n\nBy default, Builder will write the generated files to disk, so developers can\nview the file content or configure proxy rules for static assets.\n\nIn development, you can choose to keep the generated files in the Dev Server's\nmemory to reduce the overhead of file operations.\n\nJust set the dev.writeToDisk config to false:\n\nexport default {\n  dev: {\n    writeToDisk: false,\n  },\n};\n","frontmatter":{}},{"id":125,"title":"Import Static Assets","routePath":"/builder/en/guide/basic/static-assets","lang":"en","toc":[{"text":"Assets Format","id":"assets-format","depth":2},{"text":"Import Assets in JS file","id":"import-assets-in-js-file","depth":2},{"text":"Import Assets in CSS file","id":"import-assets-in-css-file","depth":2},{"text":"Import Results","id":"import-results","depth":2},{"text":"Output Files","id":"output-files","depth":2},{"text":"URL Prefix","id":"url-prefix","depth":2},{"text":"Add Type Declaration","id":"add-type-declaration","depth":2},{"text":"Image Format","id":"image-format","depth":2}],"domain":"","content":"#\n\nBuilder supports import static assets, including images, fonts, and medias.\n\nWhat is Static Assets\nStatic assets are files that are part of a web application and do not change,\neven when the application is being used. Examples of static assets include\nimages, fonts, medias, stylesheets, and JavaScript files. These assets are\ntypically stored on a web server or CDN, and delivered to the user's web browser\nwhen the Web application is accessed. Because they do not change, static assets\ncan be cached by the browser, which helps to improve the performance of the Web\napplication.\n\n\nAssets Format#\n\nThe following are the formats supported by Builder by default:\n\n * Image: png, jpg, jpeg, gif, svg, bmp, webp, ico, apng, avif, tiff.\n * Fonts: woff, woff2, eot, ttf, otf, ttc.\n * Media: mp4, webm, ogg, mp3, wav, flac, aac, mov.\n\nIf you need to import static resources in other formats, please provide feedback\nthrough GitHub Issues.\n\nSVG images\nSVG image is a special case. Builder support convert SVG to React components, so\nSVG is processed separately. For details, see Import SVG Assets.\n\n\nImport Assets in JS file#\n\nIn JS files, you can directly import static assets in relative paths:\n\n// Import the logo.png image in the static directory\n\n\nexport default = () => ;\n\n\nImport with alias are also supported:\n\n\n\nexport default = () => ;\n\n\n\nImport Assets in CSS file#\n\nIn CSS files, you can reference static assets in relative paths:\n\n.logo {\n  background-image: url('../static/logo.png');\n}\n\n\nImport with alias are also supported:\n\n.logo {\n  background-image: url('@/static/logo.png');\n}\n\n\n\nImport Results#\n\nThe result of importing static assets depends on the file size:\n\n * When the file size is greater than 10KB, a URL will be returned, and the file\n   will be output to the dist directory.\n * When the file size is less than 10KB, it will be automatically inlined to\n   Base64 format.\n\n\n\n\nconsole.log(largeImage); // \"/static/largeImage.6c12aba3.png\"\nconsole.log(smallImage); // \"data:image/png;base64,iVBORw0KGgo...\"\n\n\nFor a more detailed introduction to asset inlining, please refer to the Static\nAsset Inlining chapter.\n\n\nOutput Files#\n\nWhen static assets are imported, they will be output to the dist directory. You\ncan:\n\n * Modify the output filename through output.filename.\n * Modify the output path through output.distPath.\n\nPlease read Output Files for details.\n\n\nURL Prefix#\n\nThe URL returned after importing a asset will automatically include the path\nprefix:\n\n * In development, using dev.assetPrefix to set the path prefix.\n * In production, using output.assetPrefix to set the path prefix.\n\nFor example, you can set output.assetPrefix to https://modern.com:\n\n\n\nconsole.log(logo); // \"https://modern.com/static/logo.6c12aba3.png\"\n\n\n\nAdd Type Declaration#\n\nWhen you import static assets in TypeScript code, TypeScript may prompt that the\nmodule is missing a type definition:\n\nTS2307: Cannot find module './logo.png' or its corresponding type declarations.\n\n\nTo fix this, you need to add a type declaration file for the static assets,\nplease create a src/global.d.ts file, and add the corresponding type\ndeclaration. Taking png images as an example, you need to add the following\ndeclarations:\n\nsrc/global.d.ts\n\ndeclare module '*.png' {\n  const content: string;\n  export default content;\n}\n\n\nAfter adding the type declaration, if the type error still exists, you can try\nto restart the current IDE, or adjust the directory where global.d.ts is\nlocated, making sure the TypeScript can correctly identify the type definition.\n\n\nImage Format#\n\nWhen using image assets, you can choose a appropriate image format according to\nthe pros and cons in the table below.\n\nFORMAT   PROS                                                     CONS                                                         SCENARIOS\nPNG      Lossless compression, no loss of picture details, no     Not suitable for pictures with complex color tables          Suitable for pictures with few colors and well-defined\n         distortion, support for translucency                                                                                  borders, suitable for logos, icons, transparent images and\n                                                                                                                               other scenes\nJPG      Rich colors                                              Lossy compression, which will cause image distortion, does   Suitable for pictures with a large number of colors,\n                                                                  not support transparency                                     gradients, and overly complex pictures, suitable for\n                                                                                                                               portrait photos, landscapes and other scenes\nWebP     Supports both lossy and lossless compression, supports   iOS compatibility is not good                                Pixel images of almost any scene, and the hosting\n         transparency, and is much smaller than PNG and JPG                                                                    environment that supports WebP, should prefer WebP image\n                                                                                                                               format\nSVG      Lossless format, no distortion, supports transparency    Not suitable for complex graphics                            Suitable for vector graphics, suitable for icons","frontmatter":{}},{"id":126,"title":"Import SVG Assets","routePath":"/builder/en/guide/basic/svg-assets","lang":"en","toc":[{"text":"Import SVG in JS file","id":"import-svg-in-js-file","depth":2},{"text":"Modify the Default Export","id":"modify-the-default-export","depth":2},{"text":"Import SVG in CSS file","id":"import-svg-in-css-file","depth":2},{"text":"Assets Processing","id":"assets-processing","depth":2},{"text":"Add type declaration","id":"add-type-declaration","depth":2}],"domain":"","content":"#\n\nBuilder supports import SVG assets and transform SVG into React components or\nURLs.\n\nWhat is SVG\nSVG stands for Scalable Vector Graphics. It is a type of image format that uses\nvector graphics to represent images. Vector graphics are different from raster\ngraphics, which are made up of pixels. Instead, vector graphics use geometric\nshapes, lines, and curves to represent images. Because vector graphics are not\nmade up of pixels, they can be scaled to any size without losing resolution or\nquality.\n\n\nImport SVG in JS file#\n\nWhen import an SVG in a JS file, if you import ReactComponent, Builder will call\nSVGR to convert the SVG into a React component.\n\nsrc/component/Logo.tsx\n\n\n\nexport default () => ;\n\n\nIf you use the default import, then the SVG will be treated as a normal static\nasset and you will get a URL:\n\nsrc/component/Logo.tsx\n\n\n\nconsole.log(logoURL); // => \"/static/logo.6c12aba3.png\"\n\n\n\nModify the Default Export#\n\nYou can modify the default export of SVG files through the\noutput.svgDefaultExport config. For example, set the default export as a React\ncomponent:\n\nexport default {\n  output: {\n    svgDefaultExport: 'component',\n  },\n};\n\n\nThen import the SVG, you'll get a React component instead of a URL:\n\nsrc/component/Logo.tsx\n\n\n\nexport default () => ;\n\n\n\nImport SVG in CSS file#\n\nWhen import an SVG in a CSS file, the SVG is treated as a normal static resource\nand you will get a URL:\n\n.logo {\n  background-image: url('../static/logo.svg');\n}\n\n\n\nAssets Processing#\n\nWhen SVG is imported not as a React component but as a normal static resource,\nit is processed exactly the same as other static assets, and it is also affected\nby rules such as assets inlining and URL prefixing.\n\nPlease read the Import Static Assets section to understand the processing rules\nfor static assets.\n\n\nAdd type declaration#\n\nWhen you reference an SVG asset in TypeScript code, TypeScript may prompt that\nthe module is missing a type definition:\n\nTS2307: Cannot find module './logo.svg' or its corresponding type declarations.\n\n\nTo fix this, you need to add a type declaration file for the SVG asset, please\ncreate a src/global.d.ts file, and add the following type declaration:\n\ndeclare module '*.svg' {\n  export const ReactComponent: React.FunctionComponent<\n    React.SVGProps\n  >;\n\n  const content: string;\n  export default content;\n}\n\n\nIf you set svgDefaultExport to 'component', then change the type declaration to:\n\ndeclare module '*.svg' {\n  export const ReactComponent: React.FunctionComponent<\n    React.SVGProps\n  >;\n\n  export default ReactComponent;\n}\n\n\nAfter adding the type declaration, if the type error still exists, you can try\nto restart the current IDE, or adjust the directory where global.d.ts is\nlocated, making sure the TypeScript can correctly identify the type definition.","frontmatter":{}},{"id":127,"title":"Use TypeScript","routePath":"/builder/en/guide/basic/typescript","lang":"en","toc":[{"text":"TypeScript compilation","id":"typescript-compilation","depth":2},{"text":"Why Babel is the default option","id":"why-babel-is-the-default-option","depth":3},{"text":"Type checking","id":"type-checking","depth":2}],"domain":"","content":"#\n\nBuilder supports TypeScript compilation and type checking by default, you can\nuse . ts and `. tsx' files in the project without any configuration.\n\n\nTypeScript compilation#\n\nBuilder has three ways to compile TypeScript files.\n\nBabel\n\nBy default, all TypeScript files are compiled by Babel.\n\nYou may find some old articles pointing out that Babel cannot handle const enum\nand namespace alias syntax, however since version 7.15 Babel has supported them.\nBabel compile is enabled by default.\n\nIf you want more Babel plugins\n\nts-loader\n\nThe ts-loader uses TypeScript's official compiler-TSC under the hood. When\nts-loader is enabled, TypeScript files will no longer be compiled by Babel, but\nBabel will still inject polyfill into the TSC output and transform it to the\nlower version of JavaScript.\n\nEnable ts-loader(with default options):\n\nexport default {\n  tools: {\n    tsLoader: {},\n  },\n};\n\n\nMore configuration can be found at tools.tsLoader.\n\nIf ts-loader is enabled with default configuration, it does not have type\nchecking, we do type checking by fork-ts-checker-webpack-plugin.\n\nSWC\n\nIf you want a super fast compiler, and you don't need some custom Babel plugins,\nthen you can use SWC for compilation and minification.\n\nSWC plugin in Builder supports TypeScript, TSX and legacy decorator, you can\ncheck SWC plugin.\n\n\nWhy Babel is the default option#\n\nBabel supports TypeScript well. It cannot check types, but we can check types in\nanother process. Babel follows standards more when compiled to lower versions of\nJavaScript in certain situations. For example, Babel will initialize class\nmembers as undefined, and mark class methods as non-enumerable. If TSC is\nenabled, for better syntax downgrading and Polyfill, the TSC output will still\nbe compiled by Babel, causing unnecessary performance costs.\n\n\nType checking#\n\nCurrently, the only stable TypeScript type checking tool is TSC, and it usually\ntakes a while to check types in a large project, so Builder by default using\ntsChecker(fork-ts-checker-webpack-plugin) for asynchronous type checking, it\nwon't block project setup.\n\nSet tsChecker(with default options):\n\nexport default {\n  tools: {\n    tsChecker: {},\n  },\n};\n\n\nMore configurations can be seen at tsChecker configuration\n\nNote that if ts-loader is enabled and compileOnly: false is set, please disable\ntsChecker to avoid duplicate type-checking.\n\nSTC\nThe author of SWC has announced a new open-source type-checking tool based on\nRust, which is called STC, it's super fast but it cannot used for production\nnow, really don't recommend you use that for now, when it's stabled we will use\nthat in Builder SWC plugin as experimental ability.","frontmatter":{}},{"id":128,"title":"Import Wasm Assets","routePath":"/builder/en/guide/basic/wasm-assets","lang":"en","toc":[{"text":"Import","id":"import","depth":2},{"text":"Output Directory","id":"output-directory","depth":2},{"text":"Add Type Declaration","id":"add-type-declaration","depth":2}],"domain":"","content":"#\n\nBuilder supports import WebAssembly assets in code.\n\nWhat is WebAssembly\nWebAssembly (Wasm) is a portable, high-performance binary format designed to\nexecute CPU-intensive computing tasks in modern web browsers, bringing\nperformance and reliability similar to native compiled code to the web platform.\nINFO\nIf you are using Rspack as the bundler, import Wasm assets is not supported yet.\n\n\nImport#\n\nYou can import a WebAssembly module directly in a JavaScript file:\n\nindex.js\n\n\n\nconsole.log(add); // [native code]\nconsole.log(add(1, 2)); // 3\n\n\nWebAssembly modules can also be imported via Dynamic Import:\n\nindex.js\n\nimport('./add.wasm').then(({ add }) => {\n  console.log('---- Async Wasm Module');\n  console.log(add); // [native code]\n  console.log(add(1, 2)); // 3\n});\n\n\n\nOutput Directory#\n\nWhen a .wasm asset is imported, it will be output by Builder to the\ndist/static/wasm directory by default.\n\nYou can change the output directory of .wasm files via output.distPath config.\n\nexport default {\n  output: {\n    distPath: {\n      wasm: 'resource/wasm',\n    },\n  },\n};\n\n\n\nAdd Type Declaration#\n\nWhen you import a Wasm file in TypeScript code, you usually need to add the\ncorresponding type declaration.\n\nFor example, the add.wasm file exports an add() method, then you can create an\nadd.wasm.d.ts file in the same directory and add the corresponding type\ndeclaration:\n\nadd.wasm.d.ts\n\nexport const add = (num1: number, num2: number) => number;\n","frontmatter":{}},{"id":129,"title":"Debug Mode","routePath":"/builder/en/guide/debug/debug-mode","lang":"en","toc":[{"text":"Log information","id":"log-information","depth":2},{"text":"Builder config file","id":"builder-config-file","depth":2},{"text":"webpack config file","id":"webpack-config-file","depth":2}],"domain":"","content":"#\n\nBuilder provides a debug mode to troubleshoot problems, you can add the\nDEBUG=builder environment variable when executing a build to enable Builder's\ndebug mode.\n\n# Debug development environment\nDEBUG=builder pnpm dev\n\n# Debug production environment\nDEBUG=builder pnpm build\n\n\nIn debug mode, Builder will output some additional log information, and write\nthe Builder config and webpack config to the dist directory, which is convenient\nfor developers to view and debug.\n\n\nLog information#\n\nIn debug mode, you will see some additional information output from the shell,\namong which are some process logs starting with debug, indicating what\noperations are performed inside the Builder.\n\n$ DEBUG=builder pnpm dev\n\ndebug create context [1842.90 ms]\ndebug add default plugins [1874.45 ms]\ndebug add default plugins done [1938.57 ms]\ndebug init plugins [2388.29 ms]\ndebug init plugins done [2389.48 ms]\n...\n\n\nIn addition, the following logs will be output in the Shell, indicating that the\nBuilder has written the internally generated build configs to disk, and you can\nopen these config files to view the corresponding content.\n\nInspect config succeeds, open following files to view the content:\n\n   - Builder Config: /Project/demo/dist/builder.config.js\n   - Webpack Config (web): /Project/demo/dist/webpack.config.web.js\n\n\n\nBuilder config file#\n\nIn debug mode, Builder will automatically generate dist/builder.config.js file,\nwhich contains the final generated Builder config. In this file, you can know\nthe final result of the Builder config you passed in after being processed by\nthe framework and Builder.\n\nThe structure of the file is as follows:\n\nmodule.exports = {\n  dev: {\n    // some configs...\n  },\n  source: {\n    // some configs...\n  },\n  // other configs...\n};\n\n\nFor a complete introduction to Builder config, please see the Builder Config\nchapter.\n\n\nwebpack config file#\n\nIn debug mode, Builder will also automatically generate\ndist/webpack.config.web.js file, which contains the final generated webpack\nconfig. In this file, you can see what is included in the config that Builder\nfinally passes to webpack.\n\nThe structure of the file is as follows:\n\nmodule.exports = {\n  resolve: {\n    // some resolve configs...\n  },\n  module: {\n    // some webpack loaders...\n  },\n  plugins: [\n    // some webpack plugins...\n  ],\n  // other configs...\n};\n\n\nIn addition, if the project configures additional build targets, such as\nenabling the SSR capability of the framework (corresponding to additional\nNode.js build target), an additional webpack.config.node.js file will be\ngenerated in the dist directory, corresponding to the webpack config for SSR\nbundles.\n\nFor a complete introduction to webpack configs, please see webpack official\ndocumentation.","frontmatter":{}},{"id":130,"title":"Using Webpack Inspector","routePath":"/builder/en/guide/debug/inspector","lang":"en","toc":[{"text":"Introduction","id":"introduction","depth":2},{"text":"Enable","id":"enable","depth":2},{"text":"Debug Panel","id":"debug-panel","depth":2},{"text":"Config Preview Mode","id":"config-preview-mode","depth":3},{"text":"List Mode","id":"list-mode","depth":3},{"text":"Loader Statistics","id":"loader-statistics","depth":3},{"text":"Dependency Graph Mode","id":"dependency-graph-mode","depth":3}],"domain":"","content":"#\n\nBuilder has a built-in webpack inspector to debug webpack.\n\n\nIntroduction#\n\nThe internal workflow of webpack is relatively black box, when using webpack, we\noften encounter the following problems:\n\n * When using some upper-level frameworks, I don't know what the final generated\n   webpack config contains.\n * Each module will be processed by different loaders, and the compilation\n   results of each loader are difficult to perceive.\n * It is difficult to analyze the time cost of each webpack loader (such as\n   babel-loader, ts-loader).\n\nIn order to make performance analysis, error investigation and loader\ndevelopment more convenient, we provide the webpack inspector tool in the\nBuilder.\n\n\nEnable#\n\nYou can enable webpack inspector through tools.inspector config:\n\nexport default {\n  tools: {\n    inspector: {},\n  },\n};\n\n\nIn order to prevent the inspector from affecting normal development, it is\nrecommended to enable the inspector only in DEBUG mode:\n\nexport default {\n  tools: {\n    inspector: process.env.DEBUG ? {} : undefined,\n  },\n};\n\n\nAfter adding the above config, when you execute DEBUG=true pnpm dev, Builder\nwill start the inspector after the compilation is complete. At this time, you\ncan see the following information in the Shell:\n\ninfo    Starting dev server...\n\nWebpack Inspector started at http://localhost:3333\n\n\nOpen the http://localhost:3333 address to access the debug panel of the\ninspector.\n\n\nDebug Panel#\n\nThe Inspector's debugging panel provides multiple modes, which you can switch\nthrough the buttons in the upper right corner.\n\n\nConfig Preview Mode#\n\nThe default mode of the panel is config preview mode. In this mode, you can view\nall config information inside webpack, and the config object can be expanded or\ncollapsed:\n\n\n\n\nList Mode#\n\nIn this mode, all module information will be displayed:\n\n\n\nClicking on the list item will display the compilation details of the module:\n\n\n\n\nLoader Statistics#\n\nClick the following switch to view loader statistics:\n\n\n\n\nDependency Graph Mode#\n\nIn this mode, the dependencies of all modules will be displayed:\n\n\n\nClicking on a node in the graph will also display the compilation details of the\nspecific module:\n\n\n\nTIP\nFor performance reasons, the dependency graph is not displayed when the number\nof modules is > 100.","frontmatter":{}},{"id":131,"title":"Exceptions","routePath":"/builder/en/guide/faq/exceptions","lang":"en","toc":[{"text":"\\'compilation\\' argument error when webpack compiling?","id":"\\'compilation\\'-argument-error-when-webpack-compiling?","depth":2},{"text":"Find ES6+ code in the compiled files?","id":"find-es6+-code-in-the-compiled-files?","depth":2},{"text":"Failed import other modules in Monorepo?","id":"failed-import-other-modules-in-monorepo?","depth":2},{"text":"Compile error You may need additional loader?","id":"compile-error-you-may-need-additional-loader?","depth":2},{"text":"Find exports is not defined runtime error?","id":"find-exports-is-not-defined-runtime-error?","depth":2},{"text":"Compile error \\\"Error: ES Modules may not assign module.exports or exports.*, Use ESM export syntax\\\"?","id":"compile-error-\\\"error:-es-modules-may-not-assign-module.exports-or-exports.*,-use-esm-export-syntax\\\"?","depth":2},{"text":"The compilation progress bar is stuck, but there is no Error log in the terminal?","id":"the-compilation-progress-bar-is-stuck,-but-there-is-no-error-log-in-the-terminal?","depth":2},{"text":"The webpack cache does not work?","id":"the-webpack-cache-does-not-work?","depth":2},{"text":"Tree shaking does not take effect?","id":"tree-shaking-does-not-take-effect?","depth":2},{"text":"JavaScript heap out of memory when compiling?","id":"javascript-heap-out-of-memory-when-compiling?","depth":2},{"text":"Can\\'t resolve \\'core-js/modules/xxx.js\\' when compiling?","id":"can\\'t-resolve-\\'core-js/modules/xxx.js\\'-when-compiling?","depth":2},{"text":"HMR not work when updating React components?","id":"hmr-not-work-when-updating-react-components?","depth":2},{"text":"Division in Less file doesn\\'t work?","id":"division-in-less-file-doesn\\'t-work?","depth":2},{"text":"Compile error TypeError: Cannot delete property \\'xxx\\' of #<Object>","id":"compile-error-typeerror:-cannot-delete-property-\\'xxx\\'-of-#<object>","depth":2}],"domain":"","content":"#\n\n\n'compilation' argument error when webpack compiling?#\n\nIf the following error occurs when compiling, it is usually caused by installing\nthe wrong version of webpack in the project, or installing multiple versions of\nwebpack:\n\nTypeError: The 'compilation' argument must be an instance of Compilation\n\n\nThe webpack version problem has the following situations:\n\n 1. The webpack dependency is directly declared in the project's package.json,\n    and the version range of the webpack that the Builder depends on is\n    different and cannot match the same version.\n 2. Multiple npm packages installed in the project all depend on webpack, and\n    the webpack version ranges they depend on are different and cannot match the\n    same version.\n 3. Due to the lock mechanism of the package manager, multiple webpack versions\n    are generated in the lock file.\n\nIn the first case, it is recommended to remove the webpack dependency from the\nproject's package.json. Because Builder encapsulates webpack-related\ncapabilities by default, and will pass in the webpack object in the\ntools.webpack configuration item. Therefore, in most cases, it is not\nrecommended to install additional webpack dependencies in the project.\n\nIn the second case, it is recommended to see if you can upgrade an npm package\nso that its dependent webpack version range is consistent with the Builder. It\nis also possible to manually unify versions through the ability of the package\nmanager, e.g. using yarn resolutions or [pnpm overrides](https\n://pnpm.io/package_json#pnpmoverrides).\n\nIf it is the third case, you can use the two methods mentioned in the second\ncase, or you can try to delete the lock file and reinstall it to solve it.\n\nTIP\nDeleting the lock file will automatically upgrade the dependency version in the\nproject to the latest version under the specified scope, please test it\nthoroughly.\n\n\nFind ES6+ code in the compiled files?#\n\nBy default, Builder will not compile files under node_modules through\nbabel-loader or ts-loader. If the npm package introduced by the project contains\nES6+ syntax, it will be packaged into the product.\n\nWhen this happens, you can specify directories or modules that need to be\ncompiled additionally through the source.include configuration item.\n\n\nFailed import other modules in Monorepo?#\n\nFor the sake of compilation performance, by default, Builder will not compile\nfiles under node_modules through babel-loader or ts-loader, nor will it compile\nfiles outside the current project directory.\n\nThrough the source.include configuration item, you can specify directories or\nmodules that require additional compilation.\n\nFor details, see source.include usage introduction.\n\n\nCompile error You may need additional loader?#\n\nIf the following error message is encountered during the compilation process, it\nmeans that there are individual files that cannot be compiled correctly.\n\nModule parse failed: Unexpected token\nFile was processed with these loaders:\n * some-loader/index.js\n\nYou may need an additional loader to handle the result of these loaders.\n\n\nSolution:\n\n * If the .ts file outside the current project is referenced, or the .ts file\n   under node_modules, please add the source.include configuration Items that\n   specify files that require additional compilation.\n * If you refer to a file format that is not supported by Builder, please\n   configure the corresponding webpack loader for compilation.\n\n\nFind exports is not defined runtime error?#\n\nIf the compilation is succeed, but the exports is not defined error appears\nafter opening the page, it is usually because a CommonJS module is compiled by\nbabel.\n\nUnder normal circumstances, Builder will not use babel to compile CommonJS\nmodules. If the source.include configuration item is used in the project, or the\n[tools.babel](/en/api/config-tools.html#tools -babel) addIncludes method, some\nCommonJS modules may be added to the babel compilation.\n\nThere are two workarounds for this problem:\n\n 1. Avoid adding CommonJS modules to babel compilation.\n 2. Set babel's sourceType configuration item to unambiguous, for example:\n\nexport default {\n  tools: {\n    babel(config) {\n      config.sourceType = 'unambiguous';\n    },\n  },\n};\n\n\nSetting sourceType to unambiguous may have some other effects, please refer to\nbabel official documentation.\n\n\nCompile error \"Error: ES Modules may not assign module.exports or exports.*, Use\nESM export syntax\"?#\n\nIf the following error occurs during compilation, it is usually because a\nCommonJS module is compiled with babel in the project, and the solution is same\nas the above exports is not defined problem.\n\nError: ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: 581\n\n\nFor more information, please refer to issue: babel#12731.\n\n\nThe compilation progress bar is stuck, but there is no Error log in the\nterminal?#\n\nWhen the compilation progress bar is stuck, but there is no Error log on the\nterminal, it is usually because an exception occurred during the compilation. In\nsome cases, when Error is caught by webpack or other modules, the error log can\nnot be output correctly. The most common scenario is that there is an exception\nin the Babel config, which is caught by webpack, and webpack swallows the Error\nin some cases.\n\nSolution:\n\nIf this problem occurs after you modify the Babel config, it is recommended to\ncheck for the following incorrect usages:\n\n 1. You have configured a plugin or preset that does not exist, maybe the name\n    is misspelled, or it is not installed correctly.\n\n// wrong example\nexport default {\n  tools: {\n    babel(config, { addPlugins }) {\n      // The plugin has the wrong name or is not installed\n      addPlugins('babel-plugin-not-exists');\n    },\n  },\n};\n\n\n 2. Whether multiple babel-plugin-imports are configured, but the name of each\n    babel-plugin-import is not declared in the third item of the array.\n\n// wrong example\nexport default {\n  tools: {\n    babel(config, { addPlugins }) {\n      addPlugins([\n        [\n          'babel-plugin-import',\n          { libraryName: 'antd', libraryDirectory: 'es' },\n        ],\n        [\n          'babel-plugin-import',\n          { libraryName: 'antd-mobile', libraryDirectory: 'es' },\n        ],\n      ]);\n    },\n  },\n};\n\n\n// correct example\nexport default {\n  tools: {\n    babel(config, { addPlugins }) {\n      addPlugins([\n        [\n          'babel-plugin-import',\n          { libraryName: 'antd', libraryDirectory: 'es' },\n          'antd',\n        ],\n        [\n          'babel-plugin-import',\n          { libraryName: 'antd-mobile', libraryDirectory: 'es' },\n          'antd-mobile',\n        ],\n      ]);\n    },\n  },\n};\n\n\n\nThe webpack cache does not work?#\n\nBuilder enables webpack's persistent cache by default.\n\nAfter the first compilation is completed, the cache file will be automatically\ngenerated and output to the ./node_modules/.cache/webpack directory. When the\nsecond compilation is performed, the cache is hit and the compilation speed is\ngreatly improved.\n\nWhen configuration files such as package.json are modified, the cache is\nautomatically invalidated.\n\nIf the webpack compilation cache in the project has not taken effect, you can\nadd the following configuration for troubleshooting:\n\nexport default {\n  tools: {\n    webpack(config) {\n      config.infrastructureLogging = {\n        ...config.infrastructureLogging,\n        debug: /webpack\\.cache/,\n      };\n    },\n  },\n};\n\n\nAfter adding the above configuration, webpack will output logs for debugging.\nPlease refer to the logs related to PackFileCacheStrategy to understand the\ncause of cache invalidation.\n\n\nTree shaking does not take effect?#\n\nBuilder will enable the tree shaking function of webpack by default during\nproduction construction. Whether tree shaking can take effect depends on whether\nthe business code can meet the tree shaking conditions of webpack.\n\nIf you encounter the problem that tree shaking does not take effect, you can\ncheck whether the sideEffects configuration of the relevant npm package is\ncorrect. If you don't know what sideEffects is, or are interested in the\nprinciples behind tree shaking, you can read the following two documents:\n\n * webpack official documentation - Tree Shaking\n * Tree Shaking Troubleshooting Guide\n\n\nJavaScript heap out of memory when compiling?#\n\nThis error indicates that there is a memory overflow problem during the\npackaging process. In most cases, it is because the packaged content exceeds the\ndefault memory limit of Node.js.\n\nIn case of OOM issues, the easiest way to fix this is by increasing the memory\ncap, Node.js provides the --max-old-space-size option to set this. You can set\nthis parameter by adding NODE_OPTIONS before the CLI command\n\nFor example, add parameters before the modern build command:\n\npackage.json\n\n{\n   \"scripts\": {\n- \"build\": \"modern build\"\n+ \"build\": \"NODE_OPTIONS=--max_old_space_size=16384 modern build\"\n   }\n}\n\n\nIf you are executing other commands, such as modern deploy, please add\nparameters before the corresponding command.\n\nThe value of the max_old_space_size parameter represents the upper limit of the\nmemory size (MB). Generally, it can be set to 16384 (16GB).\n\nThe following parameters are explained in more detail in the official Node.js\ndocumentation:\n\n * NODE_OPTIONS\n * --max-old-space-size\n\nIn addition to increasing the memory limit, it is also a solution to improve\nefficiency by enabling some compilation strategies, please refer to Improve\nBuild Performance.\n\nIf the above methods cannot solve your problem, it may be that some abnormal\nlogic in the project has caused memory overflow. You can debug recent code\nchanges and locate the root cause of problems. If it cannot be located, please\ncontact us.\n\n\nCan't resolve 'core-js/modules/xxx.js' when compiling?#\n\nIf you get an error similar to the following when compiling, it means that\ncore-js cannot be resolved properly in the project.\n\nModule not found: Can't resolve 'core-js/modules/es.error.cause.js'\n\n\nUsually, you don't need to install core-js in the project, because the Builder\nalready has a built-in core-js v3.\n\nIf there is an error that core-js cannot be found, there may be several reasons:\n\n 1. The plugins configured by Babel is overwritten in the project, causing the\n    built-in babelPluginLockCorejsVersion does not work. In this case, just\n    change tools.babel to a function:\n\n// Wrong usage, will override Builder's default Babel plugins\nexport default {\n  tools: {\n    babel: {\n      plugins: ['babel-plugin-xxx'],\n    },\n  },\n};\n\n// Correct usage, add a new plugin in the default configuration instead of overriding the plugin\nexport default {\n  tools: {\n    babel(config) {\n      config.plugins.push('babel-plugin-xxx');\n    },\n  },\n};\n\n\n 2. Some code in the project depends on core-js v2. In this case, you usually\n    need to find out the corresponding code and upgrade core-js to the v3.\n 3. An npm package in node_modules imported core-js, but does not declare the\n    core-js dependency in dependencies. In this case, you need to declare the\n    core-js dependency in the corresponding npm package, or install a copy of\n    core-js in the project root directory.\n\n\nHMR not work when updating React components?#\n\nBuilder uses React's official Fast Refresh capability to perform component hot\nupdates.\n\nIf there is a problem that the hot update of the React component cannot take\neffect, or the state of the React component is lost after the hot update, it is\nusually because your React component uses an anonymous function. In the official\npractice of React Fast Refresh, it is required that the component cannot be an\nanonymous function, otherwise the state of the React component cannot be\npreserved after hot update.\n\nHere are some examples of wrong usage:\n\n// bad\nexport default function () {\n   return \nHello World;\n}\n\n// bad\nexport default () => \nHello World;\n\n\nThe correct usage is to declare a name for each component function:\n\n// good\nexport default function MyComponent() {\n   return \nHello World;\n}\n\n// good\nconst MyComponent = () => \nHello World\n\nexport default MyComponent;\n\n\n\nDivision in Less file doesn't work?#\n\nCompared with the v3 version, the Less v4 version has some differences in the\nway of writing division:\n\n// Less v3\n.math {\n  width: 2px / 2; // 1px\n  width: 2px ./ 2; // 1px\n  width: (2px / 2); // 1px\n}\n\n// Less v4\n.math {\n  width: 2px / 2; // 2px / 2\n  width: 2px ./ 2; // 1px\n  width: (2px / 2); // 1px\n}\n\n\nThe built-in Less version of Builder is v4, and the writing method of the lower\nversion will not take effect. Please pay attention to the distinction.\n\nThe writing of division in Less can also be modified through configuration\nitems, see Less - Math.\n\n\nCompile error TypeError: Cannot delete property 'xxx' of ##\n\nThis error indicates that a read-only configuration item was deleted during the\ncompilation process. Normally, we do not want any operation to directly modify\nthe incoming configuration when compiling, but it is difficult to restrict the\nbehavior of underlying plugins (such as postcss-loader, etc). If this error\noccurs, please contact the builder developer and we will need to do something\nspecial with that configuration.\n\nThe same type of error is also reported:\n\n * 'TypeError: Cannot add property xxx, object is not extensible'\n * 'TypeError: Cannot assign to read only property 'xxx' of object '#'","frontmatter":{}},{"id":132,"title":"Features","routePath":"/builder/en/guide/faq/features","lang":"en","toc":[{"text":"How to import UI Component library on demand?","id":"how-to-import-ui-component-library-on-demand?","depth":2},{"text":"How to run ESLint during compilation?","id":"how-to-run-eslint-during-compilation?","depth":2},{"text":"How to configure CDN path for static assets?","id":"how-to-configure-cdn-path-for-static-assets?","depth":2},{"text":"How to clear the webpack cache?","id":"how-to-clear-the-webpack-cache?","depth":2},{"text":"How to remove console after production build?","id":"how-to-remove-console-after-production-build?","depth":2}],"domain":"","content":"#\n\n\nHow to import UI Component library on demand?#\n\nIf you need to configure the on-demand import of the component library, you can\nconfigure it through source.transformImport, which is equivalent to\nbabel-plugin-import.\n\nexport default {\n  source: {\n    transformImport: [\n      {\n        libraryName: 'xxx-components',\n        libraryDirectory: 'es',\n        style: true,\n      },\n    ],\n  },\n};\n\n\n\nHow to run ESLint during compilation?#\n\nFor the sake of compilation performance, Builder will not perform ESLint\nverification during the compilation process by default. If you need this\nfunction, you can manually install and register the eslint-webpack-plugin in the\ncommunity -contrib/eslint-webpack-plugin).\n\nThe sample code to register the plugin is as follows:\n\n\n\nexport default {\n  tools: {\n    webpackChain(chain) {\n      chain.plugin('eslint-plugin').use(ESLintPlugin, [\n        {\n          extensions: ['.js', '.ts', '.jsx', 'tsx', '.mjs'],\n        },\n      ]);\n    },\n  },\n};\n\n\n> For more detailed usage, please refer to the eslint-webpack-plugin\n> documentation.\n\n\nHow to configure CDN path for static assets?#\n\nIf you need to upload static assets such as JS and CSS to CDN for use, you can\nset the URL prefix of static assets through the output.assetPrefix\nconfiguration.\n\nexport default {\n  output: {\n    assetPrefix: 'https://cdn.example.com/assets/',\n  },\n};\n\n\n\nHow to clear the webpack cache?#\n\nBy default, Builder's webpack cache is generated in the\n./node_modules/.cache/webpack directory.\n\nIf you need to clear the local webpack cache, you can execute the following\ncommand:\n\nrm -rf ./node_modules/.cache\n\n\n\nHow to remove console after production build?#\n\nWhen the production environment is built, we can remove the console from the\ncode, so as to avoid the log of the development environment being output to the\nproduction environment.\n\nBuilder provides a configuration item to remove console by default, please see\nperformance.removeConsole.","frontmatter":{}},{"id":133,"title":"General","routePath":"/builder/en/guide/faq/general","lang":"en","toc":[{"text":"The relationship between Modern.js Builder and Modern.js?","id":"the-relationship-between-modern.js-builder-and-modern.js?","depth":2},{"text":"Can Builder be used to build libraries or UI components?","id":"can-builder-be-used-to-build-libraries-or-ui-components?","depth":2},{"text":"Will Builder support Turbopack?","id":"will-builder-support-turbopack?","depth":2},{"text":"Will Builder support Vite?","id":"will-builder-support-vite?","depth":2}],"domain":"","content":"#\n\n\nThe relationship between Modern.js Builder and Modern.js?#\n\nThe building abilities of Modern.js are based on Modern.js Builder.\n\nWhen developing Modern.js, we designed Builder as an independent module, and\nclearly divided the responsibilities of Builder and Modern.js. Therefore,\nBuilder can be used independently of the Modern.js framework and be applied to\nother frameworks or scenarios.\n\n\nCan Builder be used to build libraries or UI components?#\n\nBuilder focuses on solving web application building scenarios. We do not\nrecommend that you use Builder to build libraries or UI components.\n\nIf you need to build a library or UI components, it is recommended to use the\nModern.js Module Tools.\n\n\nWill Builder support Turbopack?#\n\nBuilder is already supporting Rspack, and currently Turbopack supports use in\nNext.js, so there is no plan for Builder to support Turbopack.\n\n> You can find the comparison of Rspack and Turbopack in the Introduction of\n> Rspack.\n\n\nWill Builder support Vite?#\n\nVite is a great tool, but the goal of Builder is to replace webpack with Rust\nBundler, Rspack can provide fast compilation speed, while maintaining the\nconsistent behavior between development and production.\n\nBuilder will focus on the evolution from webpack to Rspack, so it will not be\nsupport Vite.\n\n> You can find the comparison of Vite and Turbopack in the Introduction of\n> Rspack.","frontmatter":{}},{"id":134,"title":"All Features","routePath":"/builder/en/guide/features","lang":"en","toc":[{"text":"JavaScript","id":"javascript","depth":2},{"text":"CSS","id":"css","depth":2},{"text":"HTML","id":"html","depth":2},{"text":"Development and Debugging","id":"development-and-debugging","depth":2},{"text":"React","id":"react","depth":2},{"text":"Static Assets","id":"static-assets","depth":2},{"text":"Performance","id":"performance","depth":2}],"domain":"","content":"#\n\nHere are all the main features supported by Modern.js Builder.\n\n\nJavaScript#\n\nFEATURES                   DESCRIPTION                                                    LINKS\nBabel compilation          Babel compilation is enabled by default, which converts        \n                           JavaScript and TypeScript code to backward compatible\n                           JavaScript syntax\nTS compilation             TS files are compiled by Babel by default, you can also use    \n                           ts-loader\nType Checker               Runs TypeScript type checker by default                        \nJS minification            JS minification is enabled by default in production build      \nPolyfill injection         core-js and other polyfills are injected by default            \nSourceMap generation       High-quality SourceMap is generated by default in production   \n                           build\nAlias                      Optional feature, set import alias                             \nRestrict importing paths   Optional feature, restrict source code import paths            \nesbuild compilation        Optional feature, transform and minify JavaScript and          \n                           TypeScript code with esbuild\nSWC Compilation            Optional feature, transform and minify JavaScript and          \n                           TypeScript code with SWC\nNode artifacts             Optional feature, support building bundles that run in         \n                           Node.js environment\nWeb Worker artifacts       Optional feature, support building bundles that run in a Web   \n                           Worker environment\nBrowserslist               Optional feature, using browserslist (opens new window)to      \n                           specify which browsers should be supported in your Web\n                           application.\n\n\nCSS#\n\nFEATURES                  DESCRIPTION                                                    LINKS\nPostCSS compilation       PostCSS compilation is enabled by default, built-in            \n                          autoprefixer and other plugins\nSass preprocessing        Support compile Sass files by default                          \nLess preprocessing        Support compile Less files by default                          \nStylus preprocessing      Optional feature, compile Stylus files                         \nCSS Modules Compilation   Support compiling *.module.* files by default                  \nCSS Modules Type          Optional feature, automatically generate type definition for   \n                          CSS Modules\nCSS minification          CSS minification is enabled by default in production build     \nExtract CSS files         CSS will be extracted as separate files by default             \nStyled Components         Support styled components compilation by default               \nInline CSS into JS        Optional feature, inline CSS files to JavaScript files         \n\n\nHTML#\n\nFEATURES                  DESCRIPTION                                    LINKS\nSet title                 Set HTML title tag                             \nSet meta                  Set HTML meta tag                              \nSet favicon               Set favicon for page                           \nSet app icon              Set apple icon for iOS                         \nUse EJS template engine   Optional feature, use EJS template engine      \nUse Pug template engine   Optional feature, use pug template engine      \nInline JS files           Optional feature, inline JS files into HTML    \nInline CSS files          Optional feature, inline CSS files into HTML   \n\n\nDevelopment and Debugging#\n\nFEATURES                  DESCRIPTION                                                LINKS\nAutomatically open page   Optional feature, automatically open page URL in browser   \n                          when starting Dev Server\nHTTPS Dev Server          Optional feature, enable HTTPS Dev Server                  \n\n\nReact#\n\nFEATURES                 DESCRIPTION                                     LINKS\nReact Refresh            Support React Refresh by default                \nSVG to React component   Support to import SVG as component by default   \n\n\nStatic Assets#\n\nFEATURES                 DESCRIPTION                                                  LINKS\nImport image assets      Support for import image assets in code                      \nImport font assets       Support for import font assets in code                       \nImport video assets      Support for import video assets in code                      \nImport wasm assets       Support for import WebAssembly assets in code                \nInline static assets     Small assets are inlined into JS by default                  \nClean up static assets   Automatically clean up static assets in the dist directory   \n                         before each build\nCopy static assets       Optional feature, copy static assets to the dist directory   \nGenerate manifest file   Optional feature, generate manifest file containing static   \n                         asset information\n\n\nPerformance#\n\nFEATURES                         DESCRIPTION                                                    LINKS\nChunk Splitting                  A variety of chunk splitting strategies are built into         \n                                 Builder to automatically split the bundle into files of\n                                 moderate size\nPrint File Size                  After the production build, All bundle sizes is displayed by   \n                                 default\nAnalyze bundle size              Optional feature, analyze bundle size through Bundle           \n                                 Analyzer\nRemove console                   Optional feature, remove console.xx in code                    \nOptimize the size of moment.js   Optional feature, remove the redundant locale files of         \n                                 moment.js","frontmatter":{}},{"id":135,"title":"Glossary","routePath":"/builder/en/guide/glossary","lang":"en","toc":[{"text":"Bundler","id":"bundler","depth":2},{"text":"Rspack","id":"rspack","depth":2},{"text":"Builder","id":"builder","depth":2},{"text":"Builder Provider","id":"builder-provider","depth":2},{"text":"Modern.js","id":"modern.js","depth":2},{"text":"EdenX","id":"edenx","depth":2}],"domain":"","content":"#\n\n\nBundler#\n\nRefers to module bundlers such as webpack, Rspack.\n\nThe main goal of bundlers is to bundle JavaScript, CSS and other files together,\nand the bundled files can be used in the browser, Node.js or other environments.\nWhen bundler processes the Web application, it builds a dependency graph and\nthen combines every module into one or more bundles.\n\n\nRspack#\n\nRspack is a high performance Rust-based JavaScript bundler that offers strong\ninteroperability with the webpack ecosystem, enabling faster development cycles\nand efficient collaboration between the two tools.\n\n\nBuilder#\n\nBuild Engine. The goal of Builder is to \"reuse the best practices of build\ntools\".\n\nBundlers are low-level, if we build a project based on webpack, we need to fully\nunderstand the webpack config and many webpack plugins and loaders, then spend a\nlot of time to combine them.\n\nBuilder is a out-of-box build tools. By using Builder, you can quickly gain the\nability to build a web application.\n\nThe layers inside the Builder are as follows:\n\n\n\n\nBuilder Provider#\n\nBuilder Provider is a part of Builder. Providers implements corresponding build\nfeature based on specific bundlers.\n\nCurrently there are two Providers:\n\n * @modern-js/builder-webpack-provider: Based on webpack.\n * @modern-js/builder-rspack-provider: Based on rspack.\n\n\nModern.js#\n\nModern.js is an open source web engineering system from ByteDance, which\nprovides multiple solutions to help developers solve problems in different\ndevelopment scenarios.\n\nModern.js Repository.\n\n\nEdenX#\n\nByteDance's internal web engineering system, implemented based on Modern.js.","frontmatter":{}},{"id":136,"title":"Introduction","routePath":"/builder/en/guide/introduction","lang":"en","toc":[{"text":"Rust Tools","id":"rust-tools","depth":2},{"text":"Position","id":"position","depth":2},{"text":"Features","id":"features","depth":2},{"text":"Support Rspack Build","id":"support-rspack-build","depth":3},{"text":"Deep optimization","id":"deep-optimization","depth":3},{"text":"Extensible Plugin System","id":"extensible-plugin-system","depth":3},{"text":"npm packages","id":"npm-packages","depth":2},{"text":"Next Step","id":"next-step","depth":2}],"domain":"","content":"#\n\nModern.js Builder is a Build Engine for web development.\n\nWith the growing of the front-end ecosystem, more and more build tools and\nplugins are created. For most developers, the configuration and dependencies\nrequired to build a web application have become complex; the cost of finding\nbest practices for developers has also risen.\n\nIn order to reduce the complexity and make it easier to build a project, we\nabstracted the build abilities based on the practical experience of Modern.js,\nand created the open source tool Modern.js Builder.\n\n\nRust Tools#\n\nIn recent years, the trend in front-end toolchain has been to re-implement them\nwith native programming languages like Rust for better performance. Some\nhigh-performance tools have created, such as SWC, Rspack, etc., and their use is\ngradually expanding. However, there are many differences between these Rust\ntools and JavaScript tools, including functional differences, configuration\ninconsistencies, which make it difficult for users to migrate.\n\nThe Rust process of the front-end toolchain will continue for a long time,\nModern.js Builder is expected to help developers better transition to Rust\ntools. Whether it's JavaScript tools, Rust tools, or even low-level bundlers\nlike webpack, they're all replaceable components in Modern.js Builder. You can\nincrementally replace these components by turning on configuration or enabling\nplugins, and Modern.js Builder will smooth out the major differences and help\nusers migrate.\n\n\nPosition#\n\nModern.js Builder is a build engine serving the upper-level front-end\nframeworks. It focuses on solving problems in web application building, and\nexpects to provide out-of-box building abilities for front-end frameworks.\n\nIf you are developing a front-end framework, or developing a scaffolding for a\nfront-end application, Builder can provide most of the build logics for you,\nwhich allowing you to focus on implementing other features of the framework.\n\nIf you are a business developer, in most cases, you do not need to manually\ninstall Builder in your projects. We recommend that you use the upper-level\nframeworks based on Builder.\n\nCurrently, the following front-end frameworks are already using Builder:\n\n * Modern.js Framework (Open source).\n * EdenX Framework and PIA Framework inside ByteDance.\n\n\nFeatures#\n\n\nSupport Rspack Build#\n\nBuilder supports both webpack and Rspack, so you can switch between the stable\nWebpack and the faster Rspack.\n\nWhat is Rspack\n\nRspack is a high performance Rust-based JavaScript bundler that offers strong\ninteroperability with the webpack ecosystem, enabling faster development cycles\nand efficient collaboration between the two tools.\n\nRspack's build performance is significantly better than Webpack, not only due to\nthe language benefits of Rust, but also due to its parallel architecture and\nincremental compilation features. Benchmarking has shown that Rspack can deliver\na 5-10x improvement in compilation performance.\n\nBy default, Builder uses webpack 5 as the bundler. Although the compilation\nspeed of webpack is not ideal, it is still the most mature and ecological\nbundler in the community. Based on webpack, Builder integrates babel, postcss,\nterser and other tools to transform or minify codes. Builder also supports\nreplacing some compile tools with native tools to improve compilation speed,\nsuch as replacing babel/terser with swc or esbuild.\n\nIf you have higher build performance requirements, you can easily switch to\nRspack build mode, see Using Rspack for more information.\n\n\nDeep optimization#\n\nBuilder makes full use of various optimization strategies in the webpack\necosystem to ensure the product performance in the production environment.\n\nTaking the chunk splitting scenario as an example, the webpack's splitChunks\nconfig is complex, and Builder makes it as an out-of-the-box\nperformance.chunkSplit config, it will split common third-party libraries into\nchunks to make page loading faster.\n\n\nExtensible Plugin System#\n\nProvides rich configuration items and a flexible plugin system to support\nin-depth customization of all features.\n\nFor Builder, all building abilities are achieved through plugins:\n\n * Most of the plugins are lightweight, built in Builder, and developers can\n   enable or disable them through configs.\n * Some plugins are more complex and developed as independent npm packages,\n   developers can install and use them as needed.\n\nBuilder also supports custom plugins, so framework developers can develop custom\nplugins to meet customized requirements.\n\n\nnpm packages#\n\nBelow is the npm package published by Builder.\n\nPACKAGE                                    VERSION   DESCRIPTION\n@modern-js/builder                                   Core package of Builder\n@modern-js/builder-webpack-provider                  Provides webpack build ability\n@modern-js/builder-rspack-provider                   Provides Rspack build ability\n@modern-js/builder-plugin-swc                        SWC Plugin\n@modern-js/builder-plugin-stylus                     Stylus Plugin\n@modern-js/builder-plugin-esbuild                    Esbuild Plugin\n@modern-js/builder-plugin-node-polyfill              Node Polyfill Plugin\n@modern-js/builder-plugin-image-compress             Image Compress Plugin\n@modern-js/builder-shared                            Shared modules of Builder\n@modern-js/builder-doc                               Documentation snippets of Builder\n\nYou can view the source code of these packages in the packages/builder directory\nof the modern.js repository.\n\n\nNext Step#\n\nYou may want:","frontmatter":{}},{"id":137,"title":"Improve Build Performance","routePath":"/builder/en/guide/optimization/build-performance","lang":"en","toc":[{"text":"General optimization strategy","id":"general-optimization-strategy","depth":2},{"text":"Upgrade Node.js version","id":"upgrade-node.js-version","depth":3},{"text":"Using Rspack build","id":"using-rspack-build","depth":3},{"text":"Using SWC or esbuild","id":"using-swc-or-esbuild","depth":3},{"text":"Avoid using ts-loader","id":"avoid-using-ts-loader","depth":3},{"text":"Development optimization strategies","id":"development-optimization-strategies","depth":2},{"text":"Enable Lazy Compilation","id":"enable-lazy-compilation","depth":3},{"text":"Adjust Source Map format","id":"adjust-source-map-format","depth":3},{"text":"Adjust Browserslist for development","id":"adjust-browserslist-for-development","depth":3},{"text":"Production optimization strategies","id":"production-optimization-strategies","depth":2},{"text":"Disable Source Map","id":"disable-source-map","depth":3}],"domain":"","content":"#\n\nModern.js Builder optimizes build performance by default, but as the project\nbecomes larger, you may encounter some build performance problems.\n\nThis document provides some optional speed-up strategies, developers can choose\nsome of them to improve the build performance.\n\n Notice\nThe strategies in Bundle Size Optimization can also be used to improve build\nperformance, so we won't repeat them here.\n\n\nGeneral optimization strategy#\n\nThe following are some general optimization strategies, which can speed up the\ndevelopment build and production build, and some of them also optimize the\nbundle size.\n\n\nUpgrade Node.js version#\n\nIn general, updating Node.js to the latest LTS release will help improve build\nperformance.\n\nEspecially for devices with Apple M1/M2 chips, it is recommended to use Node 16\nor Node 18.\n\nNode 16 provides Apple Silicon binaries by default, so the performance on M1/M2\nmodels will be greatly improved than Node 14. According to our tests, After\nswitching from Node 14 to Node 16, the compilation speed can be improved by more\nthan 100%.\n\nYou can switch to Node 16 by following steps:\n\n# Install Node.js v16\nnvm install 16\n\n# switch to Node 16\nnvm use 16\n\n# Set Node 16 as the default version\nnvm default 16\n\n# View Node version\nnode -v\n\n\n\nUsing Rspack build#\n\nRspack is a high performance Rust-based JavaScript bundler that offers strong\ninteroperability with the webpack ecosystem, enabling faster development cycles\nand efficient collaboration between the two tools.\n\nRspack's build performance is significantly better than Webpack, not only due to\nthe language benefits of Rust, but also due to its parallel architecture and\nincremental compilation features. Benchmarking has shown that Rspack can deliver\na 5-10x improvement in compilation performance.\n\nIf you have higher build performance requirements, you can easily switch to\nRspack build mode, see Using Rspack for more information.\n\n\nUsing SWC or esbuild#\n\nSWC (Speedy Web Compiler) is a transformer and minimizer for JavaScript and\nTypeScript based on Rust. SWC can provide the same abilities with Babel, and\nit's more than 10x faster than Babel.\n\nesbuild is a front-end build tool based on Golang. It has the functions of\nbundling, compiling and minimizing JavaScript code. Compared with traditional\ntools, the performance is significantly improved. When minimizing code, compared\nto webpack's built-in terser minimizer, esbuild has dozens of times better\nperformance.\n\nBuilder provides SWC plugin and esbuild plugin that allow you to use SWC or\nesbuild instead of babel-loader, ts-loader and terser for transformation and\nminification process. See:\n\n * SWC plugin document\n * esbuild plugin document\n\nSWC vs esbuild\nThe SWC compiled outputs has better compatibility, supports polyfills such as\ncore-js, and has more complete features, so it is recommended to use the SWC\nplugin first.\n\n\nAvoid using ts-loader#\n\nBy default, Builder uses Babel to compile TS files. After enabling the\ntools.tsLoader option, ts-loader will be used to compile TS files.\n\nPlease avoid using ts-loader because it requires additional parsing and type\nchecking, which will slow down the build.\n\nexport default {\n  tools: {\n    // remove this config\n    tsLoader: {},\n  },\n};\n\n\nSee the tools.tsLoader documentation for details.\n\n\nDevelopment optimization strategies#\n\nThe following are strategies for improve build performance in development\nenvironment.\n\n\nEnable Lazy Compilation#\n\nYou can enable the lazy compilation (i.e. on-demand compilation) to improve the\ncompilation startup speed.\n\nexport default {\n  experiments: {\n    lazyCompilation: {\n      imports: true,\n      entries: false,\n    },\n  },\n};\n\n\nThis is an experimental feature and may not work correctly in some scenarios,\nsee experiments.lazyCompilation for details.\n\n\nAdjust Source Map format#\n\nIn order to provide a good debugging experience, Builder uses the\ncheap-module-source-map format Source Map by default in the development\nenvironment, which is a high-quality Source Map format and will bring certain\nperformance overhead.\n\nYou can improve build speed by adjusting the source map format of your\ndevelopment environment.\n\nFor example to disable Source Map:\n\nexport default {\n  tools: {\n    webpackChain(chain, { env }) {\n      if (env === 'development') {\n        chain.devtool(false);\n      }\n    },\n  },\n};\n\n\nOr set the source map format of the development environment to the cheapest eval\nformat:\n\nexport default {\n  tools: {\n    webpackChain(chain, { env }) {\n      if (env === 'development') {\n        chain.devtool('eval');\n      }\n    },\n  },\n};\n\n\n> For detailed differences between different Source Map formats, see webpack -\n> devtool.\n\n\nAdjust Browserslist for development#\n\nThis strategy is similar to \"Adjust Browserslist\", the difference is that we can\nset different browserslist for development and production environment, thereby\nreducing the compilation overhead in the development environment.\n\nFor example, you can add the following config to package.json, which means that\nonly the latest browsers are compatible in the development environment, and the\nactual browsers are compatible in the production environment:\n\n{\n  \"browserslist\": {\n    \"production\": [\">0.2%\", \"not dead\", \"not op_mini all\"],\n    \"development\": [\n      \"last 1 chrome version\",\n      \"last 1 firefox version\",\n      \"last 1 safari version\"\n    ]\n  }\n}\n\n\nNote that this strategy can lead to some differences in the build result of\ndevelopment production environment.\n\n\nProduction optimization strategies#\n\nThe following are strategies for improve build performance in production\nenvironment.\n\n\nDisable Source Map#\n\nIf your project does not need Source Map in the production, you can turn it off\nthrough the disableSourceMap config to improve the build speed.\n\nexport default {\n  output: {\n    disableSourceMap: true,\n  },\n};\n\n\nSee output.disableSourceMap for details.","frontmatter":{}},{"id":138,"title":"Inline Static Assets","routePath":"/builder/en/guide/optimization/inline-assets","lang":"en","toc":[{"text":"Automatic Inlining","id":"automatic-inlining","depth":2},{"text":"Force Inlining","id":"force-inlining","depth":2},{"text":"Referenced from CSS file","id":"referenced-from-css-file","depth":3},{"text":"Force no inlining","id":"force-no-inlining","depth":2},{"text":"Referenced from CSS file","id":"referenced-from-css-file-1","depth":3},{"text":"Inline JS files","id":"inline-js-files","depth":2},{"text":"Inline CSS files","id":"inline-css-files","depth":2},{"text":"Add Type Declaration","id":"add-type-declaration","depth":2}],"domain":"","content":"#\n\nInline static assets refer to the practice of including the content of a static\nasset directly in a HTML or JS file, instead of linking to an external file.\nThis can improve the performance of a website by reducing the number of HTTP\nrequests that the browser has to make to load the page.\n\nHowever, static resource inlining also has some disadvantages, such as\nincreasing the size of a single file, which may lead to slower loading.\nTherefore, in the actual scenario, it is necessary to decide whether to use\nstatic resource inlining according to the specific situation.\n\nBuilder will automatically inline static assets that are less than 10KB, but\nsometimes you may need to manually control assets to force them to be inlined or\nnot, and this document explains how to precisely control the inlining behavior\nof static assets.\n\n\nAutomatic Inlining#\n\nBy default, Builder will inline assets when the file size of is less than a\nthreshold (the default is 10KB). When inlined, the asset will be converted to a\nBase64 encoded string and will no longer send a separate HTTP request. When the\nfile size is greater than this threshold, it is loaded as a separate file with a\nseparate HTTP request.\n\nThe threshold can be modified with the output.dataUriLimit config. For example,\nset the threshold of images to 5000 Bytes, and set media assets not to be\ninlined:\n\nexport default {\n  output: {\n    dataUriLimit: {\n      image: 5000,\n      media: 0,\n    },\n  },\n};\n\n\n\nForce Inlining#\n\nYou can force an asset to be inlined by adding the inline query when importing\nthe asset, regardless of whether the asset's size is smaller than the size\nthreshold.\n\n\n\n\nexport default function Foo() {\n  return ;\n}\n\n\nIn the above example, the foo.png image will always be inlined, regardless of\nwhether the size of the image is larger than the threshold.\n\nIn addition to the inline query, you can also use the __inline query to force\ninlining of the asset:\n\n\n\n\n\nReferenced from CSS file#\n\nWhen you reference a static asset in your CSS file, you can also force inline\nthe asset with the inline or __inline queries.\n\n.foo {\n  background-image: url('. /icon.png?inline');\n}\n\n\nDo you really need to force inlining?\nInline large assets will significantly increase the first paint time or first\ncontentful paint time of a page, which will hurt user experience. And when you\ninline a static asset multiple times into a CSS file, the base64 content will be\nrepeatedly injected, causing the bundle size to grow . Please use forced\ninlining with caution.\n\n\nForce no inlining#\n\nWhen you want to always treat some assets as separate files, no matter how small\nthe asset is, you can add the url query to force the asset not to be inlined.\n\n\n\n\nexport default function Foo() {\n  return ;\n}\n\n\nIn the above example, the foo.png image will always be loaded as a separate\nfile, even if the size of the image is smaller than the threshold.\n\nIn addition to the url query, you can also use the __inline=false query to force\nthe asset not to be inlined:\n\n\n\n\n\nReferenced from CSS file#\n\nWhen you reference a static asset in your CSS file, you can also force the asset\nnot to be inlined with url or __inline=false queries.\n\n.foo {\n  background-image: url('. /icon.png?url');\n}\n\n\nDo you really need to exclude assets from inlining?\nExcluding assets from inlining will increase the number of assets that the Web\nApp needs to load. This will reduce the efficiency of loading assets in a weak\nnetwork environment or in scenarios where HTTP2 is not enabled. Please use force\nno Inline with caution.\n\n\nInline JS files#\n\nIn addition to inlining static resource files into JS files, Builder also\nsupports inlining JS files into HTML files.\n\nJust enable the output.enableInlineScripts config, and the generated JS files\nwill not be written into the output directory, but will be directly inlined to\nthe corresponding in the HTML file.\n\nexport default {\n  output: {\n    enableInlineScripts: true,\n  },\n};\n\n\n\nInline CSS files#\n\nYou can also inline CSS files into HTML files.\n\nJust enable the output.enableInlineStyles config, the generated CSS file will\nnot be written into the output directory, but will be directly inlined to the\ncorresponding in the HTML file.\n\nexport default {\n  output: {\n    enableInlineStyles: true,\n  },\n};\n\n\n\nAdd Type Declaration#\n\nWhen you use URL queries such as ?inline and ?url in TypeScript code, TypeScript\nmay prompt that the module is missing a type definition:\n\nTS2307: Cannot find module './logo.png?inline' or its corresponding type declarations.\n\n\nTo fix this, you can add type declarations for these URL queries, please create\nsrc/global.d.ts file and add the following type declarations:\n\ndeclare module '*?inline' {\n  const content: string;\n  export default content;\n}\n\ndeclare module '*?inline' {\n  const content: string;\n  export default content;\n}\n\ndeclare module '*?__inline' {\n  const content: string;\n  export default content;\n}\n\ndeclare module '*?inline=false' {\n  const content: string;\n  export default content;\n}\n","frontmatter":{}},{"id":139,"title":"Bundle Size Optimization","routePath":"/builder/en/guide/optimization/optimize-bundle","lang":"en","toc":[{"text":"Reduce duplicate dependencies","id":"reduce-duplicate-dependencies","depth":2},{"text":"Use lightweight libraries","id":"use-lightweight-libraries","depth":2},{"text":"Adjust Browserslist","id":"adjust-browserslist","depth":2},{"text":"Usage polyfill","id":"usage-polyfill","depth":2},{"text":"Image Compression","id":"image-compression","depth":2},{"text":"Split Chunk","id":"split-chunk","depth":2}],"domain":"","content":"#\n\nBundle size optimization is an important part in production environment because\nit directly affects the user experience of online users. In this document, we\nwill introduce some common bundle size optimization methods in Builder.\n\n\nReduce duplicate dependencies#\n\nIn real projects, there will be some third-party dependencies installed with\nmultiple versions. Duplicate dependencies can lead to larger bundles and slower\nbuilds.\n\nWe can detect or eliminate duplicate dependencies with some community tools.\n\n * If you are using pnpm >= 7.26.0, you can use the pnpm dedupe command to\n   upgrade and eliminate duplicate dependencies.\n\npnpm dedupe\n\n\n * If you are using pnpm < 7.26.0, you can use pnpm-deduplicate to analyze all\n   duplicate dependencies, then update dependencies or declare pnpm overrides to\n   merge duplicated dependencies.\n\nnpx pnpm-deduplicate --list\n\n\n * If you are using yarn, you can use yarn-deduplicate to automatically merge\n   duplicated dependencies:\n\nnpx yarn-deduplicate && yarn\n\n\n\nUse lightweight libraries#\n\nIt is recommended to using lightweight libraries in your project, such as\nreplacing moment with day.js.\n\nIf you want to find out the large libraries in the project, you can add the\nBUNDLE_ANALYZE=true environment variable when building:\n\nBUNDLE_ANALYZE=true pnpm build\n\n\nAfter adding this parameter, Builder will generate a HTML file that analyzes the\nbundle size, you can manually open the file in the browser and view the detail\nof the bundle size. When an area is larger, it indicates that its corresponding\nbundle size is larger.\n\n\n\n\nAdjust Browserslist#\n\nThe Builder will compile the code according to the project's Browserslist\nconfig, and inject some Polyfills. If the project does not need to be compatible\nwith legacy browsers, you can adjust the Browserslist and drop some legacy\nbrowsers, thereby reducing the compilation overhead on syntax and polyfill.\n\nBuilder's default Browserslist config is:\n\n['> 0.01%', 'not dead', 'not op_mini all'];\n\n\nFor example, if you only need to be compatible with browsers above Chrome 61,\nyou can change it to:\n\n['Chrome >= 61'];\n\n\nTIP\nPlease read the Browserslist chapter to know more about the usage of\nBrowserslist.\n\n\nUsage polyfill#\n\nWhen it is clear that third-party dependencies do not require additional\npolyfill, you can set output.polyfill to usage.\n\nIn usage mode, Builder analyzes the syntax used in the source code and injects\nthe required polyfill code on demand to reduce the size of polyfill.\n\nexport default {\n  output: {\n    polyfill: 'usage',\n  },\n};\n\n\nTIP\nPlease read the Browser Compatibility chapter to know more about the usage of\nBrowserslist.\n\n\nImage Compression#\n\nIn general front-end projects, the size of image often accounts for a large\nproportion of the total bundle size of the project.So if the image size can be\nreduced as much as possible, it will have a significant optimization effect on\nthe project bundle size. You can enable image compression by registering a\nplugin in the Builder:\n\n\n\n// Add the plugin to the Builder\nbuilder.addPlugins([builderPluginImageCompress()]);\n\n\nSee details in plugin-image-compress\n\n\nSplit Chunk#\n\nA great chunk splitting strategy is very important to improve the loading\nperformance of the application. It can make full use of the browser's caching\nmechanism to reduce the number of requests and improve the loading speed of the\napplication.\n\nA variety of chunk splitting strategies are built into Builder, which can meet\nthe needs of most applications. You can also customize the chunk splitting\nconfig according to your own business scenarios.\n\nFor example, split the axios library under node_modules into axios.js:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-experience',\n      forceSplitting: {\n        axios: /node_modules\\/axios/,\n      },\n    },\n  },\n};\n","frontmatter":{}},{"id":140,"title":"Chunk Splitting Practice","routePath":"/builder/en/guide/optimization/split-chunk","lang":"en","toc":[{"text":"Splitting Strategies","id":"splitting-strategies","depth":2},{"text":"split-by-experience","id":"split-by-experience","depth":3},{"text":"Behavior","id":"behavior","depth":4},{"text":"Config","id":"config","depth":4},{"text":"split-by-module","id":"split-by-module","depth":3},{"text":"Behavior","id":"behavior-1","depth":4},{"text":"Config","id":"config-1","depth":4},{"text":"all-in-one","id":"all-in-one","depth":3},{"text":"Behavior","id":"behavior-2","depth":4},{"text":"Config","id":"config-2","depth":4},{"text":"single-vendor","id":"single-vendor","depth":3},{"text":"Behavior","id":"behavior-3","depth":4},{"text":"Config","id":"config-3","depth":4},{"text":"split-by-size","id":"split-by-size","depth":3},{"text":"Behavior","id":"behavior-4","depth":4},{"text":"Config","id":"config-4","depth":4},{"text":"Custom Splitting Strategy","id":"custom-splitting-strategy","depth":2},{"text":"Custom Group","id":"custom-group","depth":3},{"text":"Custom Webpack splitChunks Config","id":"custom-webpack-splitchunks-config","depth":3}],"domain":"","content":"#\n\nA great chunk splitting strategy is very important to improve the loading\nperformance of the application. It can make full use of the browser's caching\nmechanism to reduce the number of requests and improve the loading speed of the\napplication.\n\nA variety of chunk splitting strategies are built into Builder, which can meet\nthe needs of most applications. You can also customize the chunk splitting\nconfig according to your own business scenarios.\n\n\nSplitting Strategies#\n\n> The chunk splitting config of Builder is in performance.chunkSplit.\n\nBuilder supports the following chunk splitting strategies:\n\n * split-by-experience: an empirical splitting strategy, automatically splits\n   some commonly used npm packages into chunks of moderate size.\n * split-by-module: split by NPM package granularity, each NPM package\n   corresponds to a chunk.\n * split-by-size: automatically split according to module size.\n * all-in-one: bundle all codes into one chunk.\n * single-vendor: bundle all NPM packages into a single chunk.\n * custom: custom chunk splitting strategy.\n\n\nsplit-by-experience#\n\nBehavior#\n\nBuilder adopts the split-by-experience strategy by default, which is a strategy\nwe have developed from experience. Specifically, when the following npm packages\nare referenced in your project, they will automatically be split into separate\nchunks:\n\n * lib-polyfill.js: includes core-js, @babel/runtime, @swc/helpers.\n * lib-react.js: includes react, react-dom.\n * lib-router.js: includes react-router, react-router-dom, history,\n   @remix-run/router.\n * lib-lodash.js: includes lodash, lodash-es.\n * lib-antd.js: includes antd.\n * lib-arco.js: includes @arco-design/web-react.\n * lib-semi.js: includes @douyinfe/semi-ui.\n\nThis strategy groups commonly used packages and then splits them into separate\nchunks. Generally, the number of chunks is not large, which is suitable for most\napplications and is also our recommended strategy.\n\nTIP\nIf the above npm packages are not installed or used in the project, the\ncorresponding chunk will not be generated.\n\nConfig#\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-experience',\n    },\n  },\n};\n\n\n\nsplit-by-module#\n\nBehavior#\n\nSplit each NPM package into a Chunk.\n\nwarning\nThis strategy will split the node_modules in the most granular way, and at the\nsame time, under HTTP/2, multiplexing will speed up the loading time of\nresources.However, in non-HTTP/2 environments, it needs to be used with caution\nbecause of HTTP head-of-line blocking problem.\n\nConfig#\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-module',\n    },\n  },\n};\n\n\n\nall-in-one#\n\nBehavior#\n\nThis strategy puts business code and third-party dependencies in the same Chunk.\n\nConfig#\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'all-in-one',\n    },\n  },\n};\n\n\n\nsingle-vendor#\n\nBehavior#\n\nThis strategy puts third-party dependencies in one Chunk, and business code in\nanother Chunk.\n\nConfig#\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'single-vendor',\n    },\n  },\n};\n\n\n\nsplit-by-size#\n\nBehavior#\n\nUnder this strategy, after setting minSize, maxSize to a fixed value, Builder\nwill automatically split them without extra config.\n\nConfig#\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-size',\n      minSize: 30000,\n      maxSize: 50000,\n    },\n  },\n};\n\n\n\nCustom Splitting Strategy#\n\nIn addition to using the built-in strategies, you can also customize the\nsplitting strategy to meet more customization needs. Custom strategy is divided\ninto two parts:\n\n * Custom group\n * Custom webpack splitChunks config\n\nIt is worth noting that these two custom capabilities can be used together with\nthe built-in strategy, that is, you can use the built-in strategy to split\ncommonly used packages, and then use the custom function to split other\npackages.\n\n\nCustom Group#\n\nBuilder supports custom group, which is more flexible than the built-in\nstrategies, and simpler than writing webpack config.\n\nFor example, split the axios library under node_modules into axios.js:\n\nexport default {\n   performance: {\n     chunkSplit: {\n       strategy: 'split-by-experience',\n       forceSplitting: {\n         axios: /node_modules\\/axios/,\n       },\n     },\n   },\n};\n\n\nThrough forceSplitting config, you can easily split some packages into a Chunk.\n\n\nCustom Webpack splitChunks Config#\n\nIn addition to using custom grouping, you can also customize the native webpack\nconfig through override, such as:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-experience',\n      override: {\n        chunks: 'all',\n        minSize: 30000,\n      },\n    },\n  },\n};\n\n\nThe config in override will be merged with the webpack config. For specific\nconfig details, please refer to webpack official documentation.","frontmatter":{}},{"id":141,"title":"Quick Start","routePath":"/builder/en/guide/quick-start","lang":"en","toc":[{"text":"Environment preparation","id":"environment-preparation","depth":2},{"text":"Use the Modern.js Framework","id":"use-the-modern.js-framework","depth":2},{"text":"Use Builder in a Front-end Framework","id":"use-builder-in-a-front-end-framework","depth":2},{"text":"1. Install Builder","id":"1.-install-builder","depth":3},{"text":"2. Create Builder Instance","id":"2.-create-builder-instance","depth":3},{"text":"3. Call Builder Instance Method","id":"3.-call-builder-instance-method","depth":3},{"text":"Next Step","id":"next-step","depth":2}],"domain":"","content":"#\n\n\nEnvironment preparation#\n\nBefore getting started, you will need to install Node.js, and ensure that your\nNode.js version is higher than 14.17.6. We recommend using the LTS version of\nNode.js 16.\n\nYou can check the currently used Node.js version with the following command:\n\nnode -v\n# v16.19.1\n\n\nIf you do not have Node.js installed in your current environment, or the\ninstalled version is lower than 14.17.6, you can use nvm or fnm to install the\nrequired version.\n\nHere is an example of how to install the Node.js 16 LTS version via nvm:\n\n# Install the long-term support version of Node.js 16\nnvm install 16 --lts\n\n# Make the newly installed Node.js 16 as the default version\nnvm alias default 16\n\n# Switch to the newly installed Node.js 16\nnvm use 16\n\n\nnvm and fnm\nBoth nvm and fnm are Node.js version management tools. Relatively speaking, nvm\nis more mature and stable, while fnm is implemented using Rust, which provides\nbetter performance than nvm.\n\n\nUse the Modern.js Framework#\n\nThe Modern.js Framework uses Modern.js Builder as its build engine by default.\nIf you are a business developer, you do not need to manually install Builder,\njust create a Modern.js project and use all the features provided by Builder.\n\nnpx @modern-js/create my-app\n\n\nPlease refer to Modern.js - Introduction and Modern.js - Quick Start to learn\nhow to use Modern.js framework.\n\nAbout the documentation\nModern.js framework documentation and Modern.js Builder documentation are\ndeployed under two separate sites. If you encounter any build-related problems\nwhile using the Modern.js framework, you can always refer to the documentation\nof Modern.js Builder to find solutions.\n\n\nUse Builder in a Front-end Framework#\n\nIf you are developing a front-end framework, you can use Builder by following\nthese steps:\n\n\n1. Install Builder#\n\nYou need to install two packages:\n\n * @modern-js/builder is the core package of Builder and exports the core API.\n * @modern-js/builder-webpack-provider is a provider for Builder, providing\n   webpack-based building capabilities.\n\npnpm add @modern-js/builder @modern-js/builder-webpack-provider -D\n\n\n> When upgrading the version, please make sure that Builder and Provider you are\n> installing are the same version.\n\n\n2. Create Builder Instance#\n\nThere are two steps to creating a Builder instance:\n\nFirst you need to initialize the Builder Provider and pass in the builderConfig\nconfig object. Builder provides a lot of configs that allow you to customize the\nbuild behavior. At this point, you don't need to know the specific content of\nthe config, just pass in an empty object. You can find all available configs in\nAPI - config.\n\n\n\n\nconst provider = builderWebpackProvider({\n  builderConfig: {\n    // some configs\n  },\n});\n\n\nAfter getting the provider object, you can call the createBuilder method to\ncreate a Builder instance object:\n\nconst builder = await createBuilder(provider, {\n  entry: {\n    index: './src/index.ts',\n  },\n});\n\n\nExcept the entry option, the createBuilder method also provides some other\noptions, which you can learn more about in API - createBuilder.\n\n\n3. Call Builder Instance Method#\n\nThe Builder instance provides some methods, which you can use it according to\nthe usage scenarios.\n\nTo start local development, it is recommended to use the builder.startDevServer\nmethod, which will start a local Dev Server.\n\nawait builder.startDevServer();\n\n\nAfter successfully starting Dev Server, you can see the following logs:\n\ninfo    Starting dev server...\ninfo    Dev server running at:\n\n  > Local:    http://localhost:8081\n  > Network:  http://192.168.0.1:8081\n\n\nTo deploy the App to production environment, it is recommended to use the\nbuilder.build method, which will build the production outputs.\n\nawait builder.build();\n\n\n> For more introduction of Builder instance methods, please read the Builder\n> Instance chapter.\n\nAfter completing the above three steps, you have learned the basic usage of\nBuilder. Next, you can customize the build process through the Builder plugin\nand Builder configs.\n\n\nNext Step#\n\nYou may want:","frontmatter":{}},{"id":143,"title":"Introduce to Plugin","routePath":"/builder/en/plugins/introduction","lang":"en","toc":[{"text":"Write a plugin","id":"write-a-plugin","depth":2},{"text":"Lifetime Hooks","id":"lifetime-hooks","depth":2},{"text":"Use Builder Config","id":"use-builder-config","depth":2},{"text":"Modify webpack Config","id":"modify-webpack-config","depth":2},{"text":"Examples","id":"examples","depth":2},{"text":"Modify Loaders","id":"modify-loaders","depth":3},{"text":"Add Entry Points","id":"add-entry-points","depth":3},{"text":"Integrate webpack Plugins","id":"integrate-webpack-plugins","depth":3}],"domain":"","content":"#\n\nBuilder provides developers with a lightweight but powerful plugin system to\nbuild itself and any other plugins. Developing plugins to change the Builder's\nbehavior and introduce extra features. such as:\n\n * Modify config of bundlers.\n * Resolve and handle new file types.\n * Modify and compile file modules.\n * Deploy your application.\n\nBuilder can use webpack or Rspack as the bundler, expose unified Node.js API,\nand integrate into different frameworks. Users can painlessly switch between\nbundlers.\n\n\nWrite a plugin#\n\nPlugin module should export an entry function just like (options?:\nPluginOptions) => BuilderPlugin, It is recommended to name plugin functions\nbuilderPluginXXX.\n\n\n\nexport interface PluginFooOptions {\n  message?: string;\n}\n\nexport const builderPluginFoo = (\n  options?: PluginFooOptions,\n): BuilderPlugin => ({\n  name: 'plugin-foo',\n  setup(api) {\n    api.onExit(() => {\n      const msg = options.message || 'finish.';\n      console.log(msg);\n    });\n  },\n});\n\nbuilder.addPlugins([builderPluginFoo('some other message.')]);\n\n\nThe function usually takes an options object and returns the plugin instance,\nwhich manages state through closures.\n\nLet's look at each part:\n\n * name is used to label the plugin\n * setup as the main entry point of plugins\n * api provides context object, lifetime hooks and utils.\n\nThe package name of the plugin needs to contain the conventional builder-plugin\nprefix for identification, just like builder-plugin-foo,\n@scope/builder-plugin-bar, etc.\n\n\nLifetime Hooks#\n\nBuilder uses lifetime planning work internally, and plugins can also register\nhooks to take part in any stage of the workflow and implement their own\nfeatures.\n\nThe full list of Builder's lifetime hooks can be found in the API References.\n\nThe Builder does not take over the hooks of the underlying bundlers, whose\ndocuments can be found here: webpack hooks\n\n\nUse Builder Config#\n\nCustom plugins can usually get config from function parameters, just define and\nuse it at your pleasure.\n\nBut sometimes you may need to read and change the public config of the Builder.\nTo begin with, you should understand how the Builder generates and uses its\nconfig:\n\n * Read, parse config and merge with default values.\n * Plugins modify the config by api.modifyBuilderConfig(...).\n * Normalize the config and provide it to consume, then the config can no longer\n   be modified.\n\nRefer to this tiny example:\n\nexport const builderPluginUploadDist = (): BuilderPlugin => ({\n  name: 'plugin-upload-dist',\n  setup(api) {\n    api.modifyBuilderConfig(config => {\n      // try to disable minimize.\n      // should deal with optional value by self.\n      config.output ||= {};\n      config.output.disableMinimize = true;\n      // but also can be enable by other plugins...\n    });\n    api.onBeforeBuild(() => {\n      // use the normalized config.\n      const config = api.getNormalizedConfig();\n      if (!config.output.disableMinimize) {\n        // let it crash when enable minimize.\n        throw new Error(\n          'You must disable minimize to upload readable dist files.',\n        );\n      }\n    });\n    api.onAfterBuild(() => {\n      const config = api.getNormalizedConfig();\n      const distRoot = config.output.distPath.root;\n      // TODO: upload all files in `distRoot`.\n    });\n  },\n});\n\n\nThere are 3 ways to use Builder config:\n\n * register callback with api.modifyBuilderConfig(config => {}) to modify\n   config.\n * use api.getBuilderConfig() to get Builder config.\n * use api.getNormalizedConfig() to get finally normalized config.\n\nWhen normalized, it will again merge the config object with the default values\nand make sure the optional properties exist. So for PluginUploadDist, part of\nits type looks like:\n\napi.modifyBuilderConfig((config: BuilderConfig) => {});\napi.getBuilderConfig() as BuilderConfig;\ntype BuilderConfig = {\n  output?: {\n    disableMinimize?: boolean;\n    distPath?: { root?: string };\n  };\n};\n\napi.getNormalizedConfig() as NormalizedConfig;\ntype NormalizedConfig = {\n  output: {\n    disableMinimize: boolean;\n    distPath: { root: string };\n  };\n};\n\n\nThe return value type of getNormalizedConfig() is slightly different from that\nof BuilderConfig and is narrowed compared to the types described elsewhere in\nthe documentation. You don't need to fill in the defaults when you use it.\n\nTherefore, the best way to use configuration items is to\n\n * Modify the config with api.modifyBuilderConfig(config => {})\n * Read api.getNormalizedConfig() as the actual config used by the plugin in the\n   further lifetime.\n\n\nModify webpack Config#\n\nPlugins can handle webpack's config by:\n\n * use api.modifyWebpackChain(chain => {}) to modify webpack-chain.\n * use api.modifyWebpackConfig(config => {}) to modify raw webpack config.\n * use api.onAfterCreateCompiler(compiler => {}) to handle webpack instance\n   directly.\n\nWe recommend that you use neutrinojs/webpack-chain's chained api to handle the\nconfig of webpack whenever possible.\n\nBuilder integrated a webpack5-compatible version, which can be found in\nsorrycc/webpack-chain.\n\n\nExamples#\n\n\nModify Loaders#\n\nThe webpack loaders can be used to load and transform various file types. For\nmore information, see concepts and loaders.\n\n\n\nexport const builderPluginTypeScriptExt = (): BuilderPlugin => ({\n  name: 'builder-typescript-ext',\n  setup(api) {\n    api.modifyWebpackChain(async chain => {\n      // set ts-loader to recognize more files as typescript modules.\n      chain.module.rule(CHAIN_ID.RULE.TS).test(/\\.(ts|mts|cts|tsx|tss|tsm)$/);\n    });\n  },\n});\n\n\n\nAdd Entry Points#\n\n\n\nexport const builderPluginAdminPanel = (): BuilderPlugin => ({\n  name: 'builder-admin-panel',\n  setup(api) {\n    api.modifyWebpackChain(async chain => {\n      config.entry('admin-panel').add('src/admin/panel.js');\n    });\n  },\n});\n\n\n\nIntegrate webpack Plugins#\n\nIntegrate existing webpack plugins to migrate your applications:\n\n\n\n\nexport const builderPluginInspector = (options?: Options): BuilderPlugin => ({\n  name: 'builder-plugin-inspector',\n  setup(api) {\n    api.modifyWebpackChain(async chain => {\n      // load modules dynamically only when needed\n      // to avoid unnecessary performance cost.\n      const { InspectorWebpackPlugin } = await import(\n        '@modern-js/inspector-webpack-plugin'\n      );\n      // modify webpack-chain to setup webpack plugin.\n      chain\n        .plugin('inspector-webpack-plugin')\n        .use(InspectorWebpackPlugin, [inspectorOptions]);\n    });\n  },\n});\n","frontmatter":{}},{"id":144,"title":"Overview","routePath":"/builder/en/plugins/list","lang":"en","toc":[{"text":"Official Plugins","id":"official-plugins","depth":2}],"domain":"","content":"#\n\n\nOfficial Plugins#\n\n * @modern-js/builder-plugin-swc: Use SWC as the transformer and minimizer to\n   improve build performance.\n * @modern-js/builder-plugin-stylus: Use Stylus add CSS preprocessor.\n * @modern-js/builder-plugin-esbuild: Use esbuild as the transformer and\n   minimizer to improve build performance.\n * @modern-js/builder-plugin-node-polyfill: Inject Polyfills of Node core\n   modules in the browser side.\n * @modern-js/builder-plugin-image-compressCompress the image resources used in\n   the project.\n\nYou can find the source code of these plugins in modern.js/packages/builder\ndirectory.","frontmatter":{}},{"id":145,"title":"Esbuild Plugin","routePath":"/builder/en/plugins/plugin-esbuild","lang":"en","toc":[{"text":"Quick Start","id":"quick-start","depth":2},{"text":"Install","id":"install","depth":3},{"text":"Register","id":"register","depth":3},{"text":"Config","id":"config","depth":2},{"text":"loader","id":"loader","depth":3},{"text":"Set JSX Format","id":"set-jsx-format","depth":4},{"text":"Set the target environment","id":"set-the-target-environment","depth":4},{"text":"Disable transformation","id":"disable-transformation","depth":4},{"text":"minimize","id":"minimize","depth":3},{"text":"Set the target environment","id":"set-the-target-environment-1","depth":4},{"text":"Disable minification","id":"disable-minification","depth":4},{"text":"Limitations","id":"limitations","depth":2},{"text":"Compatibility","id":"compatibility","depth":3},{"text":"Not support Babel plugins","id":"not-support-babel-plugins","depth":3},{"text":"Bundle Size","id":"bundle-size","depth":3}],"domain":"","content":"#\n\nesbuild is a front-end build tool based on Golang. It has the functions of\nbundling, compiling and minimizing JavaScript code. Compared with traditional\ntools, the performance is significantly improved. When minimizing code, compared\nto webpack's built-in terser minimizer, esbuild has dozens of times better\nperformance.\n\nBuilder provides esbuild plugin that allow you to use esbuild instead of\nbabel-loader, ts-loader and terser for transformation and minification process.\nWhen you enable esbuild in a large project, it can greatly reduce the time\nrequired for code compilation and compression, while effectively avoiding OOM\n(heap out of memory) problems.\n\nRecommend using SWC\nWe recommend using SWC to transform and minify code rather than esbuild, because\nSWC supports more syntaxes, provides better code compression, and the compiled\ncode has better compatibility.\n\nTherefore, we recommend that you use SWC instead of esbuild, please refer to SWC\nPlugin for usage.\n\n\nQuick Start#\n\n\nInstall#\n\nYou can install the plugin with the following command:\n\n# npm\nnpm install @modern-js/builder-plugin-esbuild -D\n\n# yarn\nyarn add @modern-js/builder-plugin-esbuild -D\n\n# pnpm\npnpm add @modern-js/builder-plugin-esbuild -D\n\n\n\nRegister#\n\nIn upper-level frameworks such as Modern.js, you can register esbuild plugins\nthrough the builderPlugins config:\n\n\n\nexport default {\n  builderPlugins: [builderPluginEsbuild()],\n};\n\n\nIf you are using the Builder's Node API, you can register esbuild plugins\nthrough the addPlugins method:\n\n\n\n// add the plugin to the builder instance\nbuilder.addPlugins([builderPluginEsbuild()]);\n\n\n\nConfig#\n\nThe plugin will enable code transformation and minification by default. You can\nalso customize the behavior of the plugin through configuration.\n\n\nloader#\n\n * Type:\n\ntype LoaderOptions = EsbuildLoaderOptions | false | undefined;\n\n\n * Default:\n\nconst defaultOptions = {\n  target: 'es2015',\n  charset: builderConfig.output.charset,\n};\n\n\nThis config is used to enable JavaScript/TypeScript transformation, which will\nreplace babel-loader and ts-loader with esbuild-loader.\n\nIf you want to modify the options, you can check the esbuild-loader\ndocumentation.\n\nSet JSX Format#\n\nWhen using esbuild for transformation, esbuild will read the compilerOptions.jsx\nfield in tsconfig.json to determine which JSX syntax to use.\n\nTherefore, you need to set the correct JSX syntax in tsconfig.json.\n\nFor example, React projects need to set compilerOptions.jsx to react-jsx:\n\n{\n  \"compilerOptions\": {\n    \"jsx\": \"react-jsx\"\n  }\n}\n\n\nSet the target environment#\n\nUse the target option to set the target environment for transformation. target\ncan be set directly to the JavaScript language version, such as es6, es2020; it\ncan also be set to several target environments, each target environment is an\nenvironment name followed by a version number, such as ['chrome58', 'edge16'\n,'firefox57']. For a detailed introduction of the target option, please refer to\nesbuild - target.\n\ntarget supports setting to the following environments:\n\n * chrome\n * edge\n * firefox\n * ie\n * ios\n * node\n * opera\n * safari\n\nbuilderPluginEsbuild({\n  loader: {\n    target: 'chrome61',\n  },\n});\n\n\nDisable transformation#\n\nSet loader to false to disable esbuild transformation, and Builder will continue\nto use Babel to transform the code.\n\nbuilderPluginEsbuild({\n  loader: false,\n});\n\n\n\nminimize#\n\n * Type:\n\ntype MinimizeOptions = EsbuildMinifyOptions | false | undefined;\n\n\n * Default:\n\nconst defaultOptions = {\n  css: true,\n  target: 'es2015',\n};\n\n\nThis option is used to enable minification for JavaScript and CSS.\n\nIf you want to modify the options, you can check the esbuild-loader\ndocumentation.\n\nSet the target environment#\n\nUse the target option to set the target environment for minification.\n\nbuilderPluginEsbuild({\n  minimize: {\n    target: 'chrome61',\n  },\n});\n\n\nDisable minification#\n\nSet minimize to false to disable esbuild minification, and Builder will continue\nto use Terser to minify the code.\n\nbuilderPluginEsbuild({\n  minimize: false,\n});\n\n\n\nLimitations#\n\nAlthough esbuild can significantly improve the build performance of existing\nwebpack projects, it still has certain limitations that require special\nattention.\n\n\nCompatibility#\n\nAs a compiler (i.e. loader capability), esbuild usually supports at least ES2015\n(that is, ES6) syntax, and does not have the ability to automatically inject\nPolyfill.. If the production environment needs to downgrade to ES5 and below\nsyntax, it is recommended to use SWC compilation.\n\nYou can specify the target syntax version by following config:\n\nbuilderPluginEsbuild({\n  loader: {\n    target: 'es2015',\n  },\n});\n\n\nAs a code minify tool (i.e. minimize capability), esbuild can minify the code in\nproduction environment, and usually supports ES2015 syntax at least.\n\nIf you set the compressed target to es5, you need to ensure that all codes have\nbeen compiled to ES5 codes, otherwise it will cause esbuild compilation error:\nTransforming 'xxx' to the configured target environment (\"es5\") is not supported\nyet .\n\nTherefore, for projects that need to be compatible with ES5 and below syntax in\nthe production environment, please be careful to enable the minimize capability,\nand it is recommended to use SWC compression.\n\nYou can specify the target syntax version by following config:\n\nbuilderPluginEsbuild({\n  minimize: {\n    target: 'es2015',\n  },\n});\n\n\nCaution\nProjects that need to be compatible with ES5 and below syntax in the production\nenvironment need to be careful to turn on the minimize config.\n\n\nNot support Babel plugins#\n\nAs a compiler, the syntax transformation function of the original Babel plugins\nsuch as babel-plugin-import is not available after esbuild is turned on. And\nsince the bottom layer of the plugin uses esbuild's Transform API, it does not\nsupport esbuild plugins to customize the compilation process.\n\nIf you have requirements related to Babel plugins such as babel-plugin-import,\nyou can use the SWC plugin.\n\n\nBundle Size#\n\nAlthough the compression speed of esbuild is faster, the compression ratio of\nesbuild is lower than that of terser, so the bundle size will increase, please\nuse it according to the scenes. Generally speaking, esbuild is more suitable for\nscenes that are not sensitive to bundle size.\n\nYou can refer to minification-benchmarks for a detailed comparison between\nminimizers.","frontmatter":{}},{"id":146,"title":"Image Compress Plugin","routePath":"/builder/en/plugins/plugin-image-compress","lang":"en","toc":[{"text":"Quick Start","id":"quick-start","depth":2},{"text":"Install","id":"install","depth":3},{"text":"Register","id":"register","depth":3},{"text":"Config","id":"config","depth":2}],"domain":"","content":"#\n\nWith the image compression plugin, image resources used in the project can be\ncompressed to reduce the size of the product without affecting the visual\nappearance of the image.\n\n\nQuick Start#\n\nTIP\nWhen using Rspack as the bundler, the Image Compress plugin is not currently\nsupported.\n\n\nInstall#\n\nYou can install the plugin with the following command:\n\n# npm\nnpm install @modern-js/builder-plugin-image-compress -D\n\n# yarn\nyarn add @modern-js/builder-plugin-image-compress -D\n\n# pnpm\npnpm add @modern-js/builder-plugin-image-compress -D\n\n\n\nRegister#\n\nIn upper-level frameworks such as Modern.js, you can register image compress\nplugins through the builderPlugins config:\n\n\n\nexport default {\n  builderPlugins: [builderPluginImageCompress()],\n};\n\n\nIf you are using the Builder's Node API, you can register image compress plugins\nthrough the addPlugins method:\n\n\n\n// add the plugin to the builder instance\nbuilder.addPlugins([builderPluginImageCompress()]);\n\n\n\nConfig#\n\nThe plugin accepts an array of compressor configuration items, each of which can\nbe either a string or an object. The string can be the name of a built-in\ncompressor and its default configuration enabled. Or use the object format\nconfiguration and specify the compressor in the use field. The remaining fields\nof the object will be used as compressor configuration items.\n\nBy default, the plugin will enable jpeg, png, ico image compressors, which are\nequivalent to the following two examples:\n\nbuilderPluginImageCompress(['jpeg', 'png', 'ico']);\n\n\nbuilderPluginImageCompress([{ use: 'jpeg' }, { use: 'png' }, { use: 'ico' }]);\n\n\nThe default configuration can be overridden by specifying a configuration item.\nFor example, to allow the jpeg compressor to recognize new extension name and to\nset the quality of the png compressor.\n\nbuilderPluginImageCompress([\n  { use: 'jpeg', test: /\\.(jpg|jpeg|jpe)$/ },\n  { use: 'png', minQuality: 50 },\n  'ico',\n]);\n\n\nThe default png compressor is lossy. If you want to replace it with a lossless\ncompressor, you can use the following configuration.\n\nbuilderPluginImageCompress(['jpeg', 'pngLossless', 'ico']);\n\n\nThe list of configuration items will eventually be converted to the\ncorresponding bundler loader configuration, so compressors follow the same\nbottom-to-top matching rule.\n\nFor example, the png compressor will take precedence over the pngLossless\ncompressor for the following configuration:\n\nbuilderPluginImageCompress(['jpeg', 'pngLossless', 'ico', 'png']);\n\n\nFor more information on compressors, please visit @napi-rs/image.","frontmatter":{}},{"id":147,"title":"Node Polyfill Plugin","routePath":"/builder/en/plugins/plugin-node-polyfill","lang":"en","toc":[{"text":"Quick Start","id":"quick-start","depth":2},{"text":"Install","id":"install","depth":3},{"text":"Register","id":"register","depth":3},{"text":"Node Polyfills","id":"node-polyfills","depth":2},{"text":"Globals","id":"globals","depth":3},{"text":"Modules","id":"modules","depth":3},{"text":"Fallbacks","id":"fallbacks","depth":3}],"domain":"","content":"#\n\nAbout Node Polyfill\nNormally, we don't need to use Node libs on the browser side. However, it is\npossible to use some Node libs when the code will run on both the Node side and\nthe browser side, and Node Polyfill provides browser versions of polyfills for\nthese Node libs.\n\nBy using the Node Polyfill plugin, Node core libs polyfills are automatically\ninjected into the browser-side, allowing you to use these modules on the browser\nside with confidence.\n\n\nQuick Start#\n\n\nInstall#\n\nYou can install the plugin with the following command:\n\n# npm\nnpm install @modern-js/builder-plugin-node-polyfill -D\n\n# yarn\nyarn add @modern-js/builder-plugin-node-polyfill -D\n\n# pnpm\npnpm add @modern-js/builder-plugin-node-polyfill -D\n\n\n\nRegister#\n\nIn upper-level frameworks such as Modern.js, you can register node polyfill\nplugins through the builderPlugins config:\n\n\n\nexport default {\n  builderPlugins: [builderPluginNodePolyfill()],\n};\n\n\nIf you are using the Builder's Node API, you can register node polyfill plugins\nthrough the addPlugins method:\n\n\n\n// add the plugin to the builder instance\nbuilder.addPlugins([builderPluginNodePolyfill()]);\n\n\n\nNode Polyfills#\n\n\nGlobals#\n\n * Buffer\n * process\n\nWhen the above global variables are used directly in code, the corresponding\npolyfill will be injected.\n\nconst bufferData = Buffer.from('xxxx');\n\n\n\nModules#\n\n * assert\n * buffer\n * console\n * constants\n * crypto\n * domain\n * events\n * http\n * https\n * os\n * path\n * punycode\n * process\n * querystring\n * stream\n * _stream_duplex\n * _stream_passthrough\n * _stream_readable\n * _stream_transform\n * _stream_writable\n * string_decoder\n * sys\n * timers\n * tty\n * url\n * util\n * vm\n * zlib\n\nWhen the above module is referenced in code via import / require syntax, the\ncorresponding polyfill will be injected.\n\n\n\nconst bufferData = Buffer.from('xxxx');\n\n\n\nFallbacks#\n\n * child_process\n * cluster\n * dgram\n * dns\n * fs\n * module\n * net\n * readline\n * repl\n * tls\n\nCurrently there is no polyfill for the above modules on the browser side, so\nwhen you import the above modules, it will automatically fallback to an empty\nobject.\n\n\n\nconsole.log(fs); // -> {}\n","frontmatter":{}},{"id":148,"title":"Stylus Plugin","routePath":"/builder/en/plugins/plugin-stylus","lang":"en","toc":[{"text":"Quick Start","id":"quick-start","depth":2},{"text":"Install","id":"install","depth":3},{"text":"Register","id":"register","depth":3},{"text":"Example","id":"example","depth":2},{"text":"Config","id":"config","depth":2},{"text":"stylusOptions","id":"stylusoptions","depth":3},{"text":"sourceMap","id":"sourcemap","depth":3}],"domain":"","content":"#\n\nStylus is an Expressive, dynamic and robust CSS preprocessor. This chapter\nintroduces how to use Stylus in Builder.\n\n\nQuick Start#\n\nTIP\nWhen using Rspack as the bundler, the Stylus plugin is not currently supported.\n\n\nInstall#\n\nYou can install the plugin with the following command:\n\n# npm\nnpm install @modern-js/builder-plugin-stylus -D\n\n#yarn\nyarn add @modern-js/builder-plugin-stylus -D\n\n#pnpm\npnpm install @modern-js/builder-plugin-stylus -D\n\n\n\nRegister#\n\nIn upper-level frameworks such as Modern.js, you can register Stylus plugins\nthrough the builderPlugins config:\n\n\n\nexport default {\n  builderPlugins: [builderPluginStylus()],\n};\n\n\nWhen you call the Builder's Node API directly, you can register Stylus plugins\nwith the addPlugins method:\n\n\n\n// add the plugin to the builder instance\nbuilder.addPlugins([builderPluginStylus()]);\n\n\n\nExample#\n\nAfter installing the plugin, you can directly import *.styl or *.module.styl\nfiles into the code without adding other configs.\n\n * normalize.styl:\n\nthe body\n   color#000\n   font 14px Arial, sans-serif\n\n\n * title.module.styl:\n\n.title\n   font-size: 14px;\n\n\n * index.js:\n\nimport './normalize.styl';\n\n\nconsole.log(style.title);\n\n\n\nConfig#\n\nIf you need to customize the compilation behavior of Stylus, you can use the\nfollowing configs.\n\n\nstylusOptions#\n\n-Type:\n\ntype StylusOptions = {\n  use?: string[];\n  include?: string;\n  import?: string;\n  resolveURL?: boolean;\n  lineNumbers?: boolean;\n  hoistAtrules?: boolean;\n};\n\n\n * Default: undefined\n\nOptions passed to Stylus, please refer to the Stylus documentation for specific\nusage.\n\nbuilderPluginStylus({\n  stylusOptions: {\n    lineNumbers: false,\n  },\n});\n\n\n\nsourceMap#\n\n * Type: boolean\n * Default: isDev\n\nWhether to generate Source Map, enabled by default in the development\nenvironment.\n\nbuilderPluginStylus({\n  sourceMap: false,\n});\n","frontmatter":{}},{"id":149,"title":"SWC Plugin","routePath":"/builder/en/plugins/plugin-swc","lang":"en","toc":[{"text":"Quick Start","id":"quick-start","depth":2},{"text":"Install","id":"install","depth":3},{"text":"Register","id":"register","depth":3},{"text":"Config","id":"config","depth":2},{"text":"presetReact","id":"presetreact","depth":3},{"text":"presetEnv","id":"presetenv","depth":3},{"text":"jsMinify","id":"jsminify","depth":3},{"text":"cssMinify","id":"cssminify","depth":3},{"text":"extensions","id":"extensions","depth":3},{"text":"extensions.reactUtils","id":"extensions.reactutils","depth":4},{"text":"extensions.lodash","id":"extensions.lodash","depth":4},{"text":"extensions.styledComponent","id":"extensions.styledcomponent","depth":4},{"text":"extensions.emotion","id":"extensions.emotion","depth":4},{"text":"extensions.pluginImport","id":"extensions.pluginimport","depth":4},{"text":"Limitation","id":"limitation","depth":2}],"domain":"","content":"#\n\nSWC (Speedy Web Compiler) is a transformer and minimizer for JavaScript and\nTypeScript based on Rust. SWC can provide the same abilities with Babel, and\nit's more than 10x faster than Babel.\n\nModern.js Builder has a out-of-box plugin for SWC, power your Web application\nwith Polyfill and minification, we also port some common used Babel plugins to\nSWC.\n\n\nQuick Start#\n\nTIP\nWhen using Rspack as the bundler, SWC will be used for transpiling and\ncompression by default, so you don't need to install or configure the SWC\nplugin.\n\n\nInstall#\n\nYou can install the plugin with the following command:\n\n# npm\nnpm install @modern-js/builder-plugin-swc -D\n\n# yarn\nyarn add @modern-js/builder-plugin-swc -D\n\n# pnpm\npnpm add @modern-js/builder-plugin-swc -D\n\n\n\nRegister#\n\nIn upper-level frameworks such as Modern.js, you can register SWC plugin through\nthe builderPlugins config:\n\n\n\nexport default {\n  builderPlugins: [builderPluginSwc()],\n};\n\n\nIf you are using the Builder's Node API, you can register SWC plugin through the\naddPlugins method:\n\n\n\n// add the plugin to the builder instance\nbuilder.addPlugins([builderPluginSwc()]);\n\n\nThat's it !\n\nNow you can use SWC transformation and minification in your project.\n\n\nConfig#\n\n * Type:\n\ntype PluginConfig = {\n  presetReact?: ReactConfig;\n  presetEnv?: EnvConfig;\n  jsMinify?: boolean | JsMinifyOptions;\n  cssMinify?: boolean | CssMinifyOptions;\n  extensions?: Extensions;\n};\n\n\n\npresetReact#\n\n * Type: presetReact in SWC.\n\nPorted from @babel/preset-react. The value you passed will be merged with\ndefault option.\n\nBy default, the plugin will set runtime field based on your react version, if\nreact version is newer than 17.0.0, it will be set to automatic, otherwish\nclassic.\n\n\npresetEnv#\n\n * Type: presetEnv in SWC.\n\nPorted from @babel/preset-env. The value you passed will be merged with default\noption.\n\nDefault option is:\n\n{\n  targets: '', // automatic get browserslist from your project, so you don't have to set this field\n  mode: 'usage',\n}\n\n\n\njsMinify#\n\n * Type: boolean or compress configuration.\n * Default: { compress: {}, mangle: true }.\n\nIf set it to false, then SWC minification will be disabled, if set it to true\nthen will it applies default option. If you pass an object, then this object\nwill be merged with default option.\n\n\ncssMinify#\n\n * Type:: boolean\n * Default:: true\n\nWhether enable to compress CSS files by SWC. If enabled, it will improve the\nperformance of CSS compression, but the compression ratio will be slightly\nreduced.\n\n\nextensions#\n\n * Type: Object\n\nSome plugins ported from Babel.\n\nextensions.reactUtils#\n\n * Type: Object\n\ntype ReactUtilsOptions = {\n  autoImportReact?: boolean;\n  removeEffect?: boolean;\n  removePropTypes?: {\n    mode?: 'remove' | 'unwrap' | 'unsafe-wrap';\n    removeImport?: boolean;\n    ignoreFilenames?: string[];\n    additionalLibraries?: string[];\n    classNameMatchers?: string[];\n  };\n};\n\n\nSome little help utils for React.\n\nreactUtils.autoImportReact\n\n * Type: boolean\n\nAutomatically . Mostly used for generated React.createElement`.\n\nreactUtils.removeEffect\n\n * Type: boolean\n\nRemove useEffect call.\n\nreactUtils.removePropTypes\n\n * Type:\n\ntype RemovePropTypesOptions = {\n  mode?: 'remove' | 'unwrap' | 'unsafe-wrap';\n  removeImport?: boolean;\n  ignoreFilenames?: string[];\n  additionalLibraries?: string[];\n  classNameMatchers?: string[];\n};\n\n\nRemove React runtime type checking. This is ported from\n@babel/plugin-react-transform-remove-prop-types, All the configurations remain\nthe same.\n\nextensions.lodash#\n\n * Type: { cwd?: string; ids?: string;}\n * Default: { cwd: process.cwd(), ids: [] }\n\nPorted from @babel/plugin-lodash.\n\nextensions.styledComponent#\n\n * Type:\n\nboolean | {\n  // Enabled by default in development, disabled in production to reduce file size,\n  // setting this will override the default for all environments.\n  displayName?: boolean,\n  // Enabled by default.\n  ssr?: boolean,\n  // Enabled by default.\n  fileName?: boolean,\n  // Empty by default.\n  topLevelImportPaths?: string[],\n  // Defaults to [\"index\"].\n  meaninglessFileNames?: string[],\n  // Enabled by default.\n  cssProp?: boolean,\n  // Empty by default.\n  namespace?: string,\n};\n\n\nThis is ported by Next.js team from styled-component\n\nextensions.emotion#\n\n * Type:\n\nboolean | {\n  // default is true. It will be disabled when build type is production.\n  sourceMap?: boolean,\n  // default is 'dev-only'.\n  autoLabel?: 'never' | 'dev-only' | 'always',\n  // default is '[local]'.\n  // Allowed values: `[local]` `[filename]` and `[dirname]`\n  // This option only works when autoLabel is set to 'dev-only' or 'always'.\n  // It allows you to define the format of the resulting label.\n  // The format is defined via string where variable parts are enclosed in square brackets [].\n  // For example labelFormat: \"my-classname--[local]\", where [local] will be replaced with the name of the variable the result is assigned to.\n  labelFormat?: string,\n  // default is undefined.\n  // This option allows you to tell the compiler what imports it should\n  // look at to determine what it should transform so if you re-export\n  // Emotion's exports, you can still use transforms.\n  importMap?: {\n    [packageName: string]: {\n      [exportName: string]: {\n        canonicalImport?: [string, string],\n        styledBaseImport?: [string, string],\n      }\n    }\n  },\n}\n\n\nThis is ported by Next.js team from @emotion/babel-plugin\n\nextensions.pluginImport#\n\nTIP\nBuilder provides the source.transformImport config, so you don't need to\nconfigure extensions.pluginImport manually.\n\nPorted from babel-plugin-import, configurations are the same.\n\nSome configurations can be passed in functions, such as customName,\ncustomStyleName. These JavaScript functions will be called by Rust through\nNode-API, which will cause some performance overhead.\n\nSome simple function logic can be replaced by template language. Therefore, the\nconfiguration of function items such as customName, customStyleName can also be\npassed in strings as templates to replace functions and improve performance.\n\nFor example:\n\n\n\n\nApply following configurations:\n\nPluginSWC({\n  extensions: {\n    pluginImport: [\n      {\n        libraryName: 'foo',\n        customName: 'foo/es/{{ member }}',\n      },\n    ],\n  },\n});\n\n\n{{ member }} will be replaced by the imported specifier:\n\n\n\n\nTemplate customName: 'foo/es/{{ member }}' is the same as customName: (member)\n=> `foo/es/${member}` , but template value has no performance overhead of\nNode-API.\n\nThe template used here is handlebars. There are some useful builtin tools, Take\nthe above import statement as an example:\n\nPluginSWC({\n  extensions: {\n    pluginImport: [\n      {\n        libraryName: 'foo',\n        customName: 'foo/es/{{ kebabCase member }}',\n      },\n    ],\n  },\n});\n\n\nTransformed to:\n\n\n\n\nIn addition to kebabCase, there are cameraCase, snakeCase, upperCase and\nlowerCase can be used as well.\n\n\nLimitation#\n\nDo not support @babel/plugin-transform-runtime and other custom Babel plugins.","frontmatter":{}},{"id":166,"title":"Builder Core","routePath":"/builder/api/builder-core","lang":"zh","toc":[{"text":"createBuilder","id":"createbuilder","depth":2},{"text":"builderWebpackProvider","id":"builderwebpackprovider","depth":3},{"text":"builderRspackProvider","id":"builderrspackprovider","depth":3},{"text":"options","id":"options","depth":3},{"text":"mergeBuilderConfig","id":"mergebuilderconfig","depth":2},{"text":"webpack","id":"webpack","depth":2},{"text":"HtmlWebpackPlugin","id":"htmlwebpackplugin","depth":2}],"domain":"","content":"#\n\n Builder \n\n\ncreateBuilder#\n\n Builder \n\n @modern-js/builder-webpack-provider \n@modern-js/builder-rspack-provider Provider  bundler \n\n\nbuilderWebpackProvider#\n\n builderWebpackProvider Builder  webpack  bundler \n\n\n\n\nconst provider = builderWebpackProvider({\n  builderConfig: {\n    // some configs\n  },\n});\n\nconst builder = await createBuilder(provider, {\n  // some options\n});\n\n\n\nbuilderRspackProvider#\n\n builderRspackProvider Builder  Rspack  bundler \n\n\n\n\nconst provider = builderRspackProvider({\n  builderConfig: {\n    // some configs\n  },\n});\n\nconst builder = await createBuilder(provider, {\n  // some options\n});\n\n\n\noptions#\n\ncreateBuilder \n\ntype BuilderEntry = Record;\n\ntype BuilderTarget = 'web' | 'node' | 'modern-web' | 'web-worker';\n\ntype CreateBuilderOptions = {\n  cwd?: string;\n  entry?: BuilderEntry;\n  target?: BuilderTarget | BuilderTarget[];\n  framework?: string;\n  configPath?: string | null;\n};\n\n\n\n\n * cwd:  process.cwd()\n * entry: \n * target:  ['web']  \n * framework:  'modern.js'\n * configPath: \n\n\nmergeBuilderConfig#\n\n Builder \n\n * \n\nfunction mergeBuilderConfig(...configs: BuilderConfig[]): BuilderConfig;\n\n\n * Example\n\n\n\nconst config1 = {\n  dev: {\n    https: false,\n  },\n};\nconst config2 = {\n  dev: {\n    https: true,\n  },\n};\n\nconst mergedConfig = mergeBuilderConfig(config1, config2);\n\nconsole.log(mergedConfig); // { dev: { https: true } }\n\n\n>  config \n\n\nwebpack#\n\nwebpack  webpack \n\n * Example\n\n\n\nnew webpack.DefinePlugin();\n\n\n>  Builder  webpack  \"webpack\" \n\n\nHtmlWebpackPlugin#\n\nHtmlWebpackPlugin  HtmlWebpackPlugin \n\n * Example\n\n\n\n\n>  Builder  HtmlWebpackPlugin  \"html-webpack-plugin\"\n> ","frontmatter":{"extractApiHeaders":[2]}},{"id":167,"title":"Builder Instance","routePath":"/builder/api/builder-instance","lang":"zh","toc":[{"text":"builder.context","id":"builder.context","depth":2},{"text":"builder.context.entry","id":"builder.context.entry","depth":3},{"text":"builder.context.target","id":"builder.context.target","depth":3},{"text":"builder.context.rootPath","id":"builder.context.rootpath","depth":3},{"text":"builder.context.srcPath","id":"builder.context.srcpath","depth":3},{"text":"builder.context.distPath","id":"builder.context.distpath","depth":3},{"text":"builder.context.cachePath","id":"builder.context.cachepath","depth":3},{"text":"builder.context.configPath","id":"builder.context.configpath","depth":3},{"text":"builder.context.tsconfigPath","id":"builder.context.tsconfigpath","depth":3},{"text":"builder.context.framework","id":"builder.context.framework","depth":3},{"text":"builder.context.devServer","id":"builder.context.devserver","depth":3},{"text":"builder.context.bundlerType","id":"builder.context.bundlertype","depth":3},{"text":"builder.build","id":"builder.build","depth":2},{"text":"","id":"","depth":3},{"text":"","id":"","depth":3},{"text":" Compiler","id":"-compiler","depth":3},{"text":"builder.startDevServer","id":"builder.startdevserver","depth":2},{"text":" URL ","id":"-url-","depth":3},{"text":"","id":"","depth":3},{"text":" Compiler","id":"-compiler-1","depth":3},{"text":"builder.createCompiler","id":"builder.createcompiler","depth":2},{"text":"builder.addPlugins","id":"builder.addplugins","depth":2},{"text":"builder.removePlugins","id":"builder.removeplugins","depth":2},{"text":"builder.isPluginExists","id":"builder.ispluginexists","depth":2},{"text":"builder.inspectConfig","id":"builder.inspectconfig","depth":2},{"text":"builder.onBeforeCreateCompiler","id":"builder.onbeforecreatecompiler","depth":2},{"text":"builder.onAfterCreateCompiler","id":"builder.onaftercreatecompiler","depth":2},{"text":"builder.onBeforeBuild","id":"builder.onbeforebuild","depth":2},{"text":"builder.onAfterBuild","id":"builder.onafterbuild","depth":2},{"text":"builder.onBeforeStartDevServer","id":"builder.onbeforestartdevserver","depth":2},{"text":"builder.onAfterStartDevServer","id":"builder.onafterstartdevserver","depth":2},{"text":"builder.onDevCompileDone","id":"builder.ondevcompiledone","depth":2},{"text":"builder.onExit","id":"builder.onexit","depth":2},{"text":"builder.getBuilderConfig","id":"builder.getbuilderconfig","depth":2},{"text":"builder.getNormalizedConfig","id":"builder.getnormalizedconfig","depth":2},{"text":"builder.getHTMLPaths","id":"builder.gethtmlpaths","depth":2}],"domain":"","content":"#\n\n Builder \n\n\nbuilder.context#\n\nbuilder.context \n\n\nbuilder.context.entry#\n\n createBuilder  entry \n\n * \n\ntype BuilderEntry = Record;\n\n\n\nbuilder.context.target#\n\n createBuilder  target \n\n * \n\ntype BuilderTarget = 'web' | 'node' | 'modern-web' | 'web-worker';\n\ntype Context = {\n  target: BuilderTarget | BuilderTarget[];\n};\n\n\n\nbuilder.context.rootPath#\n\n createBuilder  cwd \n\n * \n\ntype RootPath = string;\n\n\n\nbuilder.context.srcPath#\n\nsrc \n\n * \n\ntype SrcPath = string;\n\n\n\nbuilder.context.distPath#\n\n BuilderConfig  output.distPath.root \n\n * \n\ntype DistPath = string;\n\n\n\nbuilder.context.cachePath#\n\n\n\n * \n\ntype CachePath = string;\n\n\n\nbuilder.context.configPath#\n\n createBuilder  configPath \n\n * \n\ntype ConfigPath = string | undefined;\n\n\n\nbuilder.context.tsconfigPath#\n\ntsconfig.json  tsconfig.json  undefined\n\n * \n\ntype TsconfigPath = string | undefined;\n\n\n\nbuilder.context.framework#\n\n 'modern.js'\n\n * \n\ntype Framework = string | undefined;\n\n\n\nbuilder.context.devServer#\n\nDev Server  Dev Server  hostname \n\n * \n\ntype DevServer = {\n  hostname: string;\n  port: number;\n};\n\n\n\nbuilder.context.bundlerType#\n\n\n\n * \n\ntype bundlerType = 'webpack' | 'rspack';\n\n\n\nbuilder.build#\n\n build \n\n * \n\ntype BuildOptions = {\n  mode?: 'development' | 'production';\n  watch?: boolean;\n  //  Compiler \n  compiler?: Compiler | MultiCompiler;\n};\n\nfunction Build(options?: BuildOptions): Promise;\n\n\n * Example\n\nawait builder.build();\n\n\n\n#\n\n mode  'development'\n\nawait builder.build({\n  mode: 'development',\n});\n\n\n\n#\n\n watch  true\n\nawait builder.build({\n  watch: true,\n});\n\n\n\n Compiler#\n\n compiler\n\nconst compiler = webpack({\n  // ...\n});\nawait builder.build({\n  compiler,\n});\n\n\n\nbuilder.startDevServer#\n\n Dev Server Modern.js Dev Server \n\n * \n\ntype StartDevServerOptions = {\n  //  URL  true\n  printURLs?: boolean | Function;\n  //  false\n  strictPort?: boolean;\n  //  Compiler \n  compiler?: Compiler | MultiCompiler;\n  //  dev server \n  serverOptions?: Partial;\n};\n\ntype StartDevServerResult = {\n  urls: string[];\n  port: number;\n  server: Server;\n};\n\nfunction StartDevServer(\n  options?: StartDevServerOptions,\n): Promise;\n\n\n * Example\n\n Dev Server\n\nawait builder.startDevServer();\n\n\n Dev Server \n\ninfo    Starting dev server...\ninfo    Dev server running at:\n\n  > Local:    http://localhost:8080\n  > Network:  http://192.168.0.1:8080\n\n\nstartDevServer \n\n * urls Dev Server  URLs\n * port \n * serverServer \n\nconst { urls, port, server } = await builder.startDevServer();\nconsole.log(urls); // ['http://localhost:8080', 'http://192.168.0.1:8080']\nconsole.log(port); // 8080\n\n//  Dev Server\nawait server.close();\n\n\n\n URL #\n\n printURLs  false  URL \n\nawait builder.startDevServer({\n  printURLs: false,\n});\n\n\n printURLs  URL URL \n\nawait builder.startDevServer({\n  printURLs: urls => {\n    return urls.map(({ label, url }) => ({\n      label,\n      url: `${url}/path`,\n    }));\n  },\n});\n\n\n\n#\n\nBuilder \n\n strictPort  true\n\nawait builder.startDevServer({\n  strictPort: true,\n});\n\n\n\n Compiler#\n\n compiler\n\nconst compiler = webpack({\n  // ...\n});\nawait builder.startDevServer({\n  compiler,\n});\n\n\n\nbuilder.createCompiler#\n\n compiler \n\n createBuilder  target  Compiler target \nMultiCompiler\n\n * \n\nfunction CreateCompiler(): Promise;\n\n\n * Example\n\nconst compiler = await builder.createCompiler();\n\n\n>  API Dev Server \n\n\nbuilder.addPlugins#\n\n builder \n\n\n\n * \n\ntype AddPluginsOptions = { before?: string } | { after?: string };\n\nfunction AddPlugins(\n  plugins: BuilderPlugins[],\n  options?: AddPluginsOptions,\n): Promise;\n\n\n * Example\n\nbuilder.addPlugins([builderPluginFoo(), builderPluginBar()]);\n\n//  bar \nbuilder.addPlugins([builderPluginFoo()], { before: 'bar' });\n\n//  bar \nbuilder.addPlugins([builderPluginFoo()], { after: 'bar' });\n\n\n\nbuilder.removePlugins#\n\n builder \n\n\n\n * \n\nfunction RemovePlugins(pluginNames: string[]): void;\n\n\n * Example\n\n// \nconst pluginFoo = builderPluginFoo();\nbuilder.addPlugins(pluginFoo);\n\n// \nbuilder.removePlugins([pluginFoo.name]);\n\n\n\nbuilder.isPluginExists#\n\n\n\n * \n\nfunction IsPluginExists(pluginName: string): boolean;\n\n\n * Example\n\nbuilder.addPlugins([builderPluginFoo()]);\n\nbuilder.isPluginExists(builderPluginFoo().name); // true\n\n\n\nbuilder.inspectConfig#\n\n Builder  builder  bundler \n\n * \n\ntype InspectConfigOptions = {\n  //  \"development\" \"production\"\n  env?: BuilderMode;\n  //  `false`\n  verbose?: boolean;\n  //  `output.distPath.root` \n  outputPath?: string;\n  //  `false`\n  writeToDisk?: boolean;\n};\n\nasync function InspectConfig(options?: InspectConfigOptions): Promise<{\n  builderConfig: string;\n  bundlerConfigs: string[];\n  origin: {\n    builderConfig: BuilderConfig;\n    bundlerConfigs: BundlerConfigs[];\n  };\n}>;\n\n\n * Example\n\n Config \n\nconst { builderConfig, bundlerConfigs } = await builder.inspectConfig();\n\nconsole.log(builderConfig, bundlerConfigs);\n\n\n\n\nawait builder.inspectConfig({\n  writeToDisk: true,\n});\n\n\n\nbuilder.onBeforeCreateCompiler#\n\n compiler  builder.startDevServerbuilder.build \nbuilder.createCompiler  bundlerConfigs \n\n * \n\nfunction OnBeforeCreateCompiler(\n  callback: (params: {\n    bundlerConfigs: WebpackConfig[] | RspackConfig[];\n  }) => Promise | void,\n): void;\n\n\n * Example\n\nbuilder.onBeforeCreateCompiler(({ bundlerConfigs }) => {\n  console.log('the bundler config is ', bundlerConfigs);\n});\n\n\n\nbuilder.onAfterCreateCompiler#\n\n compiler  builder.startDevServerbuilder.build \nbuilder.createCompiler  compiler  compiler \n\n * \n\nfunction OnAfterCreateCompiler(callback: (params: {\n  compiler: Compiler | MultiCompiler;\n}) => Promise | void;): void;\n\n\n * Example\n\nbuilder.onAfterCreateCompiler(({ compiler }) => {\n  console.log('the compiler is ', compiler);\n});\n\n\n\nbuilder.onBeforeBuild#\n\n bundlerConfigs \n\n * \n\nfunction OnBeforeBuild(\n  callback: (params: {\n    bundlerConfigs?: WebpackConfig[] | RspackConfig[];\n  }) => Promise | void,\n): void;\n\n\n * Example\n\nbuilder.onBeforeBuild(({ bundlerConfigs }) => {\n  console.log('the bundler config is ', bundlerConfigs);\n});\n\n\n\nbuilder.onAfterBuild#\n\n stats \n\n * \n\nfunction OnAfterBuild(\n  callback: (params: { stats?: Stats | MultiStats }) => Promise | void,\n): void;\n\n\n * Example\n\nbuilder.onAfterBuild(({ stats }) => {\n  console.log(stats?.toJson());\n});\n\n\n\nbuilder.onBeforeStartDevServer#\n\n\n\n * \n\nfunction OnBeforeStartDevServer(callback: () => Promise | void): void;\n\n\n * Example\n\nbuilder.onBeforeStartDevServer(() => {\n  console.log('before start!');\n});\n\n\n\nbuilder.onAfterStartDevServer#\n\n port \n\n * \n\nfunction OnAfterStartDevServer(\n  callback: (params: { port: number }) => Promise | void,\n): void;\n\n\n * Example\n\nbuilder.onAfterStartDevServer(({ port }) => {\n  console.log('this port is: ', port);\n});\n\n\n\nbuilder.onDevCompileDone#\n\n isFirstCompile \n\n * \n\nfunction OnDevCompileDone(\n  callback: (params: { isFirstCompile: boolean }) => Promise | void,\n): void;\n\n\n * Example\n\nbuilder.onDevCompileDone(({ isFirstCompile }) => {\n  if (isFirstCompile) {\n    console.log('first compile!');\n  } else {\n    console.log('re-compile!');\n  }\n});\n\n\n\nbuilder.onExit#\n\n\n\n * \n\nfunction OnExit(callback: () => void): void;\n\n\n * Example\n\nbuilder.onExit(() => {\n  console.log('exit!');\n});\n\n\n\nbuilder.getBuilderConfig#\n\n Builder  modifyBuilderConfig \n\n * \n\nfunction GetBuilderConfig(): Readonly;\n\n\n * Example\n\nbuilder.onBeforeBuild(() => {\n  const config = api.getBuilderConfig();\n  console.log(config.html?.title);\n});\n\n\n\nbuilder.getNormalizedConfig#\n\n Builder  modifyBuilderConfig \n\n getBuilderConfig  config.html  undefined\n\n\n\n\n * \n\nfunction GetNormalizedConfig(): Readonly;\n\n\n * Example\n\nbuilder.onBeforeBuild(() => {\n  const config = api.getNormalizedConfig();\n  console.log(config.html.title);\n});\n\n\n\nbuilder.getHTMLPaths#\n\n HTML \n\n key  entry value  HTML \n\n * \n\nfunction GetHTMLPaths(): Record;\n\n\n * Example\n\nbuilder.onBeforeBuild(() => {\n  const htmlPaths = api.getHTMLPaths();\n  console.log(htmlPaths); // { main: 'html/main/index.html' };\n});\n","frontmatter":{"extractApiHeaders":[2]}},{"id":168,"title":"Builder Types","routePath":"/builder/api/builder-types","lang":"zh","toc":[{"text":"BuilderInstance","id":"builderinstance","depth":2},{"text":"BuilderContext","id":"buildercontext","depth":2},{"text":"BuilderPlugin","id":"builderplugin","depth":2},{"text":"BuilderTarget","id":"buildertarget","depth":2},{"text":"BuilderEntry","id":"builderentry","depth":2},{"text":"CreateBuilderOptions","id":"createbuilderoptions","depth":2}],"domain":"","content":"#\n\n Builder \n\n\nBuilderInstance#\n\nBuilder \n\n\n\nlet builder: BuilderInstance;\n\n\n Provider  Builder \n\n\n\n\nlet builder: BuilderInstance;\n\n\n\nBuilderContext#\n\nBuilder  context \n\n\n\nconst context: BuilderContext = builder.context;\n\n\n\nBuilderPlugin#\n\nBuilder  provider  BuilderPluginAPI \n\n\n\n\nconst myPlugin: BuilderPlugin = {\n  name: 'my-plugin',\n  setup() {},\n};\n\n\n\nBuilderTarget#\n\nBuilder \n\n\n\n\n\nBuilderEntry#\n\n createBuilder  entry \n\n\n\n\n\nCreateBuilderOptions#\n\n createBuilder \n\n\n","frontmatter":{"extractApiHeaders":[2]}},{"id":169,"title":"Dev Config","routePath":"/builder/api/config-dev","lang":"zh","toc":[{"text":"dev.assetPrefix","id":"dev.assetprefix","depth":2},{"text":"Boolean ","id":"boolean-","depth":4},{"text":"String ","id":"string-","depth":4},{"text":"dev.beforeStartUrl","id":"dev.beforestarturl","depth":2},{"text":"dev.hmr","id":"dev.hmr","depth":2},{"text":"dev.host","id":"dev.host","depth":2},{"text":"dev.https","id":"dev.https","depth":2},{"text":"","id":"","depth":4},{"text":"","id":"","depth":4},{"text":"dev.port","id":"dev.port","depth":2},{"text":"","id":"","depth":3},{"text":"dev.progressBar","id":"dev.progressbar","depth":2},{"text":"dev.startUrl","id":"dev.starturl","depth":2},{"text":"","id":"","depth":3}],"domain":"","content":"#\n\n Builder \n\n\ndev.assetPrefix#\n\n *  boolean | string\n *  '/'\n\n URL  webpack  output.publicPath \n\nassetPrefix  URL JavaScript CSS\n 404 \n\n output.assetPrefix \n\nBoolean #\n\n assetPrefix  trueBuilder  //ip:port/  URL \n\nexport default {\n  dev: {\n    assetPrefix: true,\n  },\n};\n\n\n JS \n\n\n\n\n assetPrefix  false  / \n\nString #\n\n assetPrefix  string  URL \n\nexport default {\n  dev: {\n    assetPrefix: 'http://example.com/assets/',\n  },\n};\n\n\n JS \n\n\n\n\n\ndev.beforeStartUrl#\n\n *  () => Promise | void\n *  undefined\n\ndev.beforeStartUrl  startUrl  dev.startUrl \n\nexport default {\n  dev: {\n    startUrl: true,\n    beforeStartUrl: async () => {\n      await doSomeThing();\n    },\n  },\n};\n\n\n\ndev.hmr#\n\n *  boolean\n *  true\n\n Hot Module Replacement \n\n hmr  false  react-refresh \n\nexport default {\n  dev: {\n    hmr: false,\n  },\n};\n\n\n\ndev.host#\n\n *  string\n *  localhost\n\n Dev Server  host Server :\n\nexport default {\n  dev: {\n    host: '0.0.0.0',\n  },\n};\n\n\n\ndev.https#\n\n *  boolean | { key: string; cert: string }\n *  false\n\n Dev Server  HTTPS  HTTP \n\n\n\n  > Local:    http://localhost:8080/\n  > Network:  http://192.168.0.1:8080/\n\n\n\n\n  > Local:    https://localhost:8080/\n  > Network:  https://192.168.0.1:8080/\n\n\n#\n\n https  trueBuilder  devcert  Dev Server  HTTPS \n\n devcert \n\n# npm\nnpm install devcert@1.2.2 -D\n\n# yarn\nyarn add devcert@1.2.2 -D\n\n# pnpm\npnpm add devcert@1.2.2 -D\n\n\n dev.https  true \n\nexport default {\n  dev: {\n    https: true,\n  },\n};\n\n\n devcert  IP addresses Network \n\n Chrome -> 192.168.0.1\n\nTIP\nhttps  root ,  \n\n#\n\n dev.https  HTTPS  Node.js  https \ncreateServer\n\n https.createServer\n\n\n\nexport default {\n  dev: {\n    https: {\n      key: fs.readFileSync('certificates/private.pem'),\n      cert: fs.readFileSync('certificates/public.pem'),\n    },\n  },\n};\n\n\n\ndev.port#\n\n *  number\n *  8080\n\n Dev Server \n\nDev Server  8080 \n\n\n#\n\n 3000\n\nexport default {\n  dev: {\n    port: 3000,\n  },\n};\n\n\n\ndev.progressBar#\n\n * \n\ntype ProgressBar =\n  | boolean\n  | {\n      id?: string;\n    };\n\n\n *  true\n\n\n\nexport default {\n  dev: {\n    progressBar: false,\n  },\n};\n\n\n id \n\nexport default {\n  dev: {\n    progressBar: {\n      id: 'Some Text',\n    },\n  },\n};\n\n\n\ndev.startUrl#\n\n *  boolean | string | string[] | undefined\n *  undefined\n\ndev.startUrl  Dev Server  URL\n\nDev Server \n\n\n\nexport default {\n  dev: {\n    //  `http://localhost:`\n    startUrl: true,\n    // \n    startUrl: 'http://localhost:8080',\n    // \n    startUrl: ['http://localhost:8080', 'http://localhost:8080/about'],\n  },\n};\n\n\n\n#\n\n Builder \n\nexport default {\n  dev: {\n    startUrl: 'http://localhost:/home',\n  },\n};\n","frontmatter":{"extractApiHeaders":[2]}},{"id":170,"title":"Experiments Config","routePath":"/builder/api/config-experiments","lang":"zh","toc":[{"text":"experiments.lazyCompilation","id":"experiments.lazycompilation","depth":2},{"text":"","id":"","depth":3},{"text":"","id":"","depth":3},{"text":"","id":"","depth":3},{"text":"","id":"","depth":4},{"text":"","id":"","depth":4}],"domain":"","content":"#\n\n Builder  Builder \n\n GitHub Issues \n\n\nexperiments.lazyCompilation#\n\n * \n\ntype LazyCompilationOptions =\n  | boolean\n  | {\n      // \n      imports?: boolean;\n      // \n      entries?: boolean;\n    };\n\n\n *  false\n *   webpack\n\nBuilder \n\n\n\n\n#\n\n Dynamic Import \n\nexport default {\n  experiments: {\n    lazyCompilation: {\n      imports: true,\n      entries: false,\n    },\n  },\n};\n\n\n imports SPA Dynamic Import\n\n\n\n#\n\n\n\nexport default {\n  experiments: {\n    lazyCompilation: {\n      imports: true,\n      entries: true,\n    },\n  },\n};\n\n\n\n\nexport default {\n  experiments: {\n    lazyCompilation: true,\n  },\n};\n\n\n entries \n\n\n\n * MPASPA\n * \n\n\n#\n\n#\n\nBuilder\n\n\n#\n\nLazy Compilation  webpack  localhost Lazy\nCompilation  Lazy Compilation","frontmatter":{"extractApiHeaders":[2]}},{"id":171,"title":"Html Config","routePath":"/builder/api/config-html","lang":"zh","toc":[{"text":"html.appIcon","id":"html.appicon","depth":2},{"text":"","id":"","depth":3},{"text":"html.crossorigin","id":"html.crossorigin","depth":2},{"text":"","id":"-1","depth":3},{"text":"html.disableHtmlFolder","id":"html.disablehtmlfolder","depth":2},{"text":"","id":"-2","depth":3},{"text":"html.favicon","id":"html.favicon","depth":2},{"text":"","id":"-3","depth":3},{"text":"html.faviconByEntries","id":"html.faviconbyentries","depth":2},{"text":"","id":"-4","depth":3},{"text":"html.inject","id":"html.inject","depth":2},{"text":"","id":"","depth":4},{"text":" body ","id":"-body-","depth":4},{"text":"html.injectByEntries","id":"html.injectbyentries","depth":2},{"text":"","id":"-5","depth":3},{"text":"html.meta","id":"html.meta","depth":2},{"text":"","id":"","depth":4},{"text":"","id":"","depth":4},{"text":"","id":"","depth":3},{"text":"html.metaByEntries","id":"html.metabyentries","depth":2},{"text":"","id":"-6","depth":3},{"text":"html.tags","id":"html.tags","depth":2},{"text":"","id":"","depth":4},{"text":"","id":"","depth":4},{"text":"html.tagsByEntries","id":"html.tagsbyentries","depth":2},{"text":"","id":"-7","depth":3},{"text":"html.mountId","id":"html.mountid","depth":2},{"text":"","id":"-8","depth":3},{"text":"","id":"","depth":3},{"text":"","id":"","depth":4},{"text":"","id":"","depth":4},{"text":"html.template","id":"html.template","depth":2},{"text":"","id":"-9","depth":3},{"text":"html.templateByEntries","id":"html.templatebyentries","depth":2},{"text":"","id":"-10","depth":3},{"text":"html.templateParameters","id":"html.templateparameters","depth":2},{"text":"","id":"-11","depth":3},{"text":"html.templateParametersByEntries","id":"html.templateparametersbyentries","depth":2},{"text":"","id":"-12","depth":3},{"text":"html.title","id":"html.title","depth":2},{"text":"html.titleByEntries","id":"html.titlebyentries","depth":2},{"text":"","id":"-13","depth":3}],"domain":"","content":"","frontmatter":{"extractApiHeaders":[2]}},{"id":172,"title":"Output Config","routePath":"/builder/api/config-output","lang":"zh","toc":[{"text":"output.assetPrefix","id":"output.assetprefix","depth":2},{"text":"","id":"","depth":3},{"text":"output.assetsRetry","id":"output.assetsretry","depth":2},{"text":"assetsRetry.max","id":"assetsretry.max","depth":3},{"text":"assetsRetry.domain","id":"assetsretry.domain","depth":3},{"text":"assetsRetry.type","id":"assetsretry.type","depth":3},{"text":"assetsRetry.test","id":"assetsretry.test","depth":3},{"text":"assetsRetry.crossOrigin","id":"assetsretry.crossorigin","depth":3},{"text":"assetsRetry.onRetry","id":"assetsretry.onretry","depth":3},{"text":"assetsRetry.onSuccess","id":"assetsretry.onsuccess","depth":3},{"text":"assetsRetry.onFail","id":"assetsretry.onfail","depth":3},{"text":"output.charset","id":"output.charset","depth":2},{"text":"output.cleanDistPath","id":"output.cleandistpath","depth":2},{"text":"output.convertToRem","id":"output.converttorem","depth":2},{"text":"Boolean ","id":"boolean-","depth":4},{"text":"Object ","id":"object-","depth":4},{"text":"","id":"-1","depth":3},{"text":"output.copy","id":"output.copy","depth":2},{"text":"output.cssModuleLocalIdentName","id":"output.cssmodulelocalidentname","depth":2},{"text":"","id":"","depth":3},{"text":"","id":"","depth":3},{"text":"","id":"-2","depth":3},{"text":"output.dataUriLimit","id":"output.dataurilimit","depth":2},{"text":"","id":"-3","depth":3},{"text":"output.disableCssExtract","id":"output.disablecssextract","depth":2},{"text":"","id":"-4","depth":3},{"text":"output.disableCssModuleExtension","id":"output.disablecssmoduleextension","depth":2},{"text":"","id":"-5","depth":3},{"text":"","id":"","depth":3},{"text":" disableCssModuleExtension","id":"-disablecssmoduleextension","depth":4},{"text":" disableCssModuleExtension","id":"-disablecssmoduleextension","depth":4},{"text":"output.distPath","id":"output.distpath","depth":2},{"text":"","id":"-6","depth":3},{"text":"output.disableMinimize","id":"output.disableminimize","depth":2},{"text":"output.disableSourceMap","id":"output.disablesourcemap","depth":2},{"text":"output.disableTsChecker","id":"output.disabletschecker","depth":2},{"text":"","id":"","depth":3},{"text":"","id":"-7","depth":3},{"text":"output.disableFilenameHash","id":"output.disablefilenamehash","depth":2},{"text":"","id":"-8","depth":3},{"text":"output.disableInlineRuntimeChunk","id":"output.disableinlineruntimechunk","depth":2},{"text":"","id":"","depth":3},{"text":"","id":"","depth":3},{"text":"output.enableAssetManifest","id":"output.enableassetmanifest","depth":2},{"text":"","id":"-9","depth":3},{"text":"output.enableAssetFallback","id":"output.enableassetfallback","depth":2},{"text":"","id":"-10","depth":3},{"text":"output.enableLatestDecorators","id":"output.enablelatestdecorators","depth":2},{"text":"output.enableCssModuleTSDeclaration","id":"output.enablecssmoduletsdeclaration","depth":2},{"text":"Example","id":"example","depth":3},{"text":"output.enableInlineScripts","id":"output.enableinlinescripts","depth":2},{"text":"","id":"-11","depth":3},{"text":"output.enableInlineStyles","id":"output.enableinlinestyles","depth":2},{"text":"","id":"-12","depth":3},{"text":"output.externals","id":"output.externals","depth":2},{"text":"","id":"-13","depth":3},{"text":"output.filename","id":"output.filename","depth":2},{"text":"","id":"-14","depth":3},{"text":"output.legalComments","id":"output.legalcomments","depth":2},{"text":"","id":"-15","depth":3},{"text":"output.overrideBrowserslist","id":"output.overridebrowserslist","depth":2},{"text":"","id":"","depth":4},{"text":"","id":"-1","depth":4},{"text":"","id":"-16","depth":3},{"text":"","id":"","depth":4},{"text":"output.polyfill","id":"output.polyfill","depth":2},{"text":"","id":"","depth":3},{"text":"entry","id":"entry","depth":4},{"text":"usage","id":"usage","depth":4},{"text":"ua","id":"ua","depth":4},{"text":"off","id":"off","depth":4},{"text":"output.svgDefaultExport","id":"output.svgdefaultexport","depth":2}],"domain":"","content":"","frontmatter":{"extractApiHeaders":[2]}},{"id":173,"title":"Performance Config","routePath":"/builder/api/config-performance","lang":"zh","toc":[{"text":"performance.buildCache","id":"performance.buildcache","depth":2},{"text":"performance.bundleAnalyze","id":"performance.bundleanalyze","depth":2},{"text":"performance.chunkSplit","id":"performance.chunksplit","depth":2},{"text":"chunkSplit.strategy","id":"chunksplit.strategy","depth":3},{"text":"","id":"","depth":3},{"text":"chunkSplit.minSize","id":"chunksplit.minsize","depth":3},{"text":"chunkSplit.maxSize","id":"chunksplit.maxsize","depth":3},{"text":"chunkSplit.forceSplitting","id":"chunksplit.forcesplitting","depth":3},{"text":"chunkSplit.splitChunks","id":"chunksplit.splitchunks","depth":3},{"text":"chunkSplit.override","id":"chunksplit.override","depth":3},{"text":"performance.printFileSize","id":"performance.printfilesize","depth":2},{"text":"","id":"","depth":3},{"text":"performance.profile","id":"performance.profile","depth":2},{"text":"","id":"-1","depth":3},{"text":"performance.removeConsole","id":"performance.removeconsole","depth":2},{"text":" console","id":"-console","depth":4},{"text":" console","id":"-console","depth":4},{"text":"performance.removeMomentLocale","id":"performance.removemomentlocale","depth":2}],"domain":"","content":"#\n\n Builder \n\n\nperformance.buildCache#\n\n * \n\ntype BuildCacheConfig =\n  | {\n      /**\n       * webpack \n       */\n      cacheDirectory?: string;\n    }\n  | boolean;\n\n\n * \n\nconst defaultBuildCacheConfig = {\n  cacheDirectory: './node_modules/.cache/webpack',\n};\n\n\n *   webpack\n\n Builder \n\nBuilder  ./node_modules/.cache/webpack \n\n buildCache \n\nexport default {\n  performance: {\n    buildCache: {\n      cacheDirectory: './node_modules/.custom_cache/webpack',\n    },\n  },\n};\n\n\n buildCache  false \n\nexport default {\n  performance: {\n    buildCache: false,\n  },\n};\n\n\n\nperformance.bundleAnalyze#\n\n *  Object | undefined\n\n webpack-bundle-analyzer :\n\n *  BUNDLE_ANALYZE=true\n *  performance.bundleAnalyze\n\n webpack-bundle-analyzer:\n\n{\n  analyzerMode: 'static',\n  openAnalyzer: false,\n  // target  `web``node` \n  reportFilename: `report-${target}.html`,\n}\n\n\n performance.bundleAnalyze \n\nexport default {\n  performance: {\n    bundleAnalyze: {\n      analyzerMode: 'server',\n      openAnalyzer: true,\n    },\n  },\n};\n\n\n\nperformance.chunkSplit#\n\n *  Object\n *  { strategy: 'split-by-experience' }\n\nperformance.chunkSplit  Builder  ChunkSplit :\n\ntype ForceSplitting = RegExp[] | Record;\n\ninterface BaseChunkSplit {\n  strategy?:\n    | 'split-by-module'\n    | 'split-by-experience'\n    | 'all-in-one'\n    | 'single-vendor';\n  override?: SplitChunks;\n  forceSplitting?: ForceSplitting;\n}\n\ninterface SplitBySize {\n  strategy?: 'split-by-size';\n  minSize?: number;\n  maxSize?: number;\n  override?: SplitChunks;\n  forceSplitting?: ForceSplitting;\n}\n\ninterface SplitCustom {\n  strategy?: 'custom';\n  splitChunks?: SplitChunks;\n  forceSplitting?: ForceSplitting;\n}\n\nexport type ChunkSplit = BaseChunkSplit | SplitBySize | SplitCustom;\n\n\n\nchunkSplit.strategy#\n\nBuilder \n\n * split-by-experience:  npm  chunk\n * split-by-module:  NPM  NPM  chunk\n * split-by-size\n * all-in-one:  chunk \n * single-vendor:  NPM  chunk \n * custom: \n\n\n#\n\nBuilder  split-by-experience  npm\n chunk\n\n * lib-polyfill.js core-js@babel/runtime@swc/helpers\n * lib-react.js reactreact-dom\n * lib-router.js react-routerreact-router-domhistory@remix-run/router\n * lib-lodash.js lodashlodash-es\n * lib-antd.js antd\n * lib-arco.js @arco-design/web-react\n * lib-semi.js @douyinfe/semi-ui\n\nTIP\n npm  chunk\n\n performance.chunkSplit.strategy \n\nTIP\n Rspack  split-by-module \n\n\nchunkSplit.minSize#\n\n *  number\n *  10000\n\n performance.chunkSplit.strategy  split-by-size \nperformance.chunkSplit.minSize  chunk  10000:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-size',\n      minSize: 20000,\n    },\n  },\n};\n\n\n\nchunkSplit.maxSize#\n\n *  number\n *  Infinity\n\n performance.chunkSplit.strategy  split-by-size \nperformance.chunkSplit.maxSize  chunk  Infinity:\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-size',\n      maxSize: 50000,\n    },\n  },\n};\n\n\n\nchunkSplit.forceSplitting#\n\n *  RegExp[] | Record\n *  []\n\n performance.chunkSplit.forceSplitting  chunk\n\n node_modules  axios  axios.js \n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-experience',\n      forceSplitting: {\n        axios: /node_modules\\/axios/,\n      },\n    },\n  },\n};\n\n\n webpack  splitChunks\n\n\nchunkSplit.splitChunks#\n\n performance.chunkSplit.strategy  custom \nperformance.chunkSplit.splitChunks  webpack  webpack \nsplitChunks cacheGroups :\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'custom',\n      splitChunks: {\n        cacheGroups: {\n          react: {\n            test: /[\\\\/]node_modules[\\\\/](react|react-dom)[\\\\/]/,\n            name: 'react',\n            chunks: 'all',\n          },\n        },\n      },\n    },\n  },\n};\n\n\n\nchunkSplit.override#\n\n performance.chunkSplit.strategy \nsplit-by-experiencesplit-by-modulesplit-by-size  single-vendor \nperformance.chunkSplit.override  webpack  webpack  splitChunks\ncacheGroups :\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-experience',\n      override: {\n        cacheGroups: {\n          react: {\n            test: /[\\\\/]node_modules[\\\\/](react|react-dom)[\\\\/]/,\n            name: 'react',\n            chunks: 'all',\n          },\n        },\n      },\n    },\n  },\n};\n\n\n>  Builder  \"node\"  Node Bundles  chunkSplit\n> \n\n\nperformance.printFileSize#\n\n *  boolean\n *  true\n\n\n\ninfo    File sizes after production build:\n\n  File                                     Size         Gzipped\n  dist/static/js/lib-corejs.1c836fe7.js    212.89 kB    66.57 kB\n  dist/static/js/lib-react.fcafbc5c.js     134.65 kB    43.45 kB\n  dist/static/js/main.6ff06f70.js          8.93 kB      3.73 kB\n  dist/static/css/main.9f48031b.css        2.64 kB      927 B\n  dist/html/main/index.html                1.64 kB      874 B\n\n\n\n#\n\n\n\nexport default {\n  performance: {\n    printFileSize: false,\n  },\n};\n\n\n\nperformance.profile#\n\n *  boolean\n *  false\n *   webpack\n\n webpack  profile \n\n\n#\n\nexport default {\n  performance: {\n    profile: true,\n  },\n};\n\n\nWebpack  JSON \n\n\nperformance.removeConsole#\n\n *  boolean | ConsoleType[]\n *  false\n\n console.xx\n\n console#\n\n removeConsole  true  console.xx\n\nexport default {\n  performance: {\n    removeConsole: true,\n  },\n};\n\n\n console#\n\n console.xx console.log  console.warn\n\nexport default {\n  performance: {\n    removeConsole: ['log', 'warn'],\n  },\n};\n\n\n console\n\ntype ConsoleType = 'log' | 'info' | 'warn' | 'error' | 'table' | 'group';\n\n\n\nperformance.removeMomentLocale#\n\n *  boolean\n *  false\n *   webpack\n\n moment.js \n\nmoment.js \n\n moment.js \n\nexport default {\n  performance: {\n    removeMomentLocale: true,\n  },\n};\n\n\n\n\n\nimport 'moment/locale/zh-cn';\n\nmoment.locale('zh-cn');\n","frontmatter":{"extractApiHeaders":[2]}},{"id":174,"title":"Security Config","routePath":"/builder/api/config-security","lang":"zh","toc":[{"text":"security.sri","id":"security.sri","depth":2},{"text":"SRI ","id":"sri-","depth":4},{"text":"","id":"","depth":3},{"text":"security.checkSyntax","id":"security.checksyntax","depth":2},{"text":"","id":"-1","depth":3},{"text":"","id":"","depth":3},{"text":"","id":"","depth":3}],"domain":"","content":"#\n\n Builder \n\n\nsecurity.sri#\n\n * \n\ntype SRIOptions =\n  | {\n      hashFuncNames?: string[];\n      enabled?: 'auto' | boolean;\n      hashLoading?: 'eager' | 'lazy';\n    }\n  | boolean;\n\n\n *  undefined\n *   webpack\n\n HTML   integrity\n\n webpack  output.crossOriginLoading  anonymous\n\nSRI #\n\n Subresource IntegritySRI integrity\n\n\n script  CSS link \n\n SRI  Subresource Integrity - MDN\n\n\n#\n\n SRI\n\n{\n  hashFuncNames: ['sha384'];\n  enabled: \"auto\",\n  hashLoading: \"eager\",\n}\n\n\n:\n\nexport default {\n  security: {\n    sri: {\n      hashFuncNames: ['sha-256'],\n      enabled: true,\n      hashLoading: 'lazy',\n    },\n  },\n};\n\n\n\nsecurity.checkSyntax#\n\n * \n\ntype CheckSyntax =\n  | boolean\n  | {\n      targets: string[];\n      exclude?: RegExp | Array;\n    };\n\n\n *  false\n *   webpack\n\n\n\n\n#\n\nexport default {\n  security: {\n    checkSyntax: true,\n    exclude: /node_modules\\/foo/,\n  },\n};\n\n\n security.checkSyntax  true  targets  browserslist\n\n\n\n\n\n#\n\n\n\nerror   [Syntax Checker] Find some syntax errors after production build:\n\n  ERROR#1:\n  source - /node_modules/foo/index.js:1:0\n  output - /Project/dist/static/js/main.3f7a4d7e.js:2:39400\n  reason - The keyword 'const' is reserved (2:39400)\n  code   - const foo = 'bar';\n\n\n\n#\n\n\n\n *  source.include \n *  browserslist \n *  checkSyntax.exclude ","frontmatter":{"extractApiHeaders":[2]}},{"id":175,"title":"Source Config","routePath":"/builder/api/config-source","lang":"zh","toc":[{"text":"source.alias","id":"source.alias","depth":2},{"text":"Object ","id":"object-","depth":4},{"text":"Function ","id":"function-","depth":4},{"text":"source.include","id":"source.include","depth":2},{"text":" npm ","id":"-npm-","depth":3},{"text":" npm ","id":"-npm-","depth":3},{"text":" Monorepo ","id":"-monorepo-","depth":3},{"text":" CommonJS ","id":"-commonjs-","depth":3},{"text":" Symlink","id":"-symlink","depth":3},{"text":"","id":"","depth":3},{"text":"source.exclude","id":"source.exclude","depth":2},{"text":"source.compileJsDataURI","id":"source.compilejsdatauri","depth":2},{"text":"","id":"","depth":3},{"text":"source.define","id":"source.define","depth":2},{"text":"","id":"-1","depth":3},{"text":"source.globalVars","id":"source.globalvars","depth":2},{"text":"","id":"-2","depth":3},{"text":"source.moduleScopes","id":"source.modulescopes","depth":2},{"text":"","id":"-3","depth":3},{"text":"Array ","id":"array-","depth":4},{"text":"Function ","id":"function--1","depth":4},{"text":"source.transformImport","id":"source.transformimport","depth":2},{"text":"","id":"-4","depth":3},{"text":"","id":"","depth":3},{"text":"libraryName","id":"libraryname","depth":4},{"text":"libraryDirectory","id":"librarydirectory","depth":4},{"text":"style","id":"style","depth":4},{"text":"styleLibraryDirectory","id":"stylelibrarydirectory","depth":4},{"text":"camelToDashComponentName","id":"cameltodashcomponentname","depth":4},{"text":"transformToDefaultImport","id":"transformtodefaultimport","depth":4},{"text":"customName","id":"customname","depth":4},{"text":"customStyleName","id":"customstylename","depth":4},{"text":"source.preEntry","id":"source.preentry","depth":2},{"text":"","id":"","depth":4},{"text":"","id":"","depth":4},{"text":"","id":"","depth":4},{"text":"source.resolveExtensionPrefix","id":"source.resolveextensionprefix","depth":2},{"text":"","id":"-5","depth":3},{"text":"","id":"","depth":4},{"text":"source.resolveMainFields","id":"source.resolvemainfields","depth":2},{"text":"","id":"-6","depth":3},{"text":"","id":"-1","depth":4}],"domain":"","content":"#\n\n Builder \n\n\nsource.alias#\n\n *  Record | Function\n *  undefined\n\n webpack  resolve.alias \n\nTIP\n TypeScript  tsconfig.json  compilerOptions.paths Builder \ntsconfig.json  alias \nTIP\n Rspack  Record | Function \n\nObject #\n\nalias  Object  Builder \n\nexport default {\n  source: {\n    alias: {\n      '@common': './src/common',\n    },\n  },\n};\n\n\n @common/Foo.tsx,  /src/common/Foo.tsx \n\nFunction #\n\nalias  alias \n\nexport default {\n  source: {\n    alias: alias => {\n      alias['@common'] = './src/common';\n    },\n  },\n};\n\n\n alias \n\nexport default {\n  source: {\n    alias: alias => {\n      return {\n        '@common': './src/common',\n      };\n    },\n  },\n};\n\n\n\nsource.include#\n\n *  Array\n *  []\n\nBuilder  node_modules  JavaScript/TypeScript\n JavaScript/TypeScript \n\n source.include  Builder source.include  webpack \nRule.include \n\n:\n\n\n\nexport default {\n  source: {\n    include: [path.resolve(__dirname, '../other-dir')],\n  },\n};\n\n\n\n npm #\n\n node_modules  npm  ES6+\n\n\n query-string \n\n\n\nexport default {\n  source: {\n    include: [\n      // :\n      //  require.resolve \n      //  path.dirname \n      path.dirname(require.resolve('query-string')),\n      // :\n      // \n      //  `/query-string/` \n      /\\/query-string\\//,\n    ],\n  },\n};\n\n\n\n npm #\n\n source.include  npm Builder \n\n query-string  decode-uri-component  ES6+ \ndecode-uri-component  source.include \n\nexport default {\n  source: {\n    include: [/\\/query-string\\//, /\\/decode-uri-component\\//],\n  },\n};\n\n\n\n Monorepo #\n\n Monorepo  Monorepo  source.include :\n\n\n\nexport default {\n  source: {\n    include: [\n      // :\n      //  Monorepo  package \n      path.resolve(__dirname, '../../packages'),\n\n      // :\n      //  Monorepo  package \n      // \n      path.resolve(__dirname, '../../packages/xxx/src'),\n    ],\n  },\n};\n\n\n\n CommonJS #\n\nBabel  CommonJS  CommonJS  exports is not defined\n\n\n source.include  CommonJS  Babel  sourceType  unambiguous\n\nexport default {\n  tools: {\n    babel(config) {\n      config.sourceType = 'unambiguous';\n    },\n  },\n};\n\n\n sourceType  unambiguous  Babel \n\n\n Symlink#\n\n symlink  symlink \n\n Monorepo  packages/foo  symlink  node_modules/foo \npackages/foo  node_modules/foo \n\n webpack  resolve.symlinks \n\n\n#\n\nsource.include  node_modules \n\nexport default {\n  source: {\n    include: [/\\/node_modules\\//],\n  },\n};\n\n\n node_modules  node_modules  npm\ncore-js  npm \n\n\nsource.exclude#\n\n *  Array\n *  []\n\n JavaScript/TypeScript  webpack  Rule.exclude\n\n\n:\n\n\n\nexport default {\n  source: {\n    exclude: [path.resolve(__dirname, 'src/module-a'), /src\\/module-b/],\n  },\n};\n\n\n\nsource.compileJsDataURI#\n\n *  boolean\n *  true\n\n Data URI  JavaScript  babel \n\n\n\n\n\nimport 'data:text/javascript;charset=utf-8;base64,Y29uc29sZS5sb2coJ2lubGluZSAxJyk7';\n\n\n\n#\n\n\n\nexport default {\n  source: {\n    compileJsDataURI: false,\n  },\n};\n\n\n\nsource.define#\n\n *  Record\n *  {}\n\n\n\n . \n\n * \n * \n *  . \n *  typeof  typeof \n\n https://webpack.js.org/plugins/define-plugin/\n\nTIP\n Rspack  Rspack.builtins.define\n\n\n#\n\nexport default {\n  source: {\n    define: {\n      PRODUCTION: JSON.stringify(true),\n      VERSION: JSON.stringify('5fa3b9'),\n      BROWSER_SUPPORTS_HTML5: true,\n      TWO: '1 + 1',\n      'typeof window': JSON.stringify('object'),\n      'process.env.NODE_ENV': JSON.stringify(process.env.NODE_ENV),\n      'import.meta': { test: undefined },\n    },\n  },\n};\n\n\n\n\nconst foo = TWO;\n\n//  Turn into being...\nconst foo = 1 + 1;\n\n\n\nsource.globalVars#\n\n *  Record\n * \n\n// Builder  `process.env.NODE_ENV` \nconst defaultGlobalVars = {\n  'process.env.NODE_ENV': JSON.stringify(process.env.NODE_ENV),\n};\n\n\n process.env.FOO \n\nconsole.log(process.env.NODE_ENV);\n\n//  Turn into being...\nconsole.log('development');\n\n\n NODE_ENV  process.env.NODE_ENV \n\nconst { NODE_ENV } = process.env;\nconsole.log(NODE_ENV);\n//  Won't get a string.\n\n\nsource.globalVars  source.define  source.globalVars \nJSON  globalVars  JSON \n\nexport default {\n  source: {\n    globalVars: {\n      'process.env.BUILD_VERSION': '0.0.1',\n      'import.meta.foo': { bar: 42 },\n      'import.meta.baz': false,\n    },\n    define: {\n      'process.env.BUILD_VERSION': JSON.stringify('0.0.1'),\n      'import.meta': {\n        foo: JSON.stringify({ bar: 42 }),\n        baz: JSON.stringify(false),\n      },\n    },\n  },\n};\n\n\n\n#\n\nexport default {\n  source: {\n    globalVars: {\n      ENABLE_VCONSOLE: true,\n      APP_CONTEXT: { answer: 42 },\n    },\n  },\n};\n\n\n\nsource.moduleScopes#\n\n *  Array | Function\n *  undefined\n *   webpack\n\n\n\n\n#\n\n moduleScopes  src \n\nexport default {\n  source: {\n    moduleScopes: ['./src'],\n  },\n};\n\n\n src/App.tsx  src  utils/a :\n\n\n\n\n:\n\n\n\n utils \n\nexport default {\n  source: {\n    moduleScopes: ['./src', './utils'],\n  },\n};\n\n\nArray #\n\n moduleScopes  Array \n\nexport default {\n  source: {\n    moduleScopes: ['./src', './shared', './utils'],\n  },\n};\n\n\nFunction #\n\nmoduleScopes \n\nexport default {\n  source: {\n    moduleScopes: scopes => {\n      scopes.push('./shared');\n    },\n  },\n};\n\n\n\nsource.transformImport#\n\n babel-plugin-import\n\n babel-plugin-import source.transformImport  Babel Builder\n BabelSWC  Rspack\n\n * \n\nArray<{\n  libraryName: string;\n  libraryDirectory?: string;\n  style?: string | boolean;\n  styleLibraryDirectory?: string;\n  camelToDashComponentName?: boolean;\n  transformToDefaultImport?: boolean;\n  customName?: ((member: string) => string | undefined) | string;\n  customStyleName?: ((member: string) => string | undefined) | string;\n}>;\n\n\n * \n\n antd  <= 4.x Builder \n\n{\n  libraryName: 'antd',\n  libraryDirectory: target === 'node' ? 'lib' : 'es',\n  style: true,\n}\n\n\n\n#\n\n antd \n\n{\n  libraryName: 'antd',\n  libraryDirectory: 'es',\n  style: true,\n}\n\n\n\n\n\n\n\n\n\n\nimport 'antd/es/button/style';\n\n\n\n#\n\nlibraryName#\n\n *  string\n\n Builder  import \n\nlibraryDirectory#\n\n *  string\n *  'lib'\n\n ${libraryName}/${libraryDirectory}/${member} member \n\n\n\n\n\n\n:\n\n\n\n\nstyle#\n\n *  boolean\n *  undefined\n\n true ${libraryName}/${libraryDirectory}/${member}/style\n false  undefined \n\n true \n\n\n\n\n:\n\n\nimport 'foo/lib/button/style';\n\n\nstyleLibraryDirectory#\n\n *  string\n *  undefined\n\n style \n${libraryName}/${styleLibraryDirectory}/${member}\n\n styles \n\n\n\n\n:\n\n\nimport 'foo/styles/button';\n\n\ncamelToDashComponentName#\n\n *  boolean\n *  true\n\n camelCase  kebab-case\n\n\n\n\n\n\n\n\n//  true\n\n//  false\n\n\n\ntransformToDefaultImport#\n\n *  boolean\n *  true\n\n\n\n\n\n\n\n\n\n\n//  true\n\n//  false\n\n\n\ncustomName#\n\n *  ((member: string) => string | undefined) | string\n *  undefined\n\n\n *  Webpack \n *  Rspack  SWC  Webpack \n\n (member) => `my-lib/${member}`   \n\n Rspack  handlebars \nmy-lib/{{ member }} my-lib/{{ kebabCase member }} \nkebab-case  kebabCase  camelCasesnakeCaseupperCaselowerCase \n\ncustomStyleName#\n\n *  ((member: string) => string | undefined) | string\n *  undefined\n\n\n *  Webpack \n *  Rspack  SWC  Webpack \n\n (member) => `my-lib/${member}`   \n\n Rspack  handlebars \nmy-lib/{{ member }} my-lib/{{ kebabCase member }} \nkebab-case  kebabCase  camelCasesnakeCaseupperCaselowerCase \n\n\nsource.preEntry#\n\n *  string | string[]\n *  undefined\n\n polyfill\n\n#\n\n src/polyfill.ts \n\nconsole.log('I am a polyfill');\n\n\n src/polyfill.ts  source.preEntry \n\nexport default {\n  source: {\n    preEntry: './src/polyfill.ts',\n  },\n};\n\n\n src/polyfill.ts  console \n\n#\n\n source.preEntry  CSS  normalize.css \n\nexport default {\n  source: {\n    preEntry: './src/normalize.css',\n  },\n};\n\n\n#\n\n preEntry \n\nexport default {\n  source: {\n    preEntry: ['./src/polyfill-a.ts', './src/polyfill-b.ts'],\n  },\n};\n\n\n\nsource.resolveExtensionPrefix#\n\n *  string | Record\n *  undefined\n\n resolve.extensions \n\nBuilder  extensions\n\n\n\n#\n\n .web \n\nexport default {\n  source: {\n    resolveExtensionPrefix: '.web',\n  },\n};\n\n\nextensions \n\n// \nconst extensions = ['.js', '.ts', ...];\n\n// \nconst extensions = ['.web.js', '.js', '.web.ts' , '.ts', ...];\n\n\n import './foo'  foo.web.js  foo.js \n\n#\n\n extension  resolveExtensionPrefix\n key \n\n web  node  extension \n\nexport default {\n  output: {\n    source: {\n      resolveExtensionPrefix: {\n        web: '.web',\n        node: '.node',\n      },\n    },\n  },\n};\n\n\n import './foo'  node  foo.node.js  web \nfoo.web.js \n\n\nsource.resolveMainFields#\n\n * \n\ntype Fields = (string | string[])[];\n\ntype ResolveMainFields = Fields | Record;\n\n\n *  undefined\n\n package.json  npm  webpack  resolve.mainFields \n\n\n#\n\nexport default {\n  source: {\n    resolveMainFields: ['main', 'browser', 'exports'],\n  },\n};\n\n\n#\n\n mainFields resolveMainFields \nkey \n\n web  node  mainFields\n\nexport default {\n  output: {\n    source: {\n      resolveMainFields: {\n        web: ['main', 'browser', 'exports'],\n        node: ['main', 'node', 'exports'],\n      },\n    },\n  },\n};\n","frontmatter":{"extractApiHeaders":[2]}},{"id":176,"title":"Tools Config","routePath":"/builder/api/config-tools","lang":"zh","toc":[{"text":"tools.autoprefixer","id":"tools.autoprefixer","depth":2},{"text":"Object ","id":"object-","depth":3},{"text":"Function ","id":"function-","depth":3},{"text":"tools.babel","id":"tools.babel","depth":2},{"text":"Function ","id":"function--1","depth":3},{"text":"Object ","id":"object--1","depth":3},{"text":"","id":"","depth":3},{"text":"addPlugins","id":"addplugins","depth":4},{"text":"addPresets","id":"addpresets","depth":4},{"text":"removePlugins","id":"removeplugins","depth":4},{"text":"removePresets","id":"removepresets","depth":4},{"text":"addIncludes","id":"addincludes","depth":4},{"text":"addExcludes","id":"addexcludes","depth":4},{"text":"modifyPresetEnvOptions","id":"modifypresetenvoptions","depth":4},{"text":"modifyPresetReactOptions","id":"modifypresetreactoptions","depth":4},{"text":"tools.bundlerChain","id":"tools.bundlerchain","depth":2},{"text":"","id":"","depth":3},{"text":"env","id":"env","depth":4},{"text":"isProd","id":"isprod","depth":4},{"text":"target","id":"target","depth":4},{"text":"isServer","id":"isserver","depth":4},{"text":"isWebWorker","id":"iswebworker","depth":4},{"text":"HtmlPlugin","id":"htmlplugin","depth":3},{"text":"CHAIN_ID","id":"chain_id","depth":4},{"text":"CHAIN_ID.ONE_OF","id":"chain_id.one_of","depth":3},{"text":"CHAIN_ID.USE","id":"chain_id.use","depth":3},{"text":"CHAIN_ID.PLUGIN","id":"chain_id.plugin","depth":3},{"text":" BundlerChain ","id":"-bundlerchain-","depth":3},{"text":"tools.cssExtract","id":"tools.cssextract","depth":2},{"text":"Object ","id":"object--2","depth":3},{"text":"Function ","id":"function--2","depth":3},{"text":"tools.cssLoader","id":"tools.cssloader","depth":2},{"text":"Object ","id":"object--3","depth":3},{"text":"Function ","id":"function--3","depth":3},{"text":"tools.devServer","id":"tools.devserver","depth":2},{"text":"","id":"","depth":3},{"text":"after","id":"after","depth":4},{"text":"before","id":"before","depth":4},{"text":"client","id":"client","depth":4},{"text":"devMiddleware","id":"devmiddleware","depth":4},{"text":"headers","id":"headers","depth":4},{"text":"historyApiFallback","id":"historyapifallback","depth":4},{"text":"hot","id":"hot","depth":4},{"text":"https","id":"https","depth":4},{"text":"liveReload","id":"livereload","depth":4},{"text":"setupMiddlewares","id":"setupmiddlewares","depth":4},{"text":"proxy","id":"proxy","depth":4},{"text":"watch","id":"watch","depth":4},{"text":"tools.htmlPlugin","id":"tools.htmlplugin","depth":2},{"text":"Object ","id":"object--4","depth":3},{"text":"Function ","id":"function--4","depth":3},{"text":"Boolean ","id":"boolean-","depth":3},{"text":"tools.inspector","id":"tools.inspector","depth":2},{"text":"Object ","id":"object--5","depth":3},{"text":"Function ","id":"function--5","depth":3},{"text":"tools.less","id":"tools.less","depth":2},{"text":"Object ","id":"object--6","depth":3},{"text":"Function ","id":"function--6","depth":3},{"text":"","id":"-1","depth":3},{"text":"addExcludes","id":"addexcludes-1","depth":4},{"text":"tools.minifyCss","id":"tools.minifycss","depth":2},{"text":"Object ","id":"object--7","depth":3},{"text":"Function ","id":"function--7","depth":3},{"text":"tools.postcss","id":"tools.postcss","depth":2},{"text":"Function ","id":"function--8","depth":3},{"text":"Object ","id":"object--8","depth":3},{"text":"","id":"-2","depth":3},{"text":"addPlugins","id":"addplugins-1","depth":4},{"text":"tools.pug","id":"tools.pug","depth":2},{"text":"Boolean ","id":"boolean--1","depth":3},{"text":"Object ","id":"object--9","depth":3},{"text":"Function ","id":"function--9","depth":3},{"text":"tools.sass","id":"tools.sass","depth":2},{"text":"Object ","id":"object--10","depth":3},{"text":"Function ","id":"function--10","depth":3},{"text":"","id":"-3","depth":3},{"text":"addExcludes","id":"addexcludes-2","depth":4},{"text":"tools.styleLoader","id":"tools.styleloader","depth":2},{"text":"Object ","id":"object--11","depth":3},{"text":"Function ","id":"function--11","depth":3},{"text":"tools.styledComponents","id":"tools.styledcomponents","depth":2},{"text":"tools.terser","id":"tools.terser","depth":2},{"text":"Object ","id":"object--12","depth":3},{"text":"Function ","id":"function--12","depth":3},{"text":"tools.tsLoader","id":"tools.tsloader","depth":2},{"text":"Object ","id":"object--13","depth":3},{"text":"Function ","id":"function--13","depth":3},{"text":"","id":"-4","depth":3},{"text":"addIncludes","id":"addincludes-1","depth":4},{"text":"addExcludes","id":"addexcludes-3","depth":4},{"text":"tools.tsChecker","id":"tools.tschecker","depth":2},{"text":"Object ","id":"object--14","depth":3},{"text":"Function ","id":"function--14","depth":3},{"text":"tools.webpack","id":"tools.webpack","depth":2},{"text":"Object ","id":"object--15","depth":3},{"text":"Function ","id":"function--15","depth":3},{"text":"","id":"-1","depth":3},{"text":"env","id":"env-1","depth":4},{"text":"isProd","id":"isprod-1","depth":4},{"text":"target","id":"target-1","depth":4},{"text":"isServer","id":"isserver-1","depth":4},{"text":"isWebWorker","id":"iswebworker-1","depth":4},{"text":"webpack","id":"webpack","depth":4},{"text":"HtmlWebpackPlugin","id":"htmlwebpackplugin","depth":3},{"text":"addRules","id":"addrules","depth":3},{"text":"prependPlugins","id":"prependplugins","depth":3},{"text":"appendPlugins","id":"appendplugins","depth":3},{"text":"removePlugin","id":"removeplugin","depth":3},{"text":"mergeConfig","id":"mergeconfig","depth":3},{"text":"tools.webpackChain","id":"tools.webpackchain","depth":2},{"text":"","id":"-2","depth":3},{"text":"env","id":"env-2","depth":4},{"text":"isProd","id":"isprod-2","depth":4},{"text":"target","id":"target-2","depth":4},{"text":"isServer","id":"isserver-2","depth":4},{"text":"isWebWorker","id":"iswebworker-2","depth":4},{"text":"webpack","id":"webpack-1","depth":4},{"text":"HtmlWebpackPlugin","id":"htmlwebpackplugin-1","depth":3},{"text":"CHAIN_ID","id":"chain_id-1","depth":4},{"text":"CHAIN_ID.ONE_OF","id":"chain_id.one_of-1","depth":3},{"text":"CHAIN_ID.USE","id":"chain_id.use-1","depth":3},{"text":"CHAIN_ID.PLUGIN","id":"chain_id.plugin-1","depth":3},{"text":"CHAIN_ID.MINIMIZER","id":"chain_id.minimizer","depth":3},{"text":" WebpackChain ","id":"-webpackchain-","depth":3},{"text":"// loader","id":"//-loader","depth":4},{"text":"// plugin","id":"//-plugin","depth":4},{"text":"tools.rspack","id":"tools.rspack","depth":2},{"text":"Object ","id":"object--16","depth":3},{"text":"Function ","id":"function--16","depth":3},{"text":"","id":"-3","depth":3},{"text":"env","id":"env-3","depth":4},{"text":"isProd","id":"isprod-3","depth":4},{"text":"target","id":"target-3","depth":4},{"text":"isServer","id":"isserver-3","depth":4},{"text":"isWebWorker","id":"iswebworker-3","depth":4},{"text":"addRules","id":"addrules-1","depth":3},{"text":"prependPlugins","id":"prependplugins-1","depth":3},{"text":"appendPlugins","id":"appendplugins-1","depth":3},{"text":"removePlugin","id":"removeplugin-1","depth":3},{"text":"mergeConfig","id":"mergeconfig-1","depth":3}],"domain":"","content":"#\n\n Builder \n\n\ntools.autoprefixer#\n\n *  Object | Function\n * \n\n{\n  flexbox: 'no-2009',\n  // browserslist  browserslist \n  //  `output.overrideBrowserslist`() \n  overrideBrowserslist: browserslist,\n}\n\n\n tools.autoprefixer  autoprefixer \n\n\nObject #\n\n tools.autoprefixer  Object  Object.assign \n\nexport default {\n  tools: {\n    autoprefixer: {\n      flexbox: 'no-2009',\n    },\n  },\n};\n\n\n\nFunction #\n\n tools.autoprefixer  Function \n\nexport default {\n  tools: {\n    autoprefixer(config) {\n      //  flexbox \n      config.flexbox = 'no-2009';\n    },\n  },\n};\n\n\n\ntools.babel#\n\n *  Object | Function\n *  undefined\n\n tools.babel  babel-loader \n\nWARNING\n Rspack  Rspack  Rspack  SWC  Babel\n\n\n\nFunction #\n\n tools.babel  Function\n\n\nexport default {\n  tools: {\n    babel(config) {\n      // \n      config.plugins.push([\n        'babel-plugin-import',\n        {\n          libraryName: 'xxx-components',\n          libraryDirectory: 'es',\n          style: true,\n        },\n      ]);\n    },\n  },\n};\n\n\nTIP\n babel-plugin-import Builder \nsource.transformImport \n\n\nObject #\n\n tools.babel  Object  Object.assign \n\nCAUTION\nObject.assign  presets  plugins  presets  plugins\n\n\nexport default {\n  tools: {\n    babel: {\n      plugins: [\n        [\n          'babel-plugin-import',\n          {\n            libraryName: 'xxx-components',\n            libraryDirectory: 'es',\n            style: true,\n          },\n        ],\n      ],\n    },\n  },\n};\n\n\n\n#\n\ntools.babel  Function :\n\naddPlugins#\n\n *  (plugins: BabelPlugin[]) => void\n\n Babel \n\nexport default {\n  tools: {\n    babel(config, { addPlugins }) {\n      addPlugins([\n        [\n          'babel-plugin-import',\n          {\n            libraryName: 'xxx-components',\n            libraryDirectory: 'es',\n            style: true,\n          },\n        ],\n      ]);\n    },\n  },\n};\n\n\naddPresets#\n\n *  (presets: BabelPlugin[]) => void\n\n Babel  ()\n\nexport default {\n  tools: {\n    babel(config, { addPresets }) {\n      addPresets(['@babel/preset-env']);\n    },\n  },\n};\n\n\nremovePlugins#\n\n *  (plugins: string | string[]) => void\n\n Babel \n\nexport default {\n  tools: {\n    babel(config, { removePlugins }) {\n      removePlugins('babel-plugin-import');\n    },\n  },\n};\n\n\nremovePresets#\n\n *  (presets: string | string[]) => void\n\n Babel \n\nexport default {\n  tools: {\n    babel(config, { removePresets }) {\n      removePresets('@babel/preset-env');\n    },\n  },\n};\n\n\naddIncludes#\n\n *  (includes: string | RegExp | (string | RegExp)[]) => void\n\n Babel  src  addIncludes  Babel  node_modules\n query-string \n\nexport default {\n  tools: {\n    babel(config, { addIncludes }) {\n      addIncludes(/\\/query-string\\//);\n    },\n  },\n};\n\n\nTIP\naddIncludes  source.include  source.include \n source.include  addIncludes \n\naddExcludes#\n\n *  (excludes: string | RegExp | (string | RegExp)[]) => void\n\naddExcludes  addIncludes  Babel \n\n src/example :\n\nexport default {\n  tools: {\n    babel(config, { addExcludes }) {\n      addExcludes('src/example');\n    },\n  },\n};\n\n\nTIP\naddExcludes  source.exclude  source.exclude \n source.exclude  addExcludes \n\nmodifyPresetEnvOptions#\n\n *  (options: PresetEnvOptions) => void\n\n @babel/preset-env :\n\nexport default {\n  tools: {\n    babel(config, { modifyPresetEnvOptions }) {\n      modifyPresetEnvOptions({\n        targets: {\n          browsers: ['last 2 versions'],\n        },\n      });\n    },\n  },\n};\n\n\nmodifyPresetReactOptions#\n\n *  (options: PresetReactOptions) => void\n\n @babel/preset-react :\n\nexport default {\n  tools: {\n    babel(config, { modifyPresetReactOptions }) {\n      modifyPresetReactOptions({\n        pragma: 'React.createElement',\n      });\n    },\n  },\n};\n\n\n\ntools.bundlerChain#\n\n *  Function | undefined\n *  undefined\n\n tools.bundlerChain  webpack  Rspack  Function \n\n *  bundler-chain  webpack  Rspack \n * envisProdCHAIN_ID \n\n BundlerChain\n\nBundler chain  webpack chain  webpack chain API webpack \nRspack \n\n bundler chain  webpack  Rspack bundler chain \nwebpack  Rspack  devtool (webpack  Rspack  devtool\n)Rspack  webpack \n\n> tools.bundlerChain  tools.webpackChain / tools.webpack /\n> tools.rspack\n\n\n#\n\nenv#\n\n *  'development' | 'production' | 'test'\n\n env  developmentproduction  test\n\nexport default {\n  tools: {\n    bundlerChain: (chain, { env }) => {\n      if (env === 'development') {\n        chain.devtool('cheap-module-eval-source-map');\n      }\n    },\n  },\n};\n\n\nisProd#\n\n *  boolean\n\n isProd  production\n\nexport default {\n  tools: {\n    bundlerChain: (chain, { isProd }) => {\n      if (isProd) {\n        chain.devtool('source-map');\n      }\n    },\n  },\n};\n\n\ntarget#\n\n *  'web' | 'node' | 'modern-web' | 'web-worker'\n\n target \n\nexport default {\n  tools: {\n    bundlerChain: (chain, { target }) => {\n      if (target === 'node') {\n        // ...\n      }\n    },\n  },\n};\n\n\nisServer#\n\n *  boolean\n\n node target === 'node'\n\nexport default {\n  tools: {\n    bundlerChain: (chain, { isServer }) => {\n      if (isServer) {\n        // ...\n      }\n    },\n  },\n};\n\n\nisWebWorker#\n\n *  boolean\n\n web-worker target === 'web-worker'\n\nexport default {\n  tools: {\n    bundlerChain: (chain, { isWebWorker }) => {\n      if (isWebWorker) {\n        // ...\n      }\n    },\n  },\n};\n\n\n\nHtmlPlugin#\n\n *  typeof import('html-webpack-plugin') | import('@rspack/plugin-html')\n\n webpack  Rspack  HtmlPlugin \n\nexport default {\n  tools: {\n    bundlerChain: (chain, { HtmlPlugin }) => {\n      console.log(HtmlPlugin);\n    },\n  },\n};\n\n\nCHAIN_ID#\n\nBuilder  Chain ID ID  Rule  Plugin\n\nCHAIN_ID.RULE#\n\nID          \nRULE.CSS     css \nRULE.LESS    less \nRULE.SASS    sass \nRULE.TOML    toml \nRULE.YAML    yaml \n\n\nCHAIN_ID.ONE_OF#\n\n ONE_OF.XXX \n\nID                  \nONE_OF.SVG           SVG  data URI \nONE_OF.SVG_URL       SVG \nONE_OF.SVG_INLINE    SVG  data URI  bundle \nONE_OF.SVG_ASSETS    SVG  data URI \n\n\nCHAIN_ID.USE#\n\n USE.XXX  loader\n\nID            \nUSE.LESS       less-loader\nUSE.SASS       sass-loader\nUSE.TOML       toml-loader\nUSE.YAML       yaml-loader\nUSE.SVGR       @svgr/webpack\nUSE.POSTCSS    postcss-loader\n\n\nCHAIN_ID.PLUGIN#\n\n PLUGIN.XXX  plugin\n\nID                          \nPLUGIN.HTML                  HtmlPlugin entry ${PLUGIN.HTML}-${entryName}\nPLUGIN.APP_ICON              AppIconPlugin\nPLUGIN.INLINE_HTML           InlineChunkHtmlPlugin\nPLUGIN.BUNDLE_ANALYZER       WebpackBundleAnalyzer\nPLUGIN.BOTTOM_TEMPLATE       BottomTemplatePlugin\nPLUGIN.ASSETS_RETRY          Builder  webpack  WebpackAssetsRetryPlugin\nPLUGIN.AUTO_SET_ROOT_SIZE    Builder  AutoSetRootSizePlugin\n\n\n BundlerChain #\n\nBundlerChain  WebpackChain \n\n\ntools.cssExtract#\n\n *  Object | Function\n * \n\nconst defaultOptions = {\n  // Loader \n  loaderOptions: {},\n  // Plugin \n  pluginOptions: {\n    // cssPath  static/css, cssFilename  [name].[contenthash:8].css\n    filename: `${cssPath}/${cssFilename}`,\n    chunkFilename: `${cssPath}/async/${cssFilename}`,\n    ignoreOrder: true,\n  },\n};\n\n\n *   webpack\n\n tools.cssExtract  mini-css-extract-plugin \n\n\nObject #\n\n Object  Object.assign \n\nexport default {\n  tools: {\n    cssExtract: {\n      pluginOptions: {\n        filename: 'static/css/[name].[contenthash:8].css',\n      },\n    },\n  },\n};\n\n\n\nFunction #\n\n Function \n\nexport default {\n  tools: {\n    cssExtract: config => {\n      config.pluginOptions.filename = 'static/css/[name].[contenthash:8].css';\n      return config;\n    },\n  },\n};\n\n\n mini-css-extract-plugin\n\n\ntools.cssLoader#\n\n *  Object | Function\n *  undefined\n\n tools.cssLoader  css-loader :\n\n{\n  importLoaders: 1,\n  modules: {\n    auto: true,\n    exportLocalsConvention: 'camelCase',\n    localIdentName: config.output.cssModuleLocalIdentName,\n    // isServer  node (SSR) \n    // isWebWorker  web worker \n    exportOnlyLocals: isServer || isWebWorker,\n  },\n  //  CSS  Source Map\n  sourceMap: isDev,\n}\n\n\n *   webpack\n\n\nObject #\n\n Object  (deep merge)\n\nexport default {\n  tools: {\n    cssLoader: {\n      modules: {\n        exportOnlyLocals: true,\n      },\n    },\n  },\n};\n\n\n\nFunction #\n\n Function \n\nexport default {\n  tools: {\n    cssLoader: config => {\n      config.modules.exportOnlyLocals = true;\n      return config;\n    },\n  },\n};\n\n\n\ntools.devServer#\n\n *  Object\n *  {}\n\n tools.devServer \n\n\n#\n\nafter#\n\n *  Array\n *  []\n\n\n\nexport default {\n  tools: {\n    devServer: {\n      after: [\n        async (req, res, next) => {\n          console.log('after dev middleware');\n          next();\n        },\n      ],\n    },\n  },\n};\n\n\nbefore#\n\n *  Array\n *  []\n\n\n\nexport default {\n  tools: {\n    devServer: {\n      before: [\n        async (req, res, next) => {\n          console.log('before dev middleware');\n          next();\n        },\n      ],\n    },\n  },\n};\n\n\nclient#\n\n * \n\n{\n    /**  */\n    protocol?: string;\n    /**  */\n    path?: string;\n    /**  */\n    port?: string;\n    /**  host */\n    host?: string;\n}\n\n\n * \n\n{\n    path: '/webpack-hmr',\n    port: '8080',\n    host: networkAddress || 'localhost',\n}\n\n\n hmr \n\ndevMiddleware#\n\n * \n\n{\n  writeToDisk: boolean | ((filename: string) => boolean);\n}\n\n\n * \n\n{\n  writeToDisk: (file: string) => !file.includes('.hot-update.'),\n}\n\n\ndevMiddleware  webpack-dev-middleware .\n\nheaders#\n\n *  Record\n *  undefined\n\n\n\nexport default {\n  tools: {\n    devServer: {\n      headers: {\n        'X-Custom-Foo': 'bar',\n      },\n    },\n  },\n};\n\n\nhistoryApiFallback#\n\n *  boolean | ConnectHistoryApiFallbackOptions\n *  false\n\n 404  devServer.historyApiFallback \n\nexport default {\n  tools: {\n    devServer: {\n      historyApiFallback: true,\n    },\n  },\n};\n\n\n connect-history-api-fallback \n\nhot#\n\n *  boolean\n *  true\n\n Hot Module Replacement \n\nhttps#\n\n *  boolean | { key: string; cert: string }\n *  false\n\nDevServer  HTTP  devServer.https  true  HTTPS \nHTTP \n\n HTTPS \n\nexport default {\n  tools: {\n    devServer: {\n      https: {\n        key: fs.readFileSync('certificates/private.pem'),\n        cert: fs.readFileSync('certificates/public.pem'),\n      },\n    },\n  },\n};\n\n\nliveReload#\n\n *  boolean\n *  true\n\nDevServer  liveReload devServer.hot \ndevServer.liveReload  false \n\nsetupMiddlewares#\n\n * \n\nArray<\n  (\n    middlewares: {\n      unshift: (...handlers: RequestHandler[]) => void;\n      push: (...handlers: RequestHandler[]) => void;\n    },\n    server: {\n      sockWrite: (\n        type: string,\n        data?: string | boolean | Record,\n      ) => void;\n    },\n  ) => void\n>;\n\n\n *  undefined\n\n\n\n: devServer.before => unshift =>  => push =>\ndevServer.after\n\nexport default {\n  tools: {\n    devServer: {\n      setupMiddlewares: [\n        (middlewares, server) => {\n          middlewares.unshift((req, res, next) => {\n            next();\n          });\n\n          middlewares.push((req, res, next) => {\n            next();\n          });\n        },\n      ],\n    },\n  },\n};\n\n\n API\n\n * sockWrite hmr hmr \n   \"content-changed \" \n\nexport default {\n  tools: {\n    devServer: {\n      setupMiddlewares: [\n        (middlewares, server) => {\n          //  watcher \n          watcher.on('change', changed => {\n            server.sockWrite('content-changed');\n          });\n        },\n      ],\n    },\n  },\n};\n\n\nproxy#\n\n *  Record | Record\n *  undefined\n\n\n\nexport default {\n  tools: {\n    devServer: {\n      proxy: {\n        '/api': 'http://localhost:3000',\n      },\n    },\n  },\n};\n\n\n/api/users  http://localhost:3000/api/users\n\n /api pathRewrite \n\nexport default {\n  tools: {\n    devServer: {\n      proxy: {\n        '/api': {\n          target: 'http://localhost:3000',\n          pathRewrite: { '^/api': '' },\n        },\n      },\n    },\n  },\n};\n\n\nDevServer Proxy  http-proxy-middleware  http-proxy-middleware\n\n\nDevServer Proxy \n\n\n\ntype ProxyDetail = HttpProxyOptions & {\n  bypass?: (\n    req: IncomingMessage,\n    res: ServerResponse,\n    proxyOptions: ProxyOptions,\n  ) => string | undefined | null | false;\n  context?: string | string[];\n};\n\ntype ProxyOptions =\n  | Record\n  | Record\n  | ProxyDetail[]\n  | ProxyDetail;\n\n\n http-proxy-middleware  bypass  context \n\n * bypass\n   *  null  undefined \n   *  false  404 \n   * \n * context context \n\n//  bypass \nexport default {\n  tools: {\n    devServer: {\n      proxy: {\n        '/api': {\n          target: 'http://localhost:3000',\n          bypass: function (req, res, proxyOptions) {\n            if (req.headers.accept.indexOf('html') !== -1) {\n              console.log('Skipping proxy for browser request.');\n              return '/index.html';\n            }\n          },\n        },\n      },\n    },\n  },\n};\n\n\n// \nexport default {\n  tools: {\n    devServer: {\n      proxy: [\n        {\n          context: ['/auth', '/api'],\n          target: 'http://localhost:3000',\n        },\n      ],\n    },\n  },\n};\n\n\nwatch#\n\n *  boolean\n *  true\n\n mock/server/api/ \n\n\ntools.htmlPlugin#\n\n *  false | Object | Function\n * \n\nconst defaultHtmlPluginOptions = {\n  inject, //  html.inject \n  favicon, //  html.favicon \n  filename, //  output.distPath  entryName \n  template, //  HTML \n  templateParameters, //  html.templateParameters \n  chunks: [entryName],\n  minify: {\n    removeComments: false,\n    useShortDoctype: true,\n    keepClosingSlash: true,\n    collapseWhitespace: true,\n    removeRedundantAttributes: true,\n    removeScriptTypeAttributes: true,\n    removeStyleLinkTypeAttributes: true,\n  },\n};\n\n\n tools.htmlPlugin  html-webpack-plugin  @rspack/plugin-html \n\n\nObject #\n\n tools.htmlPlugin  Object  Object.assign \n\nexport default {\n  tools: {\n    htmlPlugin: {\n      scriptLoading: 'blocking',\n    },\n  },\n};\n\n\n\nFunction #\n\n tools.htmlPlugin  Function \n\n * \n *  entry  entry \n *  return \n\nexport default {\n  tools: {\n    htmlPlugin(config, { entryName, entryValue }) {\n      if (entryName === 'main') {\n        config.scriptLoading = 'blocking';\n      }\n    },\n  },\n};\n\n\n\nBoolean #\n\n tools.htmlPlugin  false html-webpack-plugin \n\nexport default {\n  tools: {\n    htmlPlugin: false,\n  },\n};\n\n\n\ntools.inspector#\n\n *  Object | Function | undefined\n *  undefined\n *   webpack\n\n tools.inspector  webpack  webpack inspector\n\n undefined  webpack-inspector tools.inspector  Object \nFunction\n\n\nObject #\n\n tools.inspector  Object  Object.assign \n\nexport default {\n  tools: {\n    inspector: {\n      //  3333\n      port: 3334,\n    },\n  },\n};\n\n\n\nFunction #\n\n tools.inspector  Function \n\nexport default {\n  tools: {\n    inspector(config) {\n      // \n      config.port = 3333;\n    },\n  },\n};\n\n\n\ntools.less#\n\n *  Object | Function\n * \n\nconst defaultOptions = {\n  lessOptions: {\n    javascriptEnabled: true,\n  },\n  //  CSS  Source Map\n  sourceMap: isDev,\n};\n\n\n tools.less  less-loader \n\n\nObject #\n\n tools.less  Object  Object.assign lessOptions \ndeepMerge \n\nexport default {\n  tools: {\n    less: {\n      lessOptions: {\n        javascriptEnabled: false,\n      },\n    },\n  },\n};\n\n\n\nFunction #\n\n tools.less  Function\n\n\nexport default {\n  tools: {\n    less(config) {\n      //  lessOptions \n      config.lessOptions = {\n        javascriptEnabled: false,\n      };\n    },\n  },\n};\n\n\n\n#\n\naddExcludes#\n\n *  (excludes: RegExp | RegExp[]) => void\n\n less-loader  less \n\nexport default {\n  tools: {\n    less(config, { addExcludes }) {\n      addExcludes(/node_modules/);\n    },\n  },\n};\n\n\n\ntools.minifyCss#\n\n *  Object | Function | undefined\n * \n\nconst defaultOptions = {\n  minimizerOptions: {\n    preset: [\n      'default',\n      {\n        mergeLonghand: false,\n      },\n    ],\n  },\n};\n\n\n *   webpack\n\nBuilder  css-minimizer-webpack-plugin  CSS \ntools.minifyCss  css-minimizer-webpack-plugin \n\n\nObject #\n\n tools.minifyCss  Object  Object.assign \n\n cssnano  preset \n\nexport default {\n  tools: {\n    minifyCss: {\n      minimizerOptions: {\n        preset: require.resolve('cssnano-preset-simple'),\n      },\n    },\n  },\n};\n\n\n\nFunction #\n\n tools.minifyCss  Function \n\nexport default {\n   tools: {\n    minifyCss: options => {\n      options.minimizerOptions = {\n        preset: require.resolve('cssnano-preset-simple'),\n      },\n    }\n  }\n};\n\n\n\ntools.postcss#\n\n *  Object | Function\n * \n\nconst defaultOptions = {\n  postcssOptions: {\n    plugins: [\n      require('postcss-flexbugs-fixes'),\n      require('postcss-custom-properties'),\n      require('postcss-initial'),\n      require('postcss-page-break'),\n      require('postcss-font-variant'),\n      require('postcss-media-minmax'),\n      require('postcss-nesting'),\n      require('autoprefixer')({\n        flexbox: 'no-2009',\n      }),\n    ],\n    //  CSS  Source Map\n    sourceMap: isDev,\n  },\n};\n\n\nBuilder  PostCSS tools.postcss  postcss-loader \n\n\nFunction #\n\n Function \npostcss-loader \n\n PostCSS  postcssOptions.plugins  push \n\nexport default {\n  tools: {\n    postcss: opts => {\n      opts.postcssOptions.plugins.push(require('postcss-px-to-viewport'));\n    },\n  },\n};\n\n\n PostCSS \n\nexport default {\n  tools: {\n    postcss: opts => {\n      const viewportPlugin = require('postcss-px-to-viewport')({\n        viewportWidth: 375,\n      });\n      opts.postcssOptions.plugins.push(viewportPlugin);\n    },\n  },\n};\n\n\ntools.postcss \n\nexport default {\n  tools: {\n    postcss: () => {\n      return {\n        postcssOptions: {\n          plugins: [require('postcss-px-to-viewport')],\n        },\n      };\n    },\n  },\n};\n\n\n\nObject #\n\n Object  Object.assign  Object.assign  plugins\n\n\nexport default {\n  tools: {\n    postcss: {\n      //  `Object.assign`  postcssOptions \n      postcssOptions: {\n        plugins: [require('postcss-px-to-viewport')],\n      },\n    },\n  },\n};\n\n\n\n#\n\naddPlugins#\n\n *  (plugins: PostCSSPlugin | PostCSSPlugin[]) => void\n\n PostCSS  PostCSS  PostCSS \n\nexport default {\n  tools: {\n    postcss: (config, { addPlugins }) => {\n      // \n      addPlugins(require('postcss-preset-env'));\n      // \n      addPlugins([require('postcss-preset-env'), require('postcss-import')]);\n    },\n  },\n};\n\n\nTIP\nBuilder  PostCSS  v8 PostCSS  PostCSS\nv8 \n\n\ntools.pug#\n\n *  true | Object | Function | undefined\n *  false\n *   webpack\n\n Pug \n\n\nBoolean #\n\nBuilder  Pug  tools.pug  true \n\nexport default {\n  tools: {\n    pug: true,\n  },\n};\n\n\n html.template  index.pug \n\n\nObject #\n\n tools.terser  Object  Pug \n\nexport default {\n  tools: {\n    pug: {\n      doctype: 'xml',\n    },\n  },\n};\n\n\n Pug API Reference\n\n\nFunction #\n\n tools.pug  Function \n\nexport default {\n  tools: {\n    pug(config) {\n      config.doctype = 'xml';\n    },\n  },\n};\n\n\n\ntools.sass#\n\n *  Object | Function\n * \n\nconst defaultOptions = {\n  //  CSS  Source Map\n  sourceMap: isDev,\n};\n\n\n tools.sass  sass-loader \n\n\nObject #\n\n tools.sass  Object  Object.assign sassOptions \ndeepMerge \n\nexport default {\n  tools: {\n    sass: {\n      sourceMap: true,\n    },\n  },\n};\n\n\n\nFunction #\n\n tools.sass  Function\n\n\nexport default {\n  tools: {\n    sass(config) {\n      //  sourceMap \n      config.additionalData = async (content, loaderContext) => {\n        // ...\n      };\n    },\n  },\n};\n\n\n\n#\n\naddExcludes#\n\n *  (excludes: RegExp | RegExp[]) => void\n\n sass-loader  sass \n\nexport default {\n  tools: {\n    sass(config, { addExcludes }) {\n      addExcludes(/node_modules/);\n    },\n  },\n};\n\n\n\ntools.styleLoader#\n\n *  Object | Function\n *  {}\n *   webpack\n\n tools.styleLoader  style-loader \n\nBuilder  style-loader output.disableCssExtract \n\n\nObject #\n\n Object  Object.assign \n\nexport default {\n  tools: {\n    styleLoader: {\n      insert: 'head',\n    },\n  },\n};\n\n\n\nFunction #\n\n Function \n\nexport default {\n  tools: {\n    styleLoader: config => {\n      config.insert = 'head';\n      return config;\n    },\n  },\n};\n\n\n\ntools.styledComponents#\n\n *  Object | Function\n * \n\n{\n  displayName: true,\n  //  SSR  isSSR  true\n  ssr: isSSR,\n  //  `pure` \n  pure: isProd,\n  transpileTemplateLiterals: true,\n}\n\n\n *   webpack\n\n babel-plugin-styled-components   Object  Object.assign\n:\n\nexport default {\n  tools: {\n    styledComponents: {\n      pure: false,\n    },\n  },\n};\n\n\n Function \n\nexport default {\n  tools: {\n    styledComponents(config) {\n      //  pure \n      config.pure = false;\n    },\n  },\n};\n\n\n\ntools.terser#\n\n *  Object | Function | undefined\n * \n\nconst defaultTerserOptions = {\n  terserOptions: {\n    mangle: {\n      safari10: true,\n    },\n  },\n};\n\n\n *   webpack\n\nBuilder  terser-webpack-plugin  JavaScript \ntools.terser  terser-webpack-plugin \n\n\nObject #\n\n tools.terser  Object  Object.assign \n\n exclude \n\nexport default {\n  tools: {\n    terser: {\n      exclude: /\\/excludes/,\n    },\n  },\n};\n\n\n\nFunction #\n\n tools.terser  Function \n\nexport default {\n  tools: {\n    terser: opts => {\n      opts.exclude = /\\/excludes/;\n    },\n  },\n};\n\n\n\ntools.tsLoader#\n\n *  Object | Function | undefined\n *  undefined\n *   webpack\n\n ts-loader tools.tsLoader  undefined  ts-loader\nbabel-loader  TypeScript \n\n\nObject #\n\n Object  Object.assign \n\n:\n\n{\n  \"compilerOptions\": {\n    \"target\": \"es5\",\n    \"module\": \"ESNext\"\n  },\n  \"transpileOnly\": true,\n  \"allowTsInNodeModules\": true\n}\n\n\n tools.tsLoader :\n\nexport default {\n  tools: {\n    tsLoader: {\n      allowTsInNodeModules: false,\n    },\n  },\n};\n\n\n\nFunction #\n\n Function  ts-loader\n\n\nexport default {\n  tools: {\n    tsLoader: opts => {\n      opts.allowTsInNodeModules = false;\n    },\n  },\n};\n\n\n\n#\n\ntools.tsLoader  Function \n\naddIncludes#\n\n *  (includes: string | RegExp | Array) => void\n\n src  addIncludes  ts-loader  node_modules :\n\nexport default {\n  tools: {\n    tsLoader: (config, { addIncludes }) => {\n      addIncludes([/node_modules\\/react/]);\n    },\n  },\n};\n\n\naddExcludes#\n\n *  (excludes: string | RegExp | Array) => void\n\n addIncludes  ts-loader \n\n src/example \n\nexport default {\n  tools: {\n    tsLoader: (config, { addExcludes }) => {\n      addExcludes([/src\\/example\\//]);\n    },\n  },\n};\n\n\n\ntools.tsChecker#\n\n *  Object | Function\n * \n\nconst defaultOptions = {\n  typescript: {\n    // avoid OOM issue\n    memoryLimit: 8192,\n    // use tsconfig of user project\n    configFile: tsconfigPath,\n    // use typescript of user project\n    typescriptPath: require.resolve('typescript'),\n  },\n  issue: {\n    exclude: [\n      { file: '**/*.(spec|test).ts' },\n      { file: '**/node_modules/**/*' },\n    ],\n  },\n  logger: {\n    log() {\n      // do nothing\n      // we only want to display error messages\n    },\n    error(message: string) {\n      console.error(message.replace(/ERROR/g, 'Type Error'));\n    },\n  },\n},\n\n\n *   webpack\n\nBuilder  fork-ts-checker-webpack-plugin \noutput.disableTsChecker \n\n\nObject #\n\n Object  Object.assign \n\n\nFunction #\n\n Function \n\n\ntools.webpack#\n\n *  Object | Function | undefined\n *  undefined\n *   webpack\n\ntools.webpack  webpack\n\n> tools.webpackChain  webpack  tools.webpackChain\n\n\nObject #\n\n webpack  webpack-merge \n\nexport default {\n  tools: {\n    webpack: {\n      resolve: {\n        alias: {\n          '@util': 'src/util',\n        },\n      },\n    },\n  },\n};\n\n\n\nFunction #\n\n webpack \n\nexport default {\n  tools: {\n    webpack: config => {\n      config.resolve.alias['@util'] = 'src/util';\n      return config;\n    },\n  },\n};\n\n\n\n\n\n#\n\nenv#\n\n *  'development' | 'production' | 'test'\n\n env  developmentproduction  test\n\nexport default {\n  tools: {\n    webpack: (config, { env }) => {\n      if (env === 'development') {\n        config.devtool = 'cheap-module-eval-source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\nisProd#\n\n *  boolean\n\n isProd  production\n\nexport default {\n  tools: {\n    webpack: (config, { isProd }) => {\n      if (isProd) {\n        config.devtool = 'source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\ntarget#\n\n *  'web' | 'node' | 'modern-web' | 'web-worker'\n\n target \n\nexport default {\n  tools: {\n    webpack: (config, { target }) => {\n      if (target === 'node') {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\nisServer#\n\n *  boolean\n\n node target === 'node'\n\nexport default {\n  tools: {\n    webpack: (config, { isServer }) => {\n      if (isServer) {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\nisWebWorker#\n\n *  boolean\n\n web-worker target === 'web-worker'\n\nexport default {\n  tools: {\n    webpack: (config, { isWebWorker }) => {\n      if (isWebWorker) {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\nwebpack#\n\n *  typeof import('webpack')\n\n webpack \n\nexport default {\n  tools: {\n    webpack: (config, { webpack }) => {\n      config.plugins.push(new webpack.ProgressPlugin());\n      return config;\n    },\n  },\n};\n\n\n\nHtmlWebpackPlugin#\n\n *  typeof import('html-webpack-plugin')\n\n HtmlWebpackPlugin \n\nexport default {\n  tools: {\n    webpackChain: (chain, { HtmlWebpackPlugin }) => {\n      console.log(HtmlWebpackPlugin);\n    },\n  },\n};\n\n\n\naddRules#\n\n *  (rules: RuleSetRule | RuleSetRule[]) => void\n\n webpack rules\n\n\n\nexport default {\n  tools: {\n    webpack: (config, { addRules }) => {\n      // \n      addRules({\n        test: /\\.foo/,\n        loader: require.resolve('foo-loader'),\n      });\n\n      // \n      addRules([\n        {\n          test: /\\.foo/,\n          loader: require.resolve('foo-loader'),\n        },\n        {\n          test: /\\.bar/,\n          loader: require.resolve('bar-loader'),\n        },\n      ]);\n    },\n  },\n};\n\n\n\nprependPlugins#\n\n *  (plugins: WebpackPluginInstance | WebpackPluginInstance[]) => void\n\n webpack \n\nexport default {\n  tools: {\n    webpack: (config, { prependPlugins, webpack }) => {\n      // \n      prependPlugins(\n        new webpack.BannerPlugin({\n          banner: 'hello world!',\n        }),\n      );\n\n      // \n      prependPlugins([new PluginA(), new PluginB()]);\n    },\n  },\n};\n\n\n\nappendPlugins#\n\n *  (plugins: WebpackPluginInstance | WebpackPluginInstance[]) => void\n\n webpack \n\nexport default {\n  tools: {\n    webpack: (config, { appendPlugins, webpack }) => {\n      // \n      appendPlugins([\n        new webpack.BannerPlugin({\n          banner: 'hello world!',\n        }),\n      ]);\n\n      // \n      appendPlugins([new PluginA(), new PluginB()]);\n    },\n  },\n};\n\n\n\nremovePlugin#\n\n *  (name: string) => void\n\n webpack  constructor.name\n\n fork-ts-checker-webpack-plugin\n\nexport default {\n  tools: {\n    webpack: (config, { removePlugin }) => {\n      removePlugin('ForkTsCheckerWebpackPlugin');\n    },\n  },\n};\n\n\n\nmergeConfig#\n\n *  (...configs: WebpackConfig[]) => WebpackConfig\n\n webpack  webpack-merge\n\nexport default {\n  tools: {\n    webpack: (config, { mergeConfig }) => {\n      return mergeConfig(config, {\n        devtool: 'eval',\n      });\n    },\n  },\n};\n\n\n\ntools.webpackChain#\n\n *  Function | undefined\n *  undefined\n *   webpack\n\n tools.webpackChain  webpack  Function \n\n *  webpack-chain  webpack \n * envisProdCHAIN_ID \n\n tools.webpackwebpack-chain  Rule \nPlugin tools.webpackChain  tools.webpack\n\n> tools.webpackChain  tools.webpack tools.webpack \n\n\n#\n\nenv#\n\n *  'development' | 'production' | 'test'\n\n env  developmentproduction  test\n\nexport default {\n  tools: {\n    webpackChain: (chain, { env }) => {\n      if (env === 'development') {\n        chain.devtool('cheap-module-eval-source-map');\n      }\n    },\n  },\n};\n\n\nisProd#\n\n *  boolean\n\n isProd  production\n\nexport default {\n  tools: {\n    webpackChain: (chain, { isProd }) => {\n      if (isProd) {\n        chain.devtool('source-map');\n      }\n    },\n  },\n};\n\n\ntarget#\n\n *  'web' | 'node' | 'modern-web' | 'web-worker'\n\n target \n\nexport default {\n  tools: {\n    webpackChain: (chain, { target }) => {\n      if (target === 'node') {\n        // ...\n      }\n    },\n  },\n};\n\n\nisServer#\n\n *  boolean\n\n node target === 'node'\n\nexport default {\n  tools: {\n    webpackChain: (chain, { isServer }) => {\n      if (isServer) {\n        // ...\n      }\n    },\n  },\n};\n\n\nisWebWorker#\n\n *  boolean\n\n web-worker target === 'web-worker'\n\nexport default {\n  tools: {\n    webpackChain: (chain, { isWebWorker }) => {\n      if (isWebWorker) {\n        // ...\n      }\n    },\n  },\n};\n\n\nwebpack#\n\n *  typeof import('webpack')\n\n webpack \n\nexport default {\n  tools: {\n    webpackChain: (chain, { webpack }) => {\n      chain.plugin('my-progress').use(webpack.ProgressPlugin);\n    },\n  },\n};\n\n\n\nHtmlWebpackPlugin#\n\n *  typeof import('html-webpack-plugin')\n\n HtmlWebpackPlugin \n\nexport default {\n  tools: {\n    webpackChain: (chain, { HtmlWebpackPlugin }) => {\n      console.log(HtmlWebpackPlugin);\n    },\n  },\n};\n\n\nCHAIN_ID#\n\nBuilder  Chain ID ID  Rule  Plugin\n\nCHAIN_ID.RULE#\n\nID           \nRULE.MJS      mjs \nRULE.JS       js \nRULE.TS       ts \nRULE.CSS      css \nRULE.LESS     less \nRULE.SASS     sass \nRULE.PUG      pug \nRULE.TOML     toml \nRULE.YAML     yaml \nRULE.FONT    \nRULE.IMAGE   \nRULE.MEDIA   \n\n\nCHAIN_ID.ONE_OF#\n\n ONE_OF.XXX \n\nID                  \nONE_OF.SVG           SVG  data URI \nONE_OF.SVG_URL       SVG \nONE_OF.SVG_INLINE    SVG  data URI  bundle \nONE_OF.SVG_ASSETS    SVG  data URI \n\n\nCHAIN_ID.USE#\n\n USE.XXX  loader\n\nID                     \nUSE.TS                  ts-loader\nUSE.CSS                 css-loader\nUSE.LESS                less-loader\nUSE.SASS                sass-loader\nUSE.PUG                 pug-loader\nUSE.TOML                toml-loader\nUSE.YAML                yaml-loader\nUSE.FILE                file-loader\nUSE.URL                 url-loader\nUSE.SVGR                @svgr/webpack\nUSE.BABEL               babel-loader\nUSE.STYLE               style-loader\nUSE.POSTCSS             postcss-loader\nUSE.MARKDOWN            markdown-loader\nUSE.CSS_MODULES_TS      css-modules-typescript-loader\nUSE.MINI_CSS_EXTRACT    mini-css-extract-plugin.loader\n\n\nCHAIN_ID.PLUGIN#\n\n PLUGIN.XXX  plugin\n\nID                             \nPLUGIN.HMR                      HotModuleReplacementPlugin\nPLUGIN.COPY                     CopyWebpackPlugin\nPLUGIN.HTML                     HtmlWebpackPlugin entry\n                               ${PLUGIN.HTML}-${entryName}\nPLUGIN.DEFINE                   DefinePlugin\nPLUGIN.IGNORE                   IgnorePlugin\nPLUGIN.BANNER                   BannerPlugin\nPLUGIN.PROGRESS                 Webpackbar\nPLUGIN.APP_ICON                 AppIconPlugin\nPLUGIN.LOADABLE                 LoadableWebpackPlugin\nPLUGIN.MANIFEST                 WebpackManifestPlugin\nPLUGIN.TS_CHECKER               ForkTsCheckerWebpackPlugin\nPLUGIN.INLINE_HTML              InlineChunkHtmlPlugin\nPLUGIN.BUNDLE_ANALYZER          WebpackBundleAnalyzer\nPLUGIN.BOTTOM_TEMPLATE          BottomTemplatePlugin\nPLUGIN.MINI_CSS_EXTRACT         MiniCssExtractPlugin\nPLUGIN.REACT_FAST_REFRESH       ReactFastRefreshPlugin\nPLUGIN.NODE_POLYFILL_PROVIDE    node polyfill  ProvidePlugin\nPLUGIN.INSPECTOR                @modern-js/inspector-webpack-plugin\nPLUGIN.SUBRESOURCE_INTEGRITY    webpack-subresource-integrity\nPLUGIN.ASSETS_RETRY             Builder  webpack  WebpackAssetsRetryPlugin\nPLUGIN.AUTO_SET_ROOT_SIZE       Builder  AutoSetRootSizePlugin\n\n\nCHAIN_ID.MINIMIZER#\n\n MINIMIZER.XXX \n\nID                  \nMINIMIZER.JS         TerserWebpackPlugin\nMINIMIZER.CSS        CssMinimizerWebpackPlugin\nMINIMIZER.ESBUILD    ESBuildPlugin\nMINIMIZER.SWC        SwcWebpackPlugin\n\n\n WebpackChain #\n\n webpack-chain API  webpack-chain \n\n// loader#\n\nexport default {\n  tools: {\n    webpackChain: (chain, { CHAIN_ID }) => {\n      //  loader\n      chain.module\n        .rule('md')\n        .test(/\\.md$/)\n        .use('md-loader')\n        .loader('md-loader');\n\n      //  loader\n      chain.module\n        .rule(CHAIN_ID.RULE.JS)\n        .use(CHAIN_ID.USE.BABEL)\n        .tap(options => {\n          options.plugins.push('babel-plugin-xxx');\n          return options;\n        });\n\n      //  loader\n      chain.module.rule(CHAIN_ID.RULE.JS).uses.delete(CHAIN_ID.USE.BABEL);\n    },\n  },\n};\n\n\n// plugin#\n\nexport default {\n  tools: {\n    webpackChain: (chain, { webpack, CHAIN_ID }) => {\n      // \n      chain.plugin('custom-define').use(webpack.DefinePlugin, [\n        {\n          'process.env': {\n            NODE_ENV: JSON.stringify(process.env.NODE_ENV),\n          },\n        },\n      ]);\n\n      // \n      chain.plugin(CHAIN_ID.PLUGIN.HMR).tap(options => {\n        options[0].fullBuildTimeout = 200;\n        return options;\n      });\n\n      // \n      chain.plugins.delete(CHAIN_ID.PLUGIN.HMR);\n    },\n  },\n};\n\n\n\ntools.rspack#\n\n *  Object | Function | undefined\n *  undefined\n *   Rspack\n\ntools.rspack  Rspack\n\n\nObject #\n\n Rspack  webpack-merge \n\nexport default {\n  tools: {\n    rspack: {\n      resolve: {\n        alias: {\n          '@util': 'src/util',\n        },\n      },\n    },\n  },\n};\n\n\n\nFunction #\n\n Rspack \n\nexport default {\n  tools: {\n    rspack: config => {\n      config.resolve.alias['@util'] = 'src/util';\n      return config;\n    },\n  },\n};\n\n\n\n\n\n#\n\nenv#\n\n *  'development' | 'production' | 'test'\n\n env  developmentproduction  test\n\nexport default {\n  tools: {\n    rspack: (config, { env }) => {\n      if (env === 'development') {\n        config.devtool = 'cheap-module-eval-source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\nisProd#\n\n *  boolean\n\n isProd  production\n\nexport default {\n  tools: {\n    rspack: (config, { isProd }) => {\n      if (isProd) {\n        config.devtool = 'source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\ntarget#\n\n *  'web' | 'node' | 'modern-web' | 'web-worker'\n\n target \n\nexport default {\n  tools: {\n    rspack: (config, { target }) => {\n      if (target === 'node') {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\nisServer#\n\n *  boolean\n\n node target === 'node'\n\nexport default {\n  tools: {\n    rspack: (config, { isServer }) => {\n      if (isServer) {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\nisWebWorker#\n\n *  boolean\n\n web-worker target === 'web-worker'\n\nexport default {\n  tools: {\n    rspack: (config, { isWebWorker }) => {\n      if (isWebWorker) {\n        // ...\n      }\n      return config;\n    },\n  },\n};\n\n\n\naddRules#\n\n *  (rules: RuleSetRule | RuleSetRule[]) => void\n\n Rspack rules\n\n\n\nexport default {\n  tools: {\n    rspack: (config, { addRules }) => {\n      // \n      addRules({\n        test: /\\.foo/,\n        loader: require.resolve('foo-loader'),\n      });\n\n      // \n      addRules([\n        {\n          test: /\\.foo/,\n          loader: require.resolve('foo-loader'),\n        },\n        {\n          test: /\\.bar/,\n          loader: require.resolve('bar-loader'),\n        },\n      ]);\n    },\n  },\n};\n\n\n\nprependPlugins#\n\n *  (plugins: RspackPluginInstance | RspackPluginInstance[]) => void\n\n Rspack \n\nexport default {\n  tools: {\n    rspack: (config, { prependPlugins }) => {\n      // \n      prependPlugins(new PluginA());\n\n      // \n      prependPlugins([new PluginA(), new PluginB()]);\n    },\n  },\n};\n\n\n\nappendPlugins#\n\n *  (plugins: RspackPluginInstance | RspackPluginInstance[]) => void\n\n Rspack \n\nexport default {\n  tools: {\n    rspack: (config, { appendPlugins }) => {\n      // \n      appendPlugins([new PluginA()]);\n\n      // \n      appendPlugins([new PluginA(), new PluginB()]);\n    },\n  },\n};\n\n\n\nremovePlugin#\n\n *  (name: string) => void\n\n Rspack  constructor.name\n\n webpack-bundle-analyzer\n\nexport default {\n  tools: {\n    rspack: (config, { removePlugin }) => {\n      removePlugin('BundleAnalyzerPlugin');\n    },\n  },\n};\n\n\n\nmergeConfig#\n\n *  (...configs: RspackConfig[]) => RspackConfig\n\n Rspack  webpack-merge\n\nexport default {\n  tools: {\n    rspack: (config, { mergeConfig }) => {\n      return mergeConfig(config, {\n        devtool: 'eval',\n      });\n    },\n  },\n};\n","frontmatter":{"extractApiHeaders":[2]}},{"id":177,"title":"API","routePath":"/builder/api/","lang":"zh","toc":[],"domain":"","content":"#","frontmatter":{"overview":true}},{"id":178,"title":"Plugin Core","routePath":"/builder/api/plugin-core","lang":"zh","toc":[{"text":"BuilderPlugin","id":"builderplugin","depth":2},{"text":"BuilderPluginAPI","id":"builderpluginapi","depth":2},{"text":" webpack-provider ","id":"-webpack-provider-","depth":3},{"text":" rspack-provider ","id":"-rspack-provider-","depth":3},{"text":" webpack-provider  rspack-provider ","id":"-webpack-provider--rspack-provider-","depth":3},{"text":"api.context","id":"api.context","depth":2},{"text":"api.getBuilderConfig","id":"api.getbuilderconfig","depth":2},{"text":"api.getNormalizedConfig","id":"api.getnormalizedconfig","depth":2},{"text":"api.isPluginExists","id":"api.ispluginexists","depth":2},{"text":"api.getHTMLPaths","id":"api.gethtmlpaths","depth":2}],"domain":"","content":"#\n\n Builder  API\n\n\nBuilderPlugin#\n\n\n\n * name\n * setup\n\ntype BuilderPlugin = {\n  name: string;\n  setup: (api: API) => Promise | void;\n};\n\n\n @modern-js/builder \n\n\n\nexport default (): BuilderPlugin => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.onAfterBuild(() => {\n      console.log('after build!');\n    });\n  },\n});\n\n\n\nBuilderPluginAPI#\n\n API  API \n\n Plugin Hooks \n\n webpack-provider  rspack-provider BuilderPluginAPI\n\n\n\n webpack-provider #\n\n webpack-provider  @modern-js/builder-webpack-provider \nBuilderPluginAPI\n\n\n\n\nexport default (): BuilderPlugin => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.modifyWebpackConfig(config => {\n      config.devtool = false;\n    });\n  },\n});\n\n\n\n rspack-provider #\n\n rspack-provider  @modern-js/builder-rspack-provider \nBuilderPluginAPI\n\n\n\n\nexport default (): BuilderPlugin => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.modifyRspackConfig(config => {\n      config.devtool = false;\n    });\n  },\n});\n\n\n\n webpack-provider  rspack-provider #\n\n webpack-provider  rspack-provider  @modern-js/builder-shared\n DefaultBuilderPlugin\n\n webpack  Rspack  webpack  Rspack  api\nmodifyWebpackConfig  modifyRspackConfig\n\n modifyBundlerChain  webpack  Rspack \n\n\n\n\nexport default (): BuilderPlugin => ({\n  name: 'builder-plugin-foo',\n\n  setup: api => {\n    api.modifyBundlerChain(chain => {\n      chain.devtool(false);\n    });\n  },\n});\n\n\n\napi.context#\n\napi.context \n\napi.context  builder.context  builder.context\n\n * Example\n\nconst builderPluginFoo = () => ({\n  setup(api) {\n    console.log(api.context.distPath);\n  }\n);\n\n\n\napi.getBuilderConfig#\n\n Builder  modifyBuilderConfig \n\n * \n\nfunction GetBuilderConfig(): Readonly;\n\n\n * Example\n\nconst builderPluginFoo = () => ({\n  setup(api) {\n    const config = api.getBuilderConfig();\n    console.log(config.html?.title);\n  }\n);\n\n\n\napi.getNormalizedConfig#\n\n Builder  modifyBuilderConfig \n\n getBuilderConfig  config.html  undefined\n\n\n\n\n * \n\nfunction GetNormalizedConfig(): Readonly;\n\n\n * Example\n\nconst builderPluginFoo = () => ({\n  setup(api) {\n    const config = api.getNormalizedConfig();\n    console.log(config.html.title);\n  }\n);\n\n\n\napi.isPluginExists#\n\n\n\n * \n\nfunction IsPluginExists(pluginName: string): boolean;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    console.log(api.isPluginExists('builder-plugin-foo'));\n  },\n});\n\n\n\napi.getHTMLPaths#\n\n HTML \n\n key  entry value  HTML \n\n * \n\nfunction GetHTMLPaths(): Record;\n\n\n * Example\n\nconst builderPluginFoo = () => ({\n  setup(api) {\n    api.modifyWebpackChain(() => {\n      const htmlPaths = api.getHTMLPaths();\n      console.log(htmlPaths); // { main: 'html/main/index.html' };\n    });\n  }\n);\n","frontmatter":{"extractApiHeaders":[2]}},{"id":179,"title":"Plugin Hooks","routePath":"/builder/api/plugin-hooks","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":"modifyBuilderConfig","id":"modifybuilderconfig","depth":3},{"text":"modifyBundlerChain ","id":"modifybundlerchain-","depth":3},{"text":"modifyWebpackChain","id":"modifywebpackchain","depth":3},{"text":"modifyWebpackConfig","id":"modifywebpackconfig","depth":3},{"text":"modifyRspackConfig","id":"modifyrspackconfig","depth":3},{"text":"onBeforeCreateCompiler","id":"onbeforecreatecompiler","depth":3},{"text":"onAfterCreateCompiler","id":"onaftercreatecompiler","depth":3},{"text":"","id":"","depth":2},{"text":"onBeforeBuild","id":"onbeforebuild","depth":3},{"text":"onAfterBuild","id":"onafterbuild","depth":3},{"text":"","id":"","depth":2},{"text":"onBeforeStartDevServer","id":"onbeforestartdevserver","depth":3},{"text":"onAfterStartDevServer","id":"onafterstartdevserver","depth":3},{"text":"onDevCompileDone","id":"ondevcompiledone","depth":3},{"text":"","id":"","depth":2},{"text":"onExit","id":"onexit","depth":3}],"domain":"","content":"#\n\n Builder \n\n\n#\n\n\n\n * modifyBuilderConfig Builder \n * modifyBundlerChain () chain api  webpack / Rspack \n * modifyWebpackChain webpack chain \n * modifyWebpackConfig webpack \n * modifyRspackConfig Rspack \n * onBeforeCreateCompiler compiler \n * onAfterCreateCompiler compiler \n\n build \n\n * onBeforeBuild\n * onAfterBuild\n\n startDevServer \n\n * onBeforeStartDevServer\n * onAfterStartDevServer\n * onDevCompileDone\n\n\n\n * onExit\n\n\n#\n\n\nmodifyBuilderConfig#\n\n Builder  config \n\n * \n\ntype ModifyWebpackChainUtils = {\n  mergeBuilderConfig: typeof mergeBuilderConfig;\n};\n\nfunction ModifyBuilderConfig(\n  callback: (\n    config: BuilderConfig,\n    utils: ModifyWebpackChainUtils,\n  ) => PromiseOrNot,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.modifyBuilderConfig((config, { mergeBuilderConfig }) => {\n      config.html = config.html || {};\n      config.html.title = 'Hello World!';\n      return mergeBuilderConfig(config, {\n        source: { preEntry: 'foo.js' },\n      });\n    });\n  },\n});\n\n\n\nmodifyBundlerChain #\n\n BundlerChain\n\nBundler chain  webpack chain  webpack chain API webpack \nRspack \n\n bundler chain  webpack  Rspack bundler chain \nwebpack  Rspack  devtool (webpack  Rspack  devtool\n)Rspack  webpack \n\nmodifyBundlerChain  bundler chain  webpack / Rspack \nwebpack-provider  rspack-provider  hook\n\n * \n\ntype ModifyBunlderChainUtils = {\n  env: NodeEnv;\n  isProd: boolean;\n  target: BuilderTarget;\n  isServer: boolean;\n  isWebWorker: boolean;\n  CHAIN_ID: ChainIdentifier;\n  HtmlPlugin: typeof import('html-webpack-plugin');\n};\n\nfunction ModifyBundlerChain(\n  callback: (\n    chain: BundlerChain,\n    utils: ModifyBunlderChainUtils,\n  ) => Promise | void,\n): void;\n\n\n * Example\n\n\n\nexport default () => ({\n  setup: api => {\n    api.modifyBundlerChain((chain, utils) => {\n      if (utils.env === 'development') {\n        chain.devtool('eval');\n      }\n\n      chain.plugin('bundle-analyze').use(BundleAnalyzerPlugin);\n    });\n  },\n});\n\n\n\nmodifyWebpackChain#\n\n webpack chain  webpack  webpack-provider \n\n * \n\ntype ModifyWebpackChainUtils = {\n  env: NodeEnv;\n  isProd: boolean;\n  target: BuilderTarget;\n  webpack: typeof import('webpack');\n  isServer: boolean;\n  isWebWorker: boolean;\n  CHAIN_ID: ChainIdentifier;\n  getCompiledPath: (name: string) => string;\n  HtmlWebpackPlugin: typeof import('html-webpack-plugin');\n};\n\nfunction ModifyWebpackChain(\n  callback: (\n    chain: WebpackChain,\n    utils: ModifyWebpackChainUtils,\n  ) => Promise | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.modifyWebpackChain((chain, utils) => {\n      if (utils.env === 'development') {\n        chain.devtool('eval');\n      }\n    });\n  },\n});\n\n\n\nmodifyWebpackConfig#\n\n webpack  config \nwebpack-provider \n\n modifyWebpackChain \n\n * \n\ntype ModifyWebpackConfigUtils = {\n  env: NodeEnv;\n  isProd: boolean;\n  target: BuilderTarget;\n  webpack: typeof import('webpack');\n  isServer: boolean;\n  isWebWorker: boolean;\n  CHAIN_ID: ChainIdentifier;\n  getCompiledPath: (name: string) => string;\n  HtmlWebpackPlugin: typeof import('html-webpack-plugin');\n  addRules: (rules: RuleSetRule | RuleSetRule[]) => void;\n  prependPlugins: (\n    plugins: WebpackPluginInstance | WebpackPluginInstance[],\n  ) => void;\n  appendPlugins: (\n    plugins: WebpackPluginInstance | WebpackPluginInstance[],\n  ) => void;\n  removePlugin: (pluginName: string) => void;\n};\n\nfunction ModifyWebpackConfig(\n  callback: (\n    config: WebpackConfig,\n    utils: ModifyWebpackConfigUtils,\n  ) => Promise | WebpackConfig | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.modifyWebpackConfig((config, utils) => {\n      if (utils.env === 'development') {\n        config.devtool = 'eval';\n      }\n    });\n  },\n});\n\n\n\nmodifyRspackConfig#\n\n Rspack  config \nrspack-provider \n\n * \n\ntype ModifyRspackConfigUtils = {\n  env: NodeEnv;\n  isProd: boolean;\n  target: BuilderTarget;\n  isServer: boolean;\n  isWebWorker: boolean;\n  getCompiledPath: (name: string) => string;\n};\n\nfunction ModifyRspackConfig(\n  callback: (\n    config: RspackConfig,\n    utils: ModifyRspackConfigUtils,\n  ) => Promise | RspackConfig | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.modifyRspackConfig((config, utils) => {\n      if (utils.env === 'development') {\n        config.devtool = 'eval';\n      }\n    });\n  },\n});\n\n\n\nonBeforeCreateCompiler#\n\n compiler  builder.startDevServerbuilder.build \nbuilder.createCompiler  bundlerConfigs \n\n * \n\nfunction OnBeforeCreateCompiler(\n  callback: (params: {\n    bundlerConfigs: WebpackConfig[] | RspackConfig[];\n  }) => Promise | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onBeforeCreateCompiler(({ bundlerConfigs }) => {\n      console.log('the bundler config is ', bundlerConfigs);\n    });\n  },\n});\n\n\n\nonAfterCreateCompiler#\n\n compiler  builder.startDevServerbuilder.build \nbuilder.createCompiler  compiler  compiler \n\n * \n\nfunction OnAfterCreateCompiler(callback: (params: {\n  compiler: Compiler | MultiCompiler;\n}) => Promise | void;): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onAfterCreateCompiler(({ compiler }) => {\n      console.log('the compiler is ', compiler);\n    });\n  },\n});\n\n\n\n#\n\n\nonBeforeBuild#\n\n bundlerConfigs \n\n * \n\nfunction OnBeforeBuild(\n  callback: (params: {\n    bundlerConfigs?: WebpackConfig[] | RspackConfig[];\n  }) => Promise | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onBeforeBuild(({ bundlerConfigs }) => {\n      console.log('the bundler config is ', bundlerConfigs);\n    });\n  },\n});\n\n\n\nonAfterBuild#\n\n stats \n\n * \n\nfunction OnAfterBuild(\n  callback: (params: { stats?: Stats | MultiStats }) => Promise | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onAfterBuild(({ stats }) => {\n      console.log(stats?.toJson());\n    });\n  },\n});\n\n\n\n#\n\n\nonBeforeStartDevServer#\n\n\n\n * \n\nfunction OnBeforeStartDevServer(callback: () => Promise | void): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onBeforeStartDevServer(() => {\n      console.log('before start!');\n    });\n  },\n});\n\n\n\nonAfterStartDevServer#\n\n port \n\n * \n\nfunction OnAfterStartDevServer(\n  callback: (params: { port: number }) => Promise | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onAfterStartDevServer(({ port }) => {\n      console.log('this port is: ', port);\n    });\n  },\n});\n\n\n\nonDevCompileDone#\n\n isFirstCompile \n\n * \n\nfunction OnDevCompileDone(\n  callback: (params: { isFirstCompile: boolean }) => Promise | void,\n): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onDevCompileDone(({ isFirstCompile }) => {\n      if (isFirstCompile) {\n        console.log('first compile!');\n      } else {\n        console.log('re-compile!');\n      }\n    });\n  },\n});\n\n\n\n#\n\n\nonExit#\n\n\n\n * \n\nfunction OnExit(callback: () => void): void;\n\n\n * Example\n\nexport default () => ({\n  setup: api => {\n    api.onExit(() => {\n      console.log('exit!');\n    });\n  },\n});\n","frontmatter":{"extractApiHeaders":[2]}},{"id":276,"title":"","routePath":"/builder/guide/advanced/alias","lang":"zh","toc":[{"text":" source.alias ","id":"-source.alias-","depth":2},{"text":" tsconfig.json  paths ","id":"-tsconfig.json--paths-","depth":2}],"domain":"","content":"#\n\nalias\n\n src/common/request.ts  @request ``\n import \n\n Builder :\n\n *  source.alias \n *  tsconfig.json  paths \n\n\n source.alias #\n\nsource.alias  webpack  resolve.alias \n\n\n\nexport default {\n  source: {\n    alias: {\n      '@common': './src/common',\n    },\n  },\n};\n\n\n Builder \n\n alias \n\nexport default {\n  source: {\n    alias: alias => {\n      alias['@common'] = './src/common';\n      return alias;\n    },\n  },\n};\n\n\n\n tsconfig.json  paths #\n\n source.alias tsconfig.json  paths  TypeScript\n\n\n\n\n{\n  \"compilerOptions\": {\n    \"paths\": {\n      \"@common/*\": [\"./src/common/*\"]\n    }\n  }\n}\n\n\n\npaths  source.alias","frontmatter":{}},{"id":277,"title":"","routePath":"/builder/guide/advanced/browser-compatibility","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":" API ","id":"-api-","depth":3},{"text":"","id":"","depth":3},{"text":"API Polyfill","id":"api-polyfill","depth":3},{"text":"","id":"","depth":2},{"text":"","id":"","depth":3},{"text":"","id":"","depth":3},{"text":"","id":"","depth":3},{"text":"Polyfill ","id":"polyfill-","depth":2},{"text":"entry ","id":"entry-","depth":3},{"text":"usage ","id":"usage-","depth":3},{"text":" Polyfill","id":"-polyfill","depth":3}],"domain":"","content":"#\n\n Builder \n\n\n#\n\n browserslist \n\n *   \n\n *  Builder  JavaScript  CSS \n   polyfill  ECMAScript \n\n\n\n\n#\n\n\n\n\n API #\n\n API  API \n\nBuilder  polyfill  API \n\n>  API \n> API API  API \n\n\n#\n\n JavaScript\n\n\n *  const foo = 1 const \n *  foo?.bar?.baz ?. \n *  async function () {} async \n\n AST \n\n IE  Node.js \n\nconst foo = {};\nfoo?.bar();\n\n\n Node.js \n\nSyntaxError: Unexpected token .\n  at Object.exports.runInThisContext (vm.js:73:16)\n  at Object. ([eval]-wrapper:6:22)\n  at Module._compile (module.js:460:26)\n  at evalScript (node.js:431:25)\n  at startup (node.js:90:7)\n  at node.js:814:3\n\n\nSyntaxError\n\n polyfill  shim\n\n\n\n\nvar foo = {};\nfoo === null || foo === void 0 ? void 0 : foo.bar();\n\n\n\n\n AST  SSR  SSG\n\n\n AST  AST \n\n\nAPI Polyfill#\n\nJavaScript  Rust Rust  JavaScript\n\n\n\n\nvar str = 'Hello world!';\nconsole.log(str.notExistedMethod());\n\n\n AST String.prototype \nnotExistedMethod \n\nUncaught TypeError: str.notExistedMethod is not a function\n  at :2:17\n\n\n ECMAScript  String.prototype.replaceAll  ES2021\n 2021  String.prototype  replaceAll\n Chrome \n\n'abc'.replaceAll('abc', 'xyz');\n\n\n String.prototype  replaceAll  String.prototype\n replaceAll \n\n//  polyfill \nif (!String.prototype.replaceAll) {\n  String.prototype.replaceAll = function (str, newStr) {\n    // If a regex pattern\n    if (\n      Object.prototype.toString.call(str).toLowerCase() === '[object regexp]'\n    ) {\n      return this.replace(str, newStr);\n    }\n    // If a string\n    return this.replace(new RegExp(str, 'g'), newStr);\n  };\n}\n\n\n>  API  polyfill\n\n\n#\n\n Builder \n\n * \n *  npm \n *  monorepo \n\nBuilder \n\n\n\n * \n * \n * \n\n\n#\n\n\n\n\n#\n\n Builder  source.include  Builder\n\n\n query-string  npm \n\n\n\nexport default {\n  source: {\n    include: [/\\/query-string\\//],\n  },\n};\n\n\n source.include \n\n\n#\n\n source.include \n\n monorepo  packages \n\n\n\nexport default {\n  source: {\n    include: [\n      // :\n      //  Monorepo  package \n      path.resolve(__dirname, '../../packages'),\n\n      // :\n      //  Monorepo  package \n      // \n      path.resolve(__dirname, '../../packages/xxx/src'),\n    ],\n  },\n};\n\n\n\nPolyfill #\n\nBuilder  babel  SWC  JavaScript \ncore-js@babel/runtime@swc/helpers  polyfill \n\n polyfill Builder  output.polyfill  polyfill\n\n\n\nentry #\n\nentry \n\n entry Builder  core-js\n polyfill  polyfill\n polyfill \n\nentry \n\nexport default {\n  output: {\n    polyfill: 'entry',\n  },\n};\n\n\n\nusage #\n\nusage  core-js polyfill\n\n usage Builder  polyfill\n\n Map:\n\nvar b = new Map();\n\n\n Map  polyfill\n\nimport 'core-js/modules/es.map';\nvar b = new Map();\n\n\n polyfill  polyfill\n polyfill \nsource.include \n\nusage \n\nexport default {\n  output: {\n    polyfill: 'usage',\n  },\n};\n\n\n\n Polyfill#\n\n output.polyfill  'off'  polyfill \n\nexport default {\n  output: {\n    polyfill: 'off',\n  },\n};\n\n\n source.preEntry  polyfill ","frontmatter":{}},{"id":278,"title":"","routePath":"/builder/guide/advanced/browserslist","lang":"zh","toc":[{"text":" Browserslist","id":"-browserslist","depth":2},{"text":" Browserslist","id":"-browserslist","depth":2},{"text":"","id":"","depth":3},{"text":" output.overrideBrowserslist ","id":"-output.overridebrowserslist-","depth":3},{"text":"","id":"","depth":2},{"text":" H5 ","id":"-h5-","depth":3},{"text":" PC ","id":"-pc-","depth":3},{"text":"Browserslist ","id":"browserslist-","depth":2},{"text":"Web ","id":"web-","depth":3},{"text":"Node ","id":"node-","depth":3},{"text":"Web Worker ","id":"web-worker-","depth":3},{"text":"Modern Web ","id":"modern-web-","depth":3},{"text":"","id":"","depth":2}],"domain":"","content":"#\n\nBuilder  Browserslist  Web \n\n\n Browserslist#\n\n ECMAScript  CSS  Web \n\nBrowserslist  Web Browserslist \nAutoprefixer, Babel, ESLint, PostCSSSWC  Webpack \n\n Browserslist Builder  JavaScript  CSS \npolyfill  polyfills\n\n IE11 Builder  ES5 core-js  IE11  polyfill\n\n polyfill\npolyfill \nArray.prototype.flat()  polyfill \n\n\n Browserslist#\n\n package.json  .browserslistrc  Browserslist \n\n\n#\n\n package.json  browserslist \n\n{\n  \"browserslist\": [\n    \"iOS >= 9\",\n    \"Android >= 4.4\",\n    \"last 2 versions\",\n    \"> 0.2%\",\n    \"not dead\"\n  ]\n}\n\n\n .browserslistrc \n\niOS >= 9\nAndroid >= 4.4\nlast 2 versions\n> 0.2%\nnot dead\n\n\n\n output.overrideBrowserslist #\n\nBuilder  output.overrideBrowserslist  Browserslist \n\nexport default {\n  output: {\n    overrideBrowserslist: [\n      'iOS >= 9',\n      'Android >= 4.4',\n      'last 2 versions',\n      '> 0.2%',\n      'not dead',\n    ],\n  },\n};\n\n\n overrideBrowserslist \nkey \n\n web  node \n\nexport default {\n  output: {\n    overrideBrowserslist: {\n      web: [\n        'iOS >= 9',\n        'Android >= 4.4',\n        'last 2 versions',\n        '> 0.2%',\n        'not dead',\n      ],\n      node: ['node >= 14'],\n    },\n  },\n};\n\n\n .browserslistrc  overrideBrowserslist \n.browserslistrc \n\n\n#\n\n\n\n\n H5 #\n\n H5  iOS  Android  Browserslist \n\niOS >= 9\nAndroid >= 4.4\nlast 2 versions\n> 0.2%\nnot dead\n\n\n ES5  browserslist.dev\n\n\n\n H5  ES6  Browserslist \n\niOS >= 10\nChrome >= 51\n> 0.5%\nnot dead\nnot op_mini all\n\n\n\n PC #\n\n PC  IE 11  Browserslist \n\n> 0.5%\nnot dead\nIE 11\n\n\n ES5  browserslist.dev\n\n IE 11  Browserslist  ES Modules \n\nchrome >= 61\nedge >= 16\nfirefox >= 60\nsafari >= 11\nios_saf >= 11\n\n\n\nBrowserslist #\n\nBuilder  Browserslist \nBrowserslist\n\n\nWeb #\n\nWeb \n\n> 0.01%\nnot dead\nnot op_mini all\n\n\nJavaScript  ES5 \n\n\nNode #\n\nNode  Node.js 14.0 \n\nnode >= 14\n\n\n\nWeb Worker #\n\nWeb Worker  Web \n\n> 0.01%\nnot dead\nnot op_mini all\n\n\n\nModern Web #\n\nModern Web  ES Modules \n\nchrome >= 61\nedge >= 16\nfirefox >= 60\nsafari >= 11\nios_saf >= 11\n\n\n\n#\n\n API  caniuse \n\n Promise  caniuse  Promise\n\n\n\nPromise  Chrome 33  iOS 8  IE 11 ","frontmatter":{}},{"id":279,"title":" webpack ","routePath":"/builder/guide/advanced/custom-webpack-config","lang":"zh","toc":[{"text":" webpack ","id":"-webpack-","depth":2},{"text":" webpack-chain","id":"-webpack-chain","depth":2},{"text":"tools.webpackChain ","id":"tools.webpackchain-","depth":3},{"text":"webpack-chain ","id":"webpack-chain-","depth":2},{"text":"webpack-chain ","id":"webpack-chain-","depth":3},{"text":"webpack-chain id ","id":"webpack-chain-id-","depth":3},{"text":"webpack-chain ","id":"webpack-chain-","depth":2},{"text":"// loader","id":"//-loader","depth":3},{"text":"// plugin","id":"//-plugin","depth":3},{"text":"","id":"","depth":3}],"domain":"","content":"#\n\nBuilder  webpack  webpack-chain  webpack \n\n\n webpack #\n\n tools.webpack  webpack \n\nexport default {\n  tools: {\n    webpack: (config, { env }) => {\n      if (env === 'development') {\n        config.devtool = 'cheap-module-eval-source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\n\n webpack  tools.webpack Builder  webpack plugins \nloaders tools.webpackChain \n\n\n webpack-chain#\n\nwebpack-chain  webpack  webpack webpack-chain\n id  Rule  Plugin.\n\n\ntools.webpackChain #\n\nBuilder  tools.webpackChain  webpack-chain\n\ntools.webpackChain  Function \n\n *  webpack-chain  webpack \n *  envisProdCHAIN_ID \n\n\n\nexport default {\n  tools: {\n    webpackChain: (chain, { env }) => {\n      if (env === 'development') {\n        chain.devtool('cheap-module-eval-source-map');\n      }\n    },\n  },\n};\n\n\n\nwebpack-chain #\n\n webpack-chain  webpack \n\n\nwebpack-chain #\n\nwebpack-chain  RuleLoaderPluginMinimizer  id\nid\n\nBuilder  id  CHAIN_ID  id Loader \nPlugin webpack \n\n CHAIN_ID.PLUGIN.HTML  HTML \n\nexport default {\n  tools: {\n    webpackChain: (chain, { webpack, CHAIN_ID }) => {\n      //\n      chain.plugins.delete(CHAIN_ID.PLUGIN.HTML);\n    },\n  },\n};\n\n\n\nwebpack-chain id #\n\nCHAIN_ID  id\n\nCHAIN_ID                                    \nCHAIN_ID.PLUGIN           plugins[i]                webpack \nCHAIN_ID.RULE             module.rules[i]           webpack  Rule\nCHAIN_ID.USE              module.rules[i].loader    webpack  Loader\nCHAIN_ID.MINIMIZER        optimization.minimizer    webpack \nCHAIN_ID.RESOLVE_PLUGIN   resolve.plugins[i]        webpack  Resolve \n\n\nwebpack-chain #\n\n\n// loader#\n\nexport default {\n  tools: {\n    webpackChain: (chain, { CHAIN_ID }) => {\n      //  loader\n      chain.module\n        .rule('md')\n        .test(/\\.md$/)\n        .use('md-loader')\n        .loader('md-loader');\n\n      //  loader\n      chain.module\n        .rule(CHAIN_ID.RULE.JS)\n        .use(CHAIN_ID.USE.BABEL)\n        .tap(options => {\n          options.plugins.push('babel-plugin-xxx');\n          return options;\n        });\n\n      //  loader\n      chain.module.rule(CHAIN_ID.RULE.JS).uses.delete(CHAIN_ID.USE.BABEL);\n    },\n  },\n};\n\n\n\n// plugin#\n\nexport default {\n  tools: {\n    webpackChain: (chain, { webpack, CHAIN_ID }) => {\n      // \n      chain.plugin('custom-define').use(webpack.DefinePlugin, [\n        {\n          'process.env': {\n            NODE_ENV: JSON.stringify(process.env.NODE_ENV),\n          },\n        },\n      ]);\n\n      // \n      chain.plugin(CHAIN_ID.PLUGIN.HMR).tap(options => {\n        options[0].fullBuildTimeout = 200;\n        return options;\n      });\n\n      // \n      chain.plugins.delete(CHAIN_ID.PLUGIN.HMR);\n    },\n  },\n};\n\n\n\n#\n\n// SSR Web Worker \n\nexport default {\n  tools: {\n    webpackChain: (chain, { env, isProd, target, isServer, isWebWorker }) => {\n      if (utils.env === 'development' || utils.env === 'test') {\n        // ...\n      }\n      if (utils.isProd) {\n        // ...\n      }\n      if (utils.target === 'node') {\n        // ...\n      }\n      if (utils.isServer) {\n        // ...\n      }\n      if (utils.isWebWorker) {\n        // ...\n      }\n    },\n  },\n};\n\n\n webpack-chain API  webpack-chain ","frontmatter":{}},{"id":280,"title":"","routePath":"/builder/guide/advanced/define","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":" define ","id":"-define-","depth":2},{"text":"","id":"","depth":3},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":"Tree Shaking","id":"tree-shaking","depth":2},{"text":"","id":"","depth":2}],"domain":"","content":"#\n\nBuilder \n\n\n#\n\nBuilder  process.env.NODE_ENV  'development'\n'production'\n\n process.env.NODE_ENV\n\nif (process.env.NODE_ENV === 'development') {\n  console.log('this is a development log');\n}\n\n\n\n\nif (true) {\n  console.log('this is a development log');\n}\n\n\n\n\nif (false) {\n  console.log('this is a development log');\n}\n\n\nif (false) { ... } \n\n\n define #\n\n source.define \n\ndefine  JavaScript\n Builder \nTree Shaking \n\n\n#\n\ndefine \n\n NODE_ENV  \"production\"\n\nexport default {\n  source: {\n    define: {\n      'process.env.NODE_ENV': JSON.stringify(process.env.NODE_ENV),\n    },\n  },\n};\n\n\n JSON  process.env.NODE_ENV  \"production\" \n\"\\\"production\\\"\" \n\n { foo: \"bar\" }  \"{\\\"foo\\\":\\\"bar\\\"}\"\nprocess.env.NODE_ENV.foo  bar\n\nsource.define  API \n\nTIP\n NODE_ENV  Builder \n\n\n#\n\nBuilder  source.globalVars  source.define\n source.globalVars  JSON \nJSON.stringify(...) \n\nexport default {\n  source: {\n    globalVars: {\n      'process.env.NODE_ENV': 'production',\n      'import.meta.foo': { bar: 42 },\n      'import.meta.baz': false,\n    },\n  },\n};\n\n\n Builder \n\nconsole.log(process.env.NODE_ENV);\n// => production\n\nconst { NODE_ENV } = process.env;\nconsole.log(NODE_ENV);\n// => undefined\n\nconst vars = process.env;\nconsole.log(vars.NODE_ENV);\n// => undefined\n\n\n\n#\n\n TypeScript TypeScript \n\n CUSTOM_VAR  TypeScript \n\nTS2304: Cannot find name 'CUSTOM_VAR'.\n\n\n src/env.d.ts \n\nsrc/env.d.ts\n\ndeclare const CUSTOM_VAR: string;\n\n\n\nTree Shaking#\n\nDefine  Builder  Tree Shaking \n\n process.env.REGION \n\nexport default {\n  source: {\n    define: {\n      'process.env.REGION': JSON.stringify(process.env.REGION),\n    },\n    // or...\n    globalVars: {\n      'process.env.REGION': process.env.REGION,\n    },\n  },\n};\n\n\n\n\nconst App = () => {\n  if (process.env.REGION === 'cn') {\n    return ;\n  } else if (process.env.REGION === 'sg') {\n    return ;\n  } else {\n    return ;\n  }\n};\n\n\n REGION=sg \n\nconst App = () => {\n  if (false) {\n  } else if (true) {\n    return ;\n  } else {\n  }\n};\n\n\n\n\n\n#\n\nVitest  Define \nVitest \n\n// \nfunction add(...args) {\n  return args.reduce((a, b) => a + b, 0);\n}\n\n// \nif (import.meta.vitest) {\n  const { it, expect } = import.meta.vitest;\n  it('add', () => {\n    expect(add()).toBe(0);\n    expect(add(1)).toBe(1);\n    expect(add(1, 2, 3)).toBe(6);\n  });\n}\n","frontmatter":{}},{"id":281,"title":"","routePath":"/builder/guide/advanced/hmr","lang":"zh","toc":[{"text":" HMR","id":"-hmr","depth":2},{"text":" HMR URL","id":"-hmr-url","depth":2},{"text":"Live reloading  Hot reloading ","id":"live-reloading--hot-reloading-","depth":2},{"text":"","id":"","depth":2},{"text":"External react/reactDom ","id":"external-react/reactdom-","depth":3},{"text":" https ","id":"-https-","depth":3},{"text":" React  state ","id":"-react--state-","depth":3}],"domain":"","content":"#\n\nHMR - hot module\nreplacement\n\n * \n * \n *  CSS/JS  devtools \n\n\n HMR#\n\nBuilder  HMR \n\n HMR  dev.hmr  false react-refresh \n\nexport default {\n  dev: {\n    hmr: false,\n  },\n};\n\n\n\n HMR URL#\n\nBuilder  local-ip  HMR  URL URL\n\n host  path  HMR  URL\n\nexport default {\n  tools: {\n    devServer: {\n      client: {\n        port: '',\n        host: '',\n      },\n    },\n  },\n};\n\n\n\nLive reloading  Hot reloading #\n\n * Live reloading: webpack \n   window.location.reload()\n * Hot reloading: webpack \n\nDevServer  hot  liveReload  hot  liveReload DevServer\n hot  (HMR) HMR \n\n\n#\n\n\nExternal react/reactDom #\n\n react  react-dom  development   CDN  react  production\n external\n\n React  React \n\n\n https #\n\n https  HMR  HMR connect failed \n\n\n\n Chrome -> xxx\n\n\n\n> Tips:  Localhost  Network \n\n\n React  state #\n\nBuilder  React  Fast Refresh \n\n Fast Refresh  React  state\n\n\n\n//  1\nexport default function () {\n  return \nHello World;\n}\n\n//  2\nexport default () => \nHello World;\n\n\n\n\n//  1\nexport default function MyComponent() {\n  return \nHello World;\n}\n\n//  2\nconst MyComponent = () => \nHello World\n\nexport default MyComponent;\n","frontmatter":{}},{"id":282,"title":" REM ","routePath":"/builder/guide/advanced/rem","lang":"zh","toc":[{"text":" REM ","id":"-rem-","depth":2},{"text":"CSS ","id":"css-","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":" REM ","id":"-rem-","depth":2},{"text":" rootFontSize ","id":"-rootfontsize-","depth":2}],"domain":"","content":"#\n\nBuilder  output.convertToRem  REM\n\n\n\n REM #\n\n convertToRem \n\n 1.  CSS  px  rem\n 2. \n\nexport default {\n  output: {\n    convertToRem: true,\n  },\n};\n\n\n\nCSS #\n\n rootFontSize  50 rem  1rem = 50px  CSS \n\n/* input */\nh1 {\n  margin: 0 0 16px;\n  font-size: 32px;\n  line-height: 1.2;\n  letter-spacing: 1px;\n}\n\n/* output */\nh1 {\n  margin: 0 0 0.32rem;\n  font-size: 0.64rem;\n  line-height: 1.2;\n  letter-spacing: 0.02rem;\n}\n\n\nBuilder  CSS  font-size  pxtorem.propList \n\nexport default {\n  output: {\n    convertToRem: {\n      pxtorem: {\n        propList: ['font-size'],\n      },\n    },\n  },\n};\n\n\n\n#\n\n\n\n =   *  / UI \n\n(pageRootFontSize = clientWidth * rootFontSize / screenWidth)\n\n\n 390  50 UI  375\n\n 52 (390 * 50 / 375)  1 rem  52pxCSS  32px0.64\nrem 33.28 px\n\nexport default {\n  output: {\n    convertToRem: {\n      rootFontSize: 50,\n      screenWidth: 375,\n    },\n  },\n};\n\n\n\n#\n\n\n\n 1920  349 64 64 \n\nexport default {\n  output: {\n    convertToRem: {\n      maxRootFontSize: 64,\n    },\n  },\n};\n\n\n\n REM #\n\n 1. CSS .css  px  rem\n 2. HTML document.documentElement.style.fontSize \n\n\n rootFontSize #\n\n rootFontSize  \ndocument.documentElement.style.fontSize  window.ROOT_FONT_SIZE ","frontmatter":{}},{"id":283,"title":" Rspack","routePath":"/builder/guide/advanced/rspack-start","lang":"zh","toc":[{"text":" Rspack","id":"-rspack","depth":2},{"text":" Modern.js ","id":"-modern.js-","depth":3},{"text":"","id":"","depth":3},{"text":" webpack  Rspack","id":"-webpack--rspack","depth":2},{"text":"Builder ","id":"builder-","depth":3},{"text":"Source Config","id":"source-config","depth":4},{"text":"Html Config","id":"html-config","depth":4},{"text":"Security Config","id":"security-config","depth":4},{"text":"Dev Config","id":"dev-config","depth":4},{"text":"Output Config","id":"output-config","depth":4},{"text":"Experiments Config","id":"experiments-config","depth":4},{"text":"Performance Config","id":"performance-config","depth":4},{"text":"Tools Config","id":"tools-config","depth":4},{"text":" Rspack ","id":"-rspack-","depth":3},{"text":"","id":"","depth":3}],"domain":"","content":"#\n\n Builder  Rspack \n\n Rspack\n\nRspack  Rust  Web  Webpack  Webpack\n\n\n WebpackRspack  Rust  benchmark\nRspack  5  10 \n\n\n Rspack#\n\n\n Modern.js #\n\nModern.js  webpack  Rspack  Modern.js  \n\n:\n\n 1.  @modern-js/builder-rspack-provider Modern.js \n\npnpm add @modern-js/builder-rspack-provider -D\n\n\n package.json  lock  Modern.js :\n\npackage.json\n\n{\n  \"devDependencies\": {\n    \"@modern-js/app-tools\": \"2.8.0\"\n  }\n}\n\n\n 2.  Modern.js  Rspack:\n\nmodern.config.ts\n\n\n\n+ export default defineConfig<'rspack'>({\n  plugins: [\n    appTools({\n+     bundler: 'experimental-rspack',\n    }),\n  ],\n});\n\n\n\n#\n\n Builder  rspack-provider   webpack-provider \n@modern-js/builder-webpack-provider  @modern-js/builder-rspack-provider \n\nmodern.config.ts\n\n\n\n\nconst provider = builderRspackProvider({\n  builderConfig: {\n    // some configs\n  },\n});\n\n\n\n webpack  Rspack#\n\nBuilder \n\n Builder  webpack  Rspack  Rspack \n\n\nBuilder #\n\nBuilder  RspackBuilder \n\n *  webpack loader / plugin ( Rspack )  Rspack\n    css/module  css-loader  modules \n *  webpack  @svgr/webpackwebpack-bundle-analyzer ;\n *  Rspack  cssminify ;\n\nSource Config#\n\n> Builder \n\n\n\n * source.moduleScopes\n\nHtml Config#\n\n> Builder  HTML \n\n html  Rspack \n\nSecurity Config#\n\n> Builder \n\n security  Rspack \n\nDev Config#\n\n> Builder \n\n dev  Rspack \n\nOutput Config#\n\n> Builder \n\n\n\n * output.disableCssExtract\n * output.enableAssetManifest\n * output.enableCssModuleTSDeclaration\n * output.legalComments\n * output.enableInlineScripts\n * tsChecker \n   * output.disableTsChecker\n\nExperiments Config#\n\n> Builder \n\n experiments  Rspack \n\nPerformance Config#\n\n> Builder \n\n\n\n * performance.profile\n * performance.removeMomentLocale\n * performance.buildCache\n\nTools Config#\n\n> Builder \n\n\n\n * tools.terser\n * tools.cssExtract\n * tools.cssLoader\n * tools.inspector\n * tools.minifyCss\n * tools.pug\n * tools.styleLoader\n * tools.styledComponents\n * tools.tsLoader\n * tools.tsChecker\n * tools.webpack\n * tools.webpackChain\n\nTIP\n API \n\n\n Rspack #\n\n Rspack  Rspack  Webpack \n\n tools.rspack  Rspack  Rspack \n\nexport default {\n  tools: {\n    rspack: (config, { env }) => {\n      if (env === 'development') {\n        config.devtool = 'cheap-module-eval-source-map';\n      }\n      return config;\n    },\n  },\n};\n\n\n Rspack  Rspack \n\n\n#\n\nBuilder  bundler-chain  Rspack config bundler chain  webpack \nRspack ","frontmatter":{}},{"id":284,"title":"","routePath":"/builder/guide/basic/build-target","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":"Node ","id":"node-","depth":2},{"text":"Web Worker ","id":"web-worker-","depth":2},{"text":"Modern Web ","id":"modern-web-","depth":2}],"domain":"","content":"#\n\nBuilder Builder\n\n\n createBuilder  target \n\n\n#\n\ntarget  'web'\n\nBuilder  Browserslist \n\n\n#\n\n 'web'  target \n\n * 'node':  Node.js  SSR \n * 'web-worker' Web Worker \n * 'modern-web'\n\n Node.js \n\nconst builder = await createBuilder(provider, {\n  target: 'node',\n});\n\n\n\n#\n\n target Builder \n\n SSR \n\nconst builder = await createBuilder(provider, {\n  target: ['web', 'node'],\n});\n\n\n\nNode #\n\n Node.js  SSR \n\n target  'node' Builder \n\n *  HTML  HTML  Node.js  HTML\n *  CSS  CSS Modules  id \n *  dynamic import \n * \n *  Browserslist  ['node >= 14']\n\nTIP\n web  node  web web  HTMLCSS\n\n\n\nWeb Worker #\n\n Web Worker \n\nWeb Worker\nWeb Workers  JavaScript API Web Workers\n\n\n target  'web-worker' Builder \n\n *  HTML  HTML  Web Worker  HTML\n *  CSS  CSS Modules  id \n *  dynamic import  Web Worker  JavaScript \n * \n\n\nModern Web #\n\n\n\n?\n  ES Modules \n\n target  'modern-web' Builder \n\n *  Browserslist \n\nconst browserslist = [\n  'chrome >= 61',\n  'edge >= 16',\n  'firefox >= 60',\n  'safari >= 11',\n  'ios_saf >= 11',\n];\n","frontmatter":{}},{"id":285,"title":"Builder ","routePath":"/builder/guide/basic/builder-config","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":3},{"text":" Node API ","id":"-node-api-","depth":3},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2}],"domain":"","content":"#\n\nBuilder \n\n\n#\n\nBuilder \n\n * Dev Config\n * Html Config HTML \n * Tools Config\n * Source Config\n * Output Config\n * Security Config\n * Performance Config\n\n API Reference \n\n\n#\n\nBuilder \n\n Builder \n\n\n#\n\n\n#\n\n Builder  Builder  Builder\n\n Modern.js  modern.config.ts  Builder  source.alias \n\nmodern.config.ts\n\nexport default {\n  source: {\n    alias: {\n      '@common': './src/common',\n    },\n  },\n};\n\n\n\n\n          \nModern.js   modern.config.ts\nEdenX       edenx.config.ts\nPIA         pia.config.ts\n\n\n Node API #\n\n Node API  Builder  Provider  builderConfig  Builder \n\n\n\nconst provider = builderWebpackProvider({\n  builderConfig: {\n    // some configs\n  },\n});\n\n\n Node API  API - createBuilder\n\n\n#\n\nBuilder \n\nBuilder  Builder \n\n\n#\n\n DEBUG=builder  Builder \n\nDEBUG=builder pnpm dev\n\n\nBuilder  Builder \n\nInspect config succeed, open following files to view the content:\n\n  - Builder Config: /Project/demo/dist/builder.config.js\n  - Webpack Config (web): /Project/demo/dist/webpack.config.web.js\n\n\n /dist/builder.config.js  Builder \n\n  ","frontmatter":{}},{"id":286,"title":" CSS Modules","routePath":"/builder/guide/basic/css-modules","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":" CSS Modules","id":"-css-modules","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"-1","depth":3},{"text":"","id":"","depth":3}],"domain":"","content":"#\n\nCSS Modules  CSS  JavaScript  CSS Modules\n\n\nBuilder  CSS Modules [name].module.css  CSS\nModules\n\n CSS Modules\n\n * *.module.scss\n * *.module.less\n * *.module.css\n\n\n#\n\n * \n\n/* button.module.css */\n.error {\n  background: red;\n}\n\n\n * \n\n// Button.tsx\n\n// \n\n\nexport default () => {\n  return Error Button;\n};\n\n\n\n CSS Modules#\n\n *.module.css  CSS Modules \n\n CSS  CSS Modules \noutput.disableCssModuleExtension \n\nexport default {\n  output: {\n    disableCssModuleExtension: true,\n  },\n};\n\n\n CSS Modules\n\n\n\n\n\nTIP\n disableCssModuleExtension CSS Modules  CSS\n\n\n\n#\n\n CSS Modules  output.cssModuleLocalIdentName \n\nexport default {\n  output: {\n    cssModuleLocalIdentName: '[hash:base64:4]',\n  },\n};\n\n\n CSS Modules  tools.cssLoader \n\n\n#\n\n TypeScript  CSS Modules TypeScript \n\nTS2307: Cannot find module './index.module.css' or its corresponding type declarations.\n\n\n CSS Modules  src/global.d.ts \n\nsrc/global.d.ts\n\ndeclare module '*.module.css' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.scss' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.sass' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.less' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.module.styl' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\n\n disableCssModuleExtension \n\nsrc/global.d.ts\n\ndeclare module '*.css' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.scss' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.sass' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.less' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\ndeclare module '*.styl' {\n  const classes: { readonly [key: string]: string };\n  export default classes;\n}\n\n\n IDE global.d.ts  TypeScript \n\n\n#\n\n CSS Modules  TypeScript  CSS \n\nBuilder  CSS Modules  output.enableCssModuleTSDeclaration\nBuilder  CSS Modules \n\nexport default {\n  output: {\n    enableCssModuleTSDeclaration: true,\n  },\n};\n\n\n\n#\n\n src/index.ts  src/index.module.scss \n\nsrc/index.ts\n\n\n\nexport default () => {\n  \n\n    \nPage Header\n  ;\n};\n\n\n// index.module.scss\n.page-header {\n  color: black;\n}\n\n\n src/index.module.scss.d.ts \n\nsrc/index.module.scss.d.ts\n\n// This file is automatically generated.\n// Please do not change this file!\ninterface CssExports {\n  'page-header': string;\n  pageHeader: string;\n}\nexport const cssExports: CssExports;\nexport default cssExports;\n\n\n src/index.ts  styles \n\n\n#\n\nsrc/index.module.scss.d.ts  Git  .gitignore\n\n\n# Ignore auto generated CSS declarations\n*.module.css.d.ts\n*.module.sass.d.ts\n*.module.scss.d.ts\n*.module.less.d.ts\n*.module.styl.d.ts\n\n\n ESLint  .eslintignore ","frontmatter":{}},{"id":287,"title":"","routePath":"/builder/guide/basic/css-usage","lang":"zh","toc":[{"text":" LessSass  Stylus","id":"-lesssass--stylus","depth":2},{"text":" PostCSS","id":"-postcss","depth":2},{"text":" PostCSS ","id":"-postcss-","depth":3},{"text":" CSS Modules","id":"-css-modules","depth":2},{"text":"CSS ","id":"css-","depth":2},{"text":" CSS ","id":"-css-","depth":2},{"text":" node_modules ","id":"-node_modules-","depth":2}],"domain":"","content":"#\n\nBuilder  Less / Sass PostCSSCSS ModulesCSS  CSS \n\nBuilder \n\n\n LessSass  Stylus#\n\nBuilder  CSS  Less  Sass\n\n Less  Sass  loader  tools.lesstools.sass\n\n\n Builder  Stylus Builder  Stylus  Stylus \n\n\n PostCSS#\n\nBuilder  PostCSS  CSS  tools.postcss  postcss-loader\n\nexport default {\n  tools: {\n    postcss: opts => {\n      const viewportPlugin = require('postcss-px-to-viewport')({\n        viewportWidth: 375,\n      });\n      opts.postcssOptions.plugins.push(viewportPlugin);\n    },\n  },\n};\n\n\n\n PostCSS #\n\nBuilder  PostCSS  CSS \n\n * autoprefixer autoprefixer  CSS \n   output.overrideBrowserslist \n * postcss-nesting CSS Nesting  CSS \n\n.my-table {\n  & td {\n    text-align: center;\n\n    &.c {\n      text-transform: uppercase;\n    }\n  }\n}\n\n\n * postcss-flexbugs-fixes Flex Bugs\n * postcss-initial initial  \n * postcss-page-break break-  \n * postcss-font-variant font-variant \n * postcss-media-minmax Media Query Ranges \n * postcss-custom-properties Custom Properties  CSS\n   \n\n:root {\n  --main-bg-color: pink;\n}\n\nbody {\n  background-color: var(--main-bg-color);\n}\n\n\n\n CSS Modules#\n\n  CSS Modules  CSS Modules \n\n\nCSS #\n\n CSSJS \n\nBuilder  css-minimizer-webpack-plugin  CSS  cssnano\n\n tools.minifyCss  css-minimizer-webpack-plugin\n\n cssnano\ncssnano  CSS  CSS\n\n\n\n CSS #\n\nBuilder  CSS  .css \n\n JS  output.disableCssExtract  true  CSS  JS\nJS  HTML ","frontmatter":{}},{"id":288,"title":" HTML ","routePath":"/builder/guide/basic/html-template","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":" meta ","id":"-meta-","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":3},{"text":"","id":"-1","depth":3},{"text":"","id":"-2","depth":3},{"text":"","id":"","depth":2},{"text":"","id":"","depth":3},{"text":"","id":"","depth":3}],"domain":"","content":"#\n\nBuilder  HTML  HTML \n\nBuilder  HTML \n\n\n#\n\nHTML \n\n Modern.js  HTML  Modern.js - HTML \n\n\n Builder  html.template  html.templateByEntries  HTML \n\nexport default {\n  html: {\n    template: './static/index.html',\n  },\n};\n\n\n\n#\n\n html.title  html.titleByEntries  HTML  </code> </p>\n<p> <code>html.title</code> </p> <div className=\"\"><div\nclassName=\"\"><button className=\"\"></button><pre className=\"\"><code\nclassName=\"\">export default { html: { title: 'example', }, };\n</code></pre></div></div> <p> <code>html.titleByEntries</code>\n<code>html.titleByEntries</code>  key</p> <div\nclassName=\"\"><div className=\"\"><button className=\"\"></button><pre\nclassName=\"\"><code className=\"\">export default { html: { titleByEntries: { foo:\n'Foo', bar: 'Bar', }, }, }; </code></pre></div></div> <h2 id=\"\"><a\nclassName=\"\" aria-hidden=\"true\" href=\"#\">#</a></h2> <p>Builder  <a\nhref=\"https://developer.mozilla.org/en-US/docs/Glossary/Favicon\" target=\"_blank\"\nrel=\"noopener noreferrer\">favicon</a>   iOS  <a\nhref=\"https://webhint.io/docs/user-guide/hints/hint-apple-touch-icons/\"\ntarget=\"_blank\" rel=\"noopener noreferrer\">apple-touch-icon</a> </p> <p>\n<a href=\"/zh/api/config-html\">html.favicon</a>  <a\nhref=\"/zh/api/config-html\">html.faviconByEntries</a>  favicon </p> <div\nclassName=\"\"><div className=\"\"><button className=\"\"></button><pre\nclassName=\"\"><code className=\"\">export default { html: { favicon:\n'./src/assets/icon.png', }, }; </code></pre></div></div> <p> <a\nhref=\"/zh/api/config-html\">html.appIcon</a>  iOS  apple-touch-icon\n</p> <div className=\"\"><div className=\"\"><button className=\"\"></button><pre\nclassName=\"\"><code className=\"\">export default { html: { appIcon:\n'./src/assets/icon.png', }, }; </code></pre></div></div> <h2 id=\"-meta-\">\nmeta <a className=\"\" aria-hidden=\"true\" href=\"#-meta-\">#</a></h2> <p>\n<a href=\"/zh/api/config-html\">html.meta</a>  <a\nhref=\"/zh/api/config-html\">html.metaByEntries</a>  HTML \n<code><meta></code> </p> <p> description</p> <div className=\"\"><div\nclassName=\"\"><button className=\"\"></button><pre className=\"\"><code\nclassName=\"\">export default { html: { meta: { description: 'a description of the\npage', }, }, }; </code></pre></div></div> <p> HTML  meta </p> <div\nclassName=\"\"><div className=\"\"><button className=\"\"></button><pre\nclassName=\"\"><code className=\"\"><meta name=\"description\" content=\"a description\nof the page\" /> </code></pre></div></div> <h2 id=\"\"><a className=\"\"\naria-hidden=\"true\" href=\"#\">#</a></h2> <p> HTML Builder\n</p> <div className=\"\"><div className=\"\"><button\nclassName=\"\"></button><pre className=\"\"><code className=\"\">type\nDefaultParameters = { meta: string; //  html.meta  title: string; // \nhtml.title  mountId: string; //  html.mountId  entryName: string; // \nassetPrefix: string; //  output.assetPrefix  compilation:\nwebpack.Compilation; //  webpack  compilation  webpackConfig:\nConfiguration; // webpack  // htmlWebpackPlugin  // \nhttps://github.com/jantimon/html-webpack-plugin htmlWebpackPlugin: { tags:\nobject; files: object; options: object; }; }; </code></pre></div></div>\n<p> <a href=\"/zh/api/config-html\">html.templateParameters</a>  <a\nhref=\"/zh/api/config-html\">html.templateParametersByEntries</a>\n</p> <p></p> <div className=\"\"><div className=\"\"><button\nclassName=\"\"></button><pre className=\"\"><code className=\"\">export default {\nhtml: { templateParameters: { text: 'World', }, }, }; </code></pre></div></div>\n<p> HTML  <code><%= text %></code> </p> <div\nclassName=\"\"><div className=\"\"><button className=\"\"></button><pre\nclassName=\"\"><code className=\"\"><div>hello <%= text %>!</div>\n</code></pre></div></div> <p> HTML </p> <div className=\"\"><div\nclassName=\"\"><button className=\"\"></button><pre className=\"\"><code\nclassName=\"\"><div>hello world!</div> </code></pre></div></div> <h2\nid=\"\"><a className=\"\" aria-hidden=\"true\" href=\"#\">#</a></h2>\n<p>Builder  <a href=\"https://www.lodashjs.com/docs/lodash.template\"\ntarget=\"_blank\" rel=\"noopener noreferrer\">Lodash Template</a><a\nhref=\"https://ejs.co/\" target=\"_blank\" rel=\"noopener noreferrer\">EJS</a><a\nhref=\"https://pugjs.org/\" target=\"_blank\" rel=\"noopener noreferrer\">Pug</a>\n Lodash Template </p> <h3 id=\"\"><a\nhref=\"https://www.lodashjs.com/docs/lodash.template\" target=\"_blank\"\nrel=\"noopener noreferrer\">Lodash Template</a><a className=\"\" aria-hidden=\"true\"\nhref=\"#\">#</a></h3> <p> <code>.html</code> Builder  Lodash\nTemplate </p> <p> <code>text</code> \n<code>'world'</code> <code><%= text %></code> </p> <div\nclassName=\"\"><div className=\"\"><button className=\"\"></button><pre\nclassName=\"\"><code className=\"\"><!--  --> <div>hello <%= text %>!</div> <!--\n --> <div>hello world!</div> </code></pre></div></div> <p> <a\nhref=\"https://www.lodashjs.com/docs/lodash.template\" target=\"_blank\"\nrel=\"noopener noreferrer\">Lodash Template</a> </p> <h3 id=\"-1\"><a\nhref=\"https://ejs.co/\" target=\"_blank\" rel=\"noopener noreferrer\">EJS</a><a\nclassName=\"\" aria-hidden=\"true\" href=\"#-1\">#</a></h3> <p>\n<code>.ejs</code> Builder  EJS EJS \nJavaScript  JavaScript  HTML</p> <p> <a\nhref=\"/zh/api/config-html\">html.template</a>  <code>.ejs</code>\n</p> <div className=\"\"><div className=\"\"><button className=\"\"></button><pre\nclassName=\"\"><code className=\"\">export default { html: { template:\n'./static/index.ejs', }, }; </code></pre></div></div> <p>\n<code>user</code>  <code>{ name: 'Jack' }</code> <code><%=\nuser.name %></code> </p> <div className=\"\"><div className=\"\"><button\nclassName=\"\"></button><pre className=\"\"><code className=\"\"><!--  --> <% if\n(user) { %> <h2><%= user.name %></h2> <% } %> <!--  --> <h2>Jack</h2>\n</code></pre></div></div> <p> <a href=\"https://ejs.co/\" target=\"_blank\"\nrel=\"noopener noreferrer\">EJS</a> </p> <h3 id=\"-2\"><a\nhref=\"https://pugjs.org/\" target=\"_blank\" rel=\"noopener noreferrer\">Pug</a><a\nclassName=\"\" aria-hidden=\"true\" href=\"#-2\">#</a></h3> <p>\n<code>.pug</code> Builder  Pug Pug \nNode.js </p> <p> Pug  <a\nhref=\"/zh/api/config-tools\">tools.pug</a>  <a\nhref=\"/zh/api/config-html\">html.template</a>  <code>.pug</code>\n</p> <div className=\"\"><div className=\"\"><button className=\"\"></button><pre\nclassName=\"\"><code className=\"\">export default { html: { template:\n'./static/index.pug', }, tools: { pug: true, }, }; </code></pre></div></div>\n<p> <code>.pug</code>  Pug </p> <div className=\"\"><div\nclassName=\"\"><button className=\"\"></button><pre className=\"\"><code\nclassName=\"\"><!--  --> p Hello #{text}! <!--  --> <p>Hello World!</p>\n</code></pre></div></div> <p> <a href=\"https://pugjs.org/\" target=\"_blank\"\nrel=\"noopener noreferrer\">Pug</a> </p> <h2 id=\"\"><a\nclassName=\"\" aria-hidden=\"true\" href=\"#\">#</a></h2> <p>\n<code>html.tags</code>  HTML </p> <div className=\"\"><div\nclassName=\"\"></div><div className=\"\"> HTML \nHTML </div></div> <p> <code>htmlWebpackPlugin.tags</code>\n HTML </p> <div className=\"\"><div className=\"\"><button\nclassName=\"\"></button><pre className=\"\"><code className=\"\"><html> <head> <%=\nhtmlWebpackPlugin.tags.headTags %> </head> <body> <%=\nhtmlWebpackPlugin.tags.bodyTags %> </body> </html> </code></pre></div></div>\n<p><code>html.tags</code>  HTML <a\nhref=\"/zh/api/config-html\">API References</a></p> <h3 id=\"\"><a\nclassName=\"\" aria-hidden=\"true\" href=\"#\">#</a></h3> <div className=\"\"><div\nclassName=\"\"><button className=\"\"></button><pre className=\"\"><code\nclassName=\"\">export default { output: { assetPrefix: '//example.com/' }, html: {\ntags: [ { tag: 'script', attrs: { src: 'a.js' } }, { tag: 'script', attrs: {\nsrc: 'b.js' }, append: false }, { tag: 'link', attrs: { href: 'style.css', rel:\n'stylesheet' }, append: true } { tag: 'link', attrs: { href: 'page.css', rel:\n'stylesheet' }, publicPath: false } { tag: 'script', attrs: { src: 'c.js' },\nhead: false }, { tag: 'meta', attrs: { name: 'referrer', content: 'origin' } },\n], }, }; </code></pre></div></div> <p> <code>head</code> \n<code>append</code> </p> <p>\n<code>publicPath</code>  <code>output.assetPrefix</code> \n<code>script</code>  <code>src</code> </p> <p> HTML\n</p> <div className=\"\"><div className=\"\"><button\nclassName=\"\"></button><pre className=\"\"><code className=\"\"><html> <head> <script\nsrc=\"//example.com/b.js\"></script> <link href=\"//example.com/style.css\"\nrel=\"stylesheet\" /> <link href=\"page.css\" rel=\"stylesheet\" /> <!-- some other\nheadTags... --> <script src=\"//example.com/a.js\"></script> <meta name=\"referrer\"\ncontent=\"origin\" /> </head> <body> <!-- some other bodyTags... --> <script\nsrc=\"//example.com/c.js\"></script> </body> </html> </code></pre></div></div> <h3\nid=\"\"><a className=\"\" aria-hidden=\"true\" href=\"#\">#</a></h3>\n<p><code>html.tags</code> </p> <div\nclassName=\"\"><div className=\"\"><button className=\"\"></button><pre\nclassName=\"\"><code className=\"\">export default { html: { tags: [ tags => {\ntags.splice(0, 1); }, { tag: 'script', attrs: { src: 'a.js' }, head: false }, {\ntag: 'script', attrs: { src: 'b.js' }, append: false }, { tag: 'script', attrs:\n{ src: 'c.js' } }, tags => [...tags, { tag: 'script', attrs: { src: 'd.js' } }],\n], }, }; </code></pre></div></div> <p></p> <div className=\"\"><div\nclassName=\"\"><button className=\"\"></button><pre className=\"\"><code\nclassName=\"\"><html> <head> <!-- some other headTags... --> <script\nsrc=\"//example.com/c.js\"></script> <script src=\"//example.com/d.js\"></script>\n</head> <body> <!-- some other bodyTags... --> <script\nsrc=\"//example.com/a.js\"></script> </body> </html> </code></pre></div></div>","frontmatter":{}},{"id":289,"title":" JSON ","routePath":"/builder/guide/basic/json-files","lang":"zh","toc":[{"text":"JSON ","id":"json-","depth":2},{"text":"","id":"","depth":3},{"text":"","id":"","depth":3},{"text":"YAML ","id":"yaml-","depth":2},{"text":"","id":"-1","depth":3},{"text":"","id":"","depth":3},{"text":"TOML ","id":"toml-","depth":2},{"text":"","id":"-2","depth":3},{"text":"","id":"-1","depth":3}],"domain":"","content":"#\n\nBuilder  JSON  YAML  TOML  JSON \n\n\nJSON #\n\n JavaScript  JSON \n\n\n#\n\nexample.json\n\n{\n  \"name\": \"foo\",\n  \"items\": [1, 2]\n}\n\n\nindex.js\n\n\n\nconsole.log(example.name); // 'foo';\nconsole.log(example.items); // [1, 2];\n\n\n\n#\n\nBuilder  named import  JSON \n\n\n\n\n\nYAML #\n\nYAML \n\n JavaScript  .yaml  .yml  JSON \n\n\n#\n\nexample.yaml\n\n---\nhello: world\nfoo:\n  bar: baz\n\n\n\n\nconsole.log(example.hello); // 'world';\nconsole.log(example.foo); // { bar: 'baz' };\n\n\n\n#\n\n TypeScript  YAML  src/global.d.ts \n\nsrc/global.d.ts\n\ndeclare module '*.yaml' {\n  const content: Record;\n  export default content;\n}\n\ndeclare module '*.yml' {\n  const content: Record;\n  export default content;\n}\n\n\n\nTOML #\n\nTOML \n\n JavaScript  .toml  JSON \n\n\n#\n\nexample.toml\n\nhello = \"world\"\n\n[foo]\nbar = \"baz\"\n\n\n\n\nconsole.log(example.hello); // 'world';\nconsole.log(example.foo); // { bar: 'baz' };\n\n\n\n#\n\n TypeScript  TOML  src/global.d.ts \n\nsrc/global.d.ts\n\ndeclare module '*.toml' {\n  const content: Record;\n  export default content;\n}\n","frontmatter":{}},{"id":290,"title":"","routePath":"/builder/guide/basic/output-files","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":"Node.js ","id":"node.js-","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2}],"domain":"","content":"#\n\n\n\n\n#\n\n dist \n\ndist\n static\n    css\n       [name].[hash].css\n       [name].[hash].css.map\n   \n    js\n        [name].[hash].js\n        [name].[hash].js.LICENSE.txt\n        [name].[hash].js.map\n\n html\n     [name]\n         index.html\n\n\n HTML JS  CSS \n\n * HTML  html \n * JS  static/js \n * CSS  static/css \n\nJS  CSS \n\n * License  JS  .LICENSE.txt \n * Source Map  JS  CSS  .map \n\n[name]  index, main[hash] \n\n\n#\n\nBuilder \n\n *  output.filename \n *  output.distPath \n *  output.legalComments  License \n *  output.disableSourceMap  Source Map \n *  html.disableHtmlFolder  HTML \n\n\n#\n\nSVG dist/static \n\ndist\n static\n     image\n        foo.[hash].png\n    \n     svg\n        bar.[hash].svg\n    \n     font\n        baz.[hash].woff2\n    \n     media\n         qux.[hash].mp4\n\n\n output.distPath  assets \n\nexport default {\n  output: {\n    distPath: {\n      image: 'assets',\n      svg: 'assets',\n      font: 'assets',\n      media: 'assets',\n    },\n  },\n};\n\n\n\n\ndist\n assets\n     foo.[hash].png\n     bar.[hash].svg\n     baz.[hash].woff2\n     qux.[hash].mp4\n\n\n\nNode.js #\n\n Builder    'node' SSR Builder  Node.js\n bundles \n\ndist\n bundles\n    [name].js\n static\n html\n\n\nNode.js  JS  HTMLCSS Node  JS \n\n output.distPath.server  Node \n\n Node.js  server \n\nexport default {\n  output: {\n    distPath: {\n      server: 'server',\n    },\n  },\n};\n\n\n\n#\n\n\n\n\n\nexport default {\n  output: {\n    distPath: {\n      js: '',\n      css: '',\n      html: '',\n    },\n    disableHtmlFolder: true,\n  },\n};\n\n\n\n\ndist\n [name].[hash].css\n [name].[hash].css.map\n [name].[hash].js\n [name].[hash].js.map\n [name].html\n\n\n\n#\n\nBuilder \n\n Dev Server \n\n dev.writeToDisk  false \n\nexport default {\n  dev: {\n    writeToDisk: false,\n  },\n};\n","frontmatter":{}},{"id":291,"title":"","routePath":"/builder/guide/basic/static-assets","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":" JS ","id":"-js-","depth":2},{"text":" CSS ","id":"-css-","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":"URL ","id":"url-","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2}],"domain":"","content":"#\n\nBuilder \n\n\n Web  JavaScript  CDN\n Web  Web \n\n\n#\n\n Builder \n\n * pngjpgjpeggifsvgbmpwebpicoapngaviftiff\n * woffwoff2eotttfotfttc\n * mp4webmoggmp3wavflacaacmov\n\n GitHub Issues \n\nSVG \nSVG Builder  SVG  React  SVG   SVG \n\n\n JS #\n\n JS  import \n\n//  static  logo.png \n\n\nexport default = () => ;\n\n\n\n\n\n\nexport default = () => ;\n\n\n\n CSS #\n\n CSS \n\n.logo {\n  background-image: url('../static/logo.png');\n}\n\n\n\n\n.logo {\n  background-image: url('@/static/logo.png');\n}\n\n\n\n#\n\n\n\n *  10KB  URL\n *  10KB  Base64 \n\n\n\n\nconsole.log(largeImage); // \"/static/largeImage.6c12aba3.png\"\nconsole.log(smallImage); // \"data:image/png;base64,iVBORw0KGgo...\"\n\n\n  \n\n\n#\n\n\n\n *  output.filename \n *  output.distPath \n\n  \n\n\nURL #\n\n URL \n\n *  dev.assetPrefix \n *  output.assetPrefix \n\n output.assetPrefix  https://modern.com\n\n\n\nconsole.log(logo); // \"https://modern.com/static/logo.6c12aba3.png\"\n\n\n\n#\n\n TypeScript TypeScript \n\nTS2307: Cannot find module './logo.png' or its corresponding type declarations.\n\n\n src/global.d.ts  png \n\nsrc/global.d.ts\n\ndeclare module '*.png' {\n  const content: string;\n  export default content;\n}\n\n\n IDE global.d.ts  TypeScript \n\n\n#\n\n\n\n                                                               \nPNG                                  logoicon\nJPG                                           \nWebP    PNG  JPG    iOS               WebP  WebP \nSVG    ,                                         , icon","frontmatter":{}},{"id":292,"title":" SVG ","routePath":"/builder/guide/basic/svg-assets","lang":"zh","toc":[{"text":" JS ","id":"-js-","depth":2},{"text":"","id":"","depth":2},{"text":" CSS ","id":"-css-","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2}],"domain":"","content":"#\n\nBuilder  SVG  SVG  React  URL\n\n SVG\nSVG  Scalable Vector Graphics SVG  XML-based\n SVG \n\n\n JS #\n\n JS  SVG  ReactComponent Builder  SVGR SVG \nReact \n\nsrc/component/Logo.tsx\n\n\n\nexport default () => ;\n\n\n SVG  URL \n\nsrc/component/Logo.tsx\n\n\n\nconsole.log(logoURL); // => \"/static/logo.6c12aba3.png\"\n\n\n\n#\n\n output.svgDefaultExport  SVG  React \n\nexport default {\n  output: {\n    svgDefaultExport: 'component',\n  },\n};\n\n\n React  URL\n\nsrc/component/Logo.tsx\n\n\n\nexport default () => ;\n\n\n\n CSS #\n\n CSS  SVG SVG  URL\n\n.logo {\n  background-image: url('../static/logo.svg');\n}\n\n\n\n#\n\n SVG  React URL \n\n  \n\n\n#\n\n TypeScript  SVG TypeScript \n\nTS2307: Cannot find module './logo.svg' or its corresponding type declarations.\n\n\n SVG  src/global.d.ts \n\ndeclare module '*.svg' {\n  export const ReactComponent: React.FunctionComponent<\n    React.SVGProps\n  >;\n\n  const content: string;\n  export default content;\n}\n\n\n svgDefaultExport  'component'\n\ndeclare module '*.svg' {\n  export const ReactComponent: React.FunctionComponent<\n    React.SVGProps\n  >;\n\n  export default ReactComponent;\n}\n\n\n IDE global.d.ts  TypeScript ","frontmatter":{}},{"id":293,"title":" TypeScript","routePath":"/builder/guide/basic/typescript","lang":"zh","toc":[{"text":"TypeScript ","id":"typescript-","depth":2},{"text":" Babel","id":"-babel","depth":3},{"text":"","id":"","depth":2}],"domain":"","content":"#\n\nBuilder  TypeScript  .ts  .tsx \n\n\nTypeScript #\n\nBuilder  TypeScript \n\nBabel\n\n TypeScript  Babel  Babel  const enum\n namespace alias  7.15 Babel  TypeScript\n\n\nts-loader\n\nts-loader  TypeScript  TSC  ts-loader  TypeScript  Babel\n JavaScript  Babel  Polyfill \n\n ts-loader():\n\nexport default {\n  tools: {\n    tsLoader: {},\n  },\n};\n\n\n tools.tsLoader  ts-loader\n\nSWC\n\n Babel  SWC  JavaScript  TypeScript\nBuilder  SWC  TypeScript, TSX, Decorator SWC \n\n\n Babel#\n\nBabel  TypeScript  JavaScript\n Babel  Babel  undefined\nts-loader Polyfill Babel \n\n\n#\n\n TSCTSC Builder \ntsChecker(fork-ts-checker-webpack-plugin) \n\n tsChecker():\n\nexport default {\n  tools: {\n    tsChecker: {},\n  },\n};\n\n\n tsChecker \n\n ts-loader  compileOnly: false tsChecker\n\nSTC\nSWC  Rust  STC  Builder\n SWC ","frontmatter":{}},{"id":294,"title":" Wasm ","routePath":"/builder/guide/basic/wasm-assets","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2}],"domain":"","content":"#\n\nBuilder  WebAssembly \n\n WebAssembly\nWebAssembly wasm Web  CPU  Web\n\nINFO\n Rspack  Wasm \n\n\n#\n\n JavaScript  WebAssembly \n\nindex.js\n\n\n\nconsole.log(add); // [native code]\nconsole.log(add(1, 2)); // 3\n\n\n Dynamic Import  WebAssembly \n\nindex.js\n\nimport('./add.wasm').then(({ add }) => {\n  console.log('---- Async Wasm Module');\n  console.log(add); // [native code]\n  console.log(add(1, 2)); // 3\n});\n\n\n\n#\n\n .wasm  Builder  dist/static/wasm \n\n output.distPath  .wasm \n\nexport default {\n  output: {\n    distPath: {\n      wasm: 'resource/wasm',\n    },\n  },\n};\n\n\n\n#\n\n TypeScript  Wasm \n\n add.wasm  add()  add.wasm.d.ts \n\nadd.wasm.d.ts\n\nexport const add = (num1: number, num2: number) => number;\n","frontmatter":{}},{"id":295,"title":"","routePath":"/builder/guide/debug/debug-mode","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":"Builder ","id":"builder-","depth":2},{"text":"webpack ","id":"webpack-","depth":2}],"domain":"","content":"#\n\nBuilder  DEBUG=builder  Builder \n\n# \nDEBUG=builder pnpm dev\n\n# \nDEBUG=builder pnpm build\n\n\nBuilder  Builder  webpack \n\n\n#\n\n Shell  debug  Builder \n\n$ DEBUG=builder pnpm dev\n\ndebug   create context [1842.90 ms]\ndebug   add default plugins [1874.45 ms]\ndebug   add default plugins done [1938.57 ms]\ndebug   init plugins [2388.29 ms]\ndebug   init plugins done [2389.48 ms]\n...\n\n\nShell  Builder \n\nInspect config succeed, open following files to view the content:\n\n  - Builder Config: /Project/demo/dist/builder.config.js\n  - Webpack Config (web): /Project/demo/dist/webpack.config.web.js\n\n\n\nBuilder #\n\nBuilder  dist/builder.config.js  Builder\n Builder  Builder \n\n\n\nmodule.exports = {\n  dev: {\n    // some configs...\n  },\n  source: {\n    // some configs...\n  },\n  // other configs...\n};\n\n\n Builder  Builder  \n\n\nwebpack #\n\nBuilder  dist/webpack.config.web.js  webpack\n Builder  webpack \n\n\n\nmodule.exports = {\n  resolve: {\n    // some resolve configs...\n  },\n  module: {\n    // some webpack loaders...\n  },\n  plugins: [\n    // some webpack plugins...\n  ],\n  // other configs...\n};\n\n\n SSR  Node.js  dist \nwebpack.config.node.js  SSR  webpack \n\n webpack  webpack ","frontmatter":{}},{"id":296,"title":" Webpack Inspector","routePath":"/builder/guide/debug/inspector","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":3},{"text":"","id":"","depth":3},{"text":"Loader ","id":"loader-","depth":3},{"text":"","id":"","depth":3}],"domain":"","content":"#\n\nBuilder  webpack inspector  webpack \n\n\n#\n\n webpack  webpack :\n\n *  webpack \n *  loader  loader \n *  webpack  ( babel-loaderts-loader) \n\n webpack  loader  Builder  webpack inspector \n\n\n#\n\n tools.inspector  webpack inspector:\n\nexport default {\n  tools: {\n    inspector: {},\n  },\n};\n\n\n inspector  DEBUG  inspector\n\nexport default {\n  tools: {\n    inspector: process.env.DEBUG ? {} : undefined,\n  },\n};\n\n\n DEBUG=true pnpm dev Builder  inspector Shell\n\n\ninfo    Starting dev server...\n\nWebpack Inspector started at http://localhost:3333\n\n\n http://localhost:3333  inspector \n\n\n#\n\nInspector \n\n\n#\n\n webpack :\n\n\n\n\n#\n\n:\n\n\n\n:\n\n\n\n\nLoader #\n\n Loader :\n\n\n\n\n#\n\n\n\n\n\n\n\n\n\nTIP\n > 100 ","frontmatter":{}},{"id":297,"title":"","routePath":"/builder/guide/faq/exceptions","lang":"zh","toc":[{"text":"webpack  \\'compilation\\' argument ","id":"webpack--\\'compilation\\'-argument-","depth":2},{"text":" ES6+ ","id":"-es6+-","depth":2},{"text":" Monorepo ","id":"-monorepo-","depth":2},{"text":" You may need additional loader","id":"-you-may-need-additional-loader","depth":2},{"text":" exports is not defined","id":"-exports-is-not-defined","depth":2},{"text":" \\\"Error: ES Modules may not assign module.exports or exports.*, Use ESM export syntax\\\"","id":"-\\\"error:-es-modules-may-not-assign-module.exports-or-exports.*,-use-esm-export-syntax\\\"","depth":2},{"text":" Error ","id":"-error-","depth":2},{"text":"webpack ","id":"webpack-","depth":2},{"text":" tree shaking ","id":"-tree-shaking-","depth":2},{"text":" JavaScript heap out of memory?","id":"-javascript-heap-out-of-memory?","depth":2},{"text":" Can\\'t resolve \\'core-js/modules/xxx.js\\'","id":"-can\\'t-resolve-\\'core-js/modules/xxx.js\\'","depth":2},{"text":"React ","id":"react-","depth":2},{"text":"Less ","id":"less-","depth":2},{"text":" TypeError: Cannot delete property \\'xxx\\' of #<Object>","id":"-typeerror:-cannot-delete-property-\\'xxx\\'-of-#<object>","depth":2}],"domain":"","content":"#\n\n\nwebpack  'compilation' argument #\n\n webpack  webpack \n\nTypeError: The 'compilation' argument must be an instance of Compilation\n\n\nwebpack \n\n 1.  package.json  webpack  Builder  webpack\n    \n 2.  npm  webpack webpack \n 3.  lock  lock  webpack \n\n package.json  webpack  Builder  webpack \ntools.webpack  webpack  webpack \n\n npm  webpack  Builder\n yarn resolutions  pnpm overrides\n\n lock \n\nTIP\n lock \n\n\n ES6+ #\n\nBuilder  babel-loader  ts-loader  node_modules  npm\n ES6+ \n\n source.include \n\n\n Monorepo #\n\nBuilder  babel-loader  ts-loader  node_modules\n\n\n source.include \n\n source.include \n\n\n You may need additional loader#\n\n\n\nModule parse failed: Unexpected token\nFile was processed with these loaders:\n * some-loader/index.js\n\nYou may need an additional loader to handle the result of these loaders.\n\n\n\n\n *  .ts  node_modules  .ts  source.include\n   \n *  Builder  webpack loader \n\n\n exports is not defined#\n\n exports is not defined  babel  CommonJS\n babel \n\nBuilder  babel  CommonJS  source.include \ntools.babel  addIncludes  CommonJS  babel \n\n\n\n 1.  CommonJS  babel \n 2.  babel  sourceType  unambiguous\n\nexport default {\n  tools: {\n    babel(config) {\n      config.sourceType = 'unambiguous';\n    },\n  },\n};\n\n\n sourceType  unambiguous  babel \n\n\n \"Error: ES Modules may not assign module.exports or exports.*, Use ESM\nexport syntax\"#\n\n babel  CommonJS  exports is not defined\n\n\nError: ES Modules may not assign module.exports or exports.*, Use ESM export syntax, instead: 581\n\n\n issuebabel#12731\n\n\n Error #\n\n Error  Error  webpack\n Babel  Error  webpack  webpack\n Error\n\n\n\n Babel \n\n 1.  plugin  preset\n\n// \nexport default {\n  tools: {\n    babel(config, { addPlugins }) {\n      // \n      addPlugins('babel-plugin-not-exists');\n    },\n  },\n};\n\n\n 2.  babel-plugin-import babel-plugin-import \n\n// \nexport default {\n  tools: {\n    babel(config, { addPlugins }) {\n      addPlugins([\n        [\n          'babel-plugin-import',\n          { libraryName: 'antd', libraryDirectory: 'es' },\n        ],\n        [\n          'babel-plugin-import',\n          { libraryName: 'antd-mobile', libraryDirectory: 'es' },\n        ],\n      ]);\n    },\n  },\n};\n\n\n// \nexport default {\n  tools: {\n    babel(config, { addPlugins }) {\n      addPlugins([\n        [\n          'babel-plugin-import',\n          { libraryName: 'antd', libraryDirectory: 'es' },\n          'antd',\n        ],\n        [\n          'babel-plugin-import',\n          { libraryName: 'antd-mobile', libraryDirectory: 'es' },\n          'antd-mobile',\n        ],\n      ]);\n    },\n  },\n};\n\n\n\nwebpack #\n\nBuilder  webpack \n\n ./node_modules/.cache/webpack\n\n\n package.json \n\n webpack \n\nexport default {\n  tools: {\n    webpack(config) {\n      config.infrastructureLogging = {\n        ...config.infrastructureLogging,\n        debug: /webpack\\.cache/,\n      };\n    },\n  },\n};\n\n\nwebpack  debug PackFileCacheStrategy \n\n\n tree shaking #\n\nBuilder  webpack  tree shaking tree shaking \nwebpack  tree shaking \n\n tree shaking  npm  sideEffects  sideEffects\n tree shaking \n\n * webpack  - Tree Shaking\n * Tree Shaking \n\n npm \n\n *  Tree-shaking \n\n\n JavaScript heap out of memory?#\n\n Node.js \n\n OOM Node.js  --max-old-space-size \nCLI  NODE_OPTIONS \n\n modern build \n\npackage.json\n\n{\n  \"scripts\": {\n-   \"build\": \"modern build\"\n+   \"build\": \"NODE_OPTIONS=--max_old_space_size=16384 modern build\"\n  }\n}\n\n\n modern deploy\n\nmax_old_space_size MB) 1638416GB\n\nNode.js \n\n * NODE_OPTIONS\n * --max-old-space-size\n\n \n\n\n\n\n Can't resolve 'core-js/modules/xxx.js'#\n\n core-js \n\nModule not found: Can't resolve 'core-js/modules/es.error.cause.js'\n\n\n core-js Builder  core-js v3\n\n core-js \n\n 1.  Babel  plugins babelPluginLockCorejsVersion \n    tools.babel \n\n//  Builder  Babel \nexport default {\n  tools: {\n    babel: {\n      plugins: ['babel-plugin-xxx'],\n    },\n  },\n};\n\n// \nexport default {\n  tools: {\n    babel(config) {\n      config.plugins.push('babel-plugin-xxx');\n    },\n  },\n};\n\n\n 2.  core-js v2  core-js  v3 \n 3. node_modules  npm  core-js dependencies  core-js\n     npm  core-js  core-js\n\n\nReact #\n\nBuilder  React  Fast Refresh \n\n React  React  state  React \nReact Fast Refresh  React  state\n\n\n\n//  1\nexport default function () {\n  return \nHello World;\n}\n\n//  2\nexport default () => \nHello World;\n\n\n\n\n//  1\nexport default function MyComponent() {\n  return \nHello World;\n}\n\n//  2\nconst MyComponent = () => \nHello World;\n\nexport default MyComponent;\n\n\n\nLess #\n\nLess v4  v3 \n\n// Less v3\n.math {\n  width: 2px / 2; // 1px\n  width: 2px ./ 2; // 1px\n  width: (2px / 2); // 1px\n}\n\n// Less v4\n.math {\n  width: 2px / 2; // 2px / 2\n  width: 2px ./ 2; // 1px\n  width: (2px / 2); // 1px\n}\n\n\nBuilder  Less  v4\n\nLess  Less - Math\n\n\n TypeError: Cannot delete property 'xxx' of ##\n\n\npostcss-loader  Builder \n\n\n\n * 'TypeError: Cannot add property xxx, object is not extensible'\n * 'TypeError: Cannot assign to read only property 'xxx' of object '#'","frontmatter":{}},{"id":298,"title":"","routePath":"/builder/guide/faq/features","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":" ESLint ","id":"-eslint-","depth":2},{"text":" CDN ","id":"-cdn-","depth":2},{"text":" webpack ","id":"-webpack-","depth":2},{"text":" console","id":"-console","depth":2}],"domain":"","content":"#\n\n\n#\n\n source.transformImport  babel-plugin-import\n\nexport default {\n  source: {\n    transformImport: [\n      {\n        libraryName: 'xxx-components',\n        libraryDirectory: 'es',\n        style: true,\n      },\n    ],\n  },\n};\n\n\n\n ESLint #\n\nBuilder  ESLint \neslint-webpack-plugin\n\n\n\n\n\nexport default {\n  tools: {\n    webpackChain(chain) {\n      chain.plugin('eslint-plugin').use(ESLintPlugin, [\n        {\n          extensions: ['.js', '.ts', '.jsx', 'tsx', '.mjs'],\n        },\n      ]);\n    },\n  },\n};\n\n\n>  eslint-webpack-plugin \n\n\n CDN #\n\n JSCSS  CDN  output.assetPrefix  URL \n\nexport default {\n  output: {\n    assetPrefix: 'https://cdn.example.com/assets/',\n  },\n};\n\n\n\n webpack #\n\nBuilder  webpack  ./node_modules/.cache/webpack \n\n\n\nrm -rf ./node_modules/.cache\n\n\n\n console#\n\n console\n\nBuilder  console  performance.removeConsole","frontmatter":{}},{"id":299,"title":"","routePath":"/builder/guide/faq/general","lang":"zh","toc":[{"text":"Modern.js Builder  Modern.js ","id":"modern.js-builder--modern.js-","depth":2},{"text":"Builder ","id":"builder-","depth":2},{"text":"Builder  Turbopack","id":"builder--turbopack","depth":2},{"text":"Builder  Vite","id":"builder--vite","depth":2}],"domain":"","content":"#\n\n\nModern.js Builder  Modern.js #\n\nModern.js  Modern.js Builder \n\n Modern.js  Builder  Builder  Modern.js \nBuilder  Modern.js \n\n\nBuilder #\n\nBuilder  Web  Builder \n\n Modern.js Module \n\n\nBuilder  Turbopack#\n\nBuilder  Rspack Turbopack  Next.js  Builder  Turbopack\n\n\n>  Rspack    Rspack  Turbopack \n\n\nBuilder  Vite#\n\nVite  Builder  Rspack  webpackRspack\n\n\nBuilder  webpack  Rspack  Vite\n\n>  Rspack    Rspack  Vite ","frontmatter":{}},{"id":300,"title":"","routePath":"/builder/guide/features","lang":"zh","toc":[{"text":"JavaScript ","id":"javascript-","depth":2},{"text":"CSS ","id":"css-","depth":2},{"text":"HTML ","id":"html-","depth":2},{"text":"","id":"","depth":2},{"text":"React ","id":"react-","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2}],"domain":"","content":"#\n\n Modern.js Builder \n\n\nJavaScript #\n\n                                                                  \nBabel          Babel  JavaScript  TypeScript     \n                JavaScript \nTS             Babel  TS  ts-loader                 \nTS           TS Checker                                 \nJS                                                    \nPolyfill       core-js  Polyfill                              \nSourceMap      SourceMap                             \n             alias                                   \n                                                \nesbuild        esbuild  JavaScript  TypeScript    \nSWC            SWC  JavaScript  TypeScript        \nNode           Node.js  JavaScript                \nWeb Worker     Web Worker  JavaScript             \n            browserslist  Web              \n\n\nCSS #\n\n                                                        \nPostCSS            PostCSS  autoprefixer    \nSass              Sass/Scss                      \nLess              Less                           \nStylus            Stylus                        \nCSS Modules        CSS Modules                    \nCSS Modules      CSS Modules            \nCSS                                         \n CSS             CSS                        \nStyled Components    styled-components                \n CSS  JS         CSS  JS                  \n\n\nHTML #\n\n                                   \n           HTML  title        \n meta        HTML  meta         \n favicon     favicon          \n app       iOS  apple icon   \n EJS     EJS          \n Pug     Pug          \n JS        JS  HTML      \n CSS       CSS  HTML     \n\n\n#\n\n                                                      \n              Dev Server  URL   \nHTTPS Dev Server    Dev Server  HTTPS          \n\n\nReact #\n\n                                          \nReact Refresh     React Refresh        \nSVG  React     React  SVG    \n\n\n#\n\n                                            \n                              \n                              \n                              \n Wasm         WebAssembly         \n            JS           \n            dist      \n            dist          \n manifest     manifest    \n\n\n#\n\n                                                    \n            Builder    \n                          \n             Bundle Analyzer         \n console         console.xx                \n moment.js     moment.js  locale        ","frontmatter":{}},{"id":301,"title":"","routePath":"/builder/guide/glossary","lang":"zh","toc":[{"text":"Bundler","id":"bundler","depth":2},{"text":"Rspack","id":"rspack","depth":2},{"text":"Builder","id":"builder","depth":2},{"text":"Builder Provider","id":"builder-provider","depth":2},{"text":"Modern.js","id":"modern.js","depth":2},{"text":"EdenX","id":"edenx","depth":2}],"domain":"","content":"#\n\n\nBundler#\n\n webpackRspack \n\n JavaScriptCSS Node.js  Bundler  Web\n bundle\n\n\nRspack#\n\nRspack  Rust  Web  Webpack  Webpack\n\n\n\nBuilder#\n\nBuilder Builder \n\n webpack  Bundler  webpack  webpack\n\n\nBuilder  Bundler  Builder Web \n\nBuilder \n\n\n\n\nBuilder Provider#\n\nBuilder Provider  Builder Provider  bundler \n\n Builder  Provider\n\n * @modern-js/builder-webpack-provider webpack \n * @modern-js/builder-rspack-provider Rspack \n\n\nModern.js#\n\nModern.js  Web \n\n * Modern.js \n\n\nEdenX#\n\n Web  Modern.js ","frontmatter":{}},{"id":302,"title":"","routePath":"/builder/guide/introduction","lang":"zh","toc":[{"text":"Rust ","id":"rust-","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":" Rspack ","id":"-rspack-","depth":3},{"text":"","id":"","depth":3},{"text":"","id":"","depth":3},{"text":"npm ","id":"npm-","depth":2},{"text":"","id":"","depth":2}],"domain":"","content":"#\n\nModern.js Builder  Web \n\n Web\n\n\n Modern.js  Web  Modern.js\nBuilder \n\n\nRust #\n\n Rust    SWCRspack\n Rust  JavaScript\n\n\n Rust Modern.js Builder  Rust \nJavaScript  Rust  webpack  bundler Modern.js Builder\nModern.js Builder\n\n\n\n#\n\nModern.js Builder ( Builder)  Web\n\n\n Builder \n\n Builder Builder \n\n Builder \n\n *  Modern.js \n *  EdenXPIA \n\n\n#\n\n\n Rspack #\n\nBuilder  webpack  Rspack  Webpack  Rspack \n\n Rspack\n\nRspack  Rust  Web  Webpack  Webpack\n\n\n WebpackRspack  Rust  benchmark\nRspack  5  10 \n\nBuilder  webpack 5  webpack\nBuilder  webpack \nbabelpostcssterser Builder \nbabel/terser  swc  esbuild\n\n Rspack   Rspack \n\n\n#\n\nBuilder  webpack \n\nwebpack  splitChunks Builder  performance.chunkSplit\n chunk\n\n\n#\n\nBuilder \n\n Builder \n\n *  Builder \n *  npm \n\nBuilder \n\n\nnpm #\n\nBuilder  npm \n\n                                            \n@modern-js/builder                              Builder \n@modern-js/builder-webpack-provider              webpack \n@modern-js/builder-rspack-provider               Rspack \n@modern-js/builder-plugin-swc                   SWC \n@modern-js/builder-plugin-stylus                Stylus \n@modern-js/builder-plugin-esbuild               Esbuild \n@modern-js/builder-plugin-node-polyfill         Node Polyfill \n@modern-js/builder-plugin-image-compress        Image Compress \n@modern-js/builder-shared                       Builder \n@modern-js/builder-doc                          \n\n modern.js  packages/builder \n\n\n#\n\n","frontmatter":{}},{"id":303,"title":"","routePath":"/builder/guide/optimization/build-performance","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":" Node.js ","id":"-node.js-","depth":3},{"text":" Rspack ","id":"-rspack-","depth":3},{"text":" SWC  esbuild ","id":"-swc--esbuild-","depth":3},{"text":" ts-loader","id":"-ts-loader","depth":3},{"text":"","id":"","depth":2},{"text":"","id":"","depth":3},{"text":" Source Map ","id":"-source-map-","depth":3},{"text":" Browserslist ","id":"-browserslist-","depth":3},{"text":"","id":"","depth":2},{"text":" Source Map","id":"-source-map","depth":3}],"domain":"","content":"#\n\nModern.js Builder \n\n\n\n \n\n\n\n#\n\n\n\n\n Node.js #\n\n Node.js  LTS \n\n Apple M1/M2  Node 16  Node 18 \n\nNode 16  Apple Silicon binaries M1/M2  Node 14 \nNode 14  Node 16  100% \n\n Node 16\n\n#  Node.js v16\nnvm install 16\n\n#  Node 16\nnvm use 16\n\n#  Node 16 \nnvm default 16\n\n#  Node \nnode -v\n\n\n\n Rspack #\n\nRspack  Rust  Web  Webpack  Webpack\n\n\n WebpackRspack  Rust  benchmark\nRspack  5  10 \n\n Rspack   Rspack \n\n\n SWC  esbuild #\n\nSWC (Speedy Web Compiler)  Rust  JavaScript  TypeScript \nPolyfill  Babel  Babel \n\nesbuild  Golang  JavaScript esbuild\n\n\nBuilder  SWC  esbuild  SWC  esbuild  babel-loaderts-loader \nterser \n\n * SWC \n * esbuild \n\nSWC vs esbuild\nSWC  core-js  Polyfill SWC \n\n\n ts-loader#\n\nBuilder  Babel  TS  tools.tsLoader  ts-loader  TS \n\n ts-loader \n\nexport default {\n  tools: {\n    // \n    tsLoader: {},\n  },\n};\n\n\n tools.tsLoader \n\n\n#\n\n\n\n\n#\n\n\n\nexport default {\n  experiments: {\n    lazyCompilation: {\n      imports: true,\n      entries: false,\n    },\n  },\n};\n\n\n experiments.lazyCompilation \n\n\n Source Map #\n\nBuilder  cheap-module-source-map  Source Map\nSource Map \n\n Source Map \n\n Source Map\n\nexport default {\n  tools: {\n    webpackChain(chain, { env }) {\n      if (env === 'development') {\n        chain.devtool(false);\n      }\n    },\n  },\n};\n\n\n Source Map  eval \n\nexport default {\n  tools: {\n    webpackChain(chain, { env }) {\n      if (env === 'development') {\n        chain.devtool('eval');\n      }\n    },\n  },\n};\n\n\n>  Source Map  webpack - devtool\n\n\n Browserslist #\n\n Browserslist \nbrowserslist\n\n package.json \n\n{\n  \"browserslist\": {\n    \"production\": [\">0.2%\", \"not dead\", \"not op_mini all\"],\n    \"development\": [\n      \"last 1 chrome version\",\n      \"last 1 firefox version\",\n      \"last 1 safari version\"\n    ]\n  }\n}\n\n\n\n\n\n#\n\n\n\n\n Source Map#\n\n Source Map disableSourceMap  build \n\nexport default {\n  output: {\n    disableSourceMap: true,\n  },\n};\n\n\n output.disableSourceMap","frontmatter":{}},{"id":304,"title":"","routePath":"/builder/guide/optimization/inline-assets","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":" CSS ","id":"-css-","depth":3},{"text":"","id":"","depth":2},{"text":" CSS ","id":"-css--1","depth":3},{"text":" JS ","id":"-js-","depth":2},{"text":" CSS ","id":"-css-","depth":2},{"text":"","id":"","depth":2}],"domain":"","content":"#\n\n HTML  JS\n\n\n\n\nBuilder  10KB\n\n\n\n#\n\n 10KBBuilder  Base64\n HTTP  HTTP \n\n output.dataUriLimit  5000 \n\nexport default {\n  output: {\n    dataUriLimit: {\n      image: 5000,\n      media: 0,\n    },\n  },\n};\n\n\n\n#\n\n inline URL \n\n\n\n\nexport default function Foo() {\n  return ;\n}\n\n\nfoo.png \n\n inline  __inline \n\n\n\n\n\n CSS #\n\n CSS  inline  __inline \n\n.foo {\n  background-image: url('./icon.png?inline');\n}\n\n\n\n CSS base64\n\n\n\n#\n\n url URL \n\n\n\n\nexport default function Foo() {\n  return ;\n}\n\n\nfoo.png \n\n url  __inline=false \n\n\n\n\n\n CSS #\n\n CSS  url  __inline=false \n\n.foo {\n  background-image: url('./icon.png?url');\n}\n\n\n\n Web App  HTTP2 \n\n\n JS #\n\n JS Builder  JS  HTML \n\n output.enableInlineScripts  JS  HTML\n\n\nexport default {\n  output: {\n    enableInlineScripts: true,\n  },\n};\n\n\nTIP\n JS  HTML \n\n\n CSS #\n\n CSS  HTML \n\n output.enableInlineStyles  CSS  HTML\n\n\nexport default {\n  output: {\n    enableInlineStyles: true,\n  },\n};\n\n\n\n#\n\n TypeScript  ?inline  ?url  URL TypeScript \n\nTS2307: Cannot find module './logo.png?inline' or its corresponding type declarations.\n\n\n URL  src/global.d.ts \n\ndeclare module '*?inline' {\n  const content: string;\n  export default content;\n}\n\ndeclare module '*?inline' {\n  const content: string;\n  export default content;\n}\n\ndeclare module '*?__inline' {\n  const content: string;\n  export default content;\n}\n\ndeclare module '*?inline=false' {\n  const content: string;\n  export default content;\n}\n","frontmatter":{}},{"id":305,"title":"","routePath":"/builder/guide/optimization/optimize-bundle","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":" Browserslist ","id":"-browserslist-","depth":2},{"text":" polyfill","id":"-polyfill","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2}],"domain":"","content":"#\n\n Builder \n\n\n#\n\n\n\n\n\n *  pnpm >= 7.26.0 pnpm  pnpm dedupe \n\npnpm dedupe\n\n\n *  pnpm < 7.26.0  pnpm-deduplicate  pnpm\n   overrides \n\nnpx pnpm-deduplicate --list\n\n\n *  yarn yarn-deduplicate \n\nnpx yarn-deduplicate && yarn\n\n\n\n#\n\n moment  day.js\n\n BUNDLE_ANALYZE=true \n\nBUNDLE_ANALYZE=true pnpm build\n\n\nBuilder  HTML\n\n\n\n\n\n Browserslist #\n\nBuilder  Browserslist \nPolyfill Browserslist  Polyfill \n\nBuilder  Browserslist \n\n['> 0.01%', 'not dead', 'not op_mini all'];\n\n\n Chrome 61 \n\n['Chrome >= 61'];\n\n\nTIP\n   Browserslist \n\n\n polyfill#\n\n polyfill  output.polyfill  usage\n\n usage Builder  polyfill  polyfill \n\nexport default {\n  output: {\n    polyfill: 'usage',\n  },\n};\n\n\nTIP\n   polyfill \n\n\n#\n\n\nBuilder :\n\n\n\n//  builder \nbuilder.addPlugins([builderPluginImageCompress()]);\n\n\n Image Compress \n\n\n#\n\n\n\n Builder \n\n node_modules  axios  axios.js \n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-experience',\n      forceSplitting: {\n        axios: /node_modules\\/axios/,\n      },\n    },\n  },\n};\n","frontmatter":{}},{"id":306,"title":"","routePath":"/builder/guide/optimization/split-chunk","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":"split-by-experience","id":"split-by-experience","depth":3},{"text":"","id":"","depth":4},{"text":"","id":"","depth":4},{"text":"split-by-module","id":"split-by-module","depth":3},{"text":"","id":"-1","depth":4},{"text":"","id":"-1","depth":4},{"text":"all-in-one","id":"all-in-one","depth":3},{"text":"","id":"-2","depth":4},{"text":"","id":"-2","depth":4},{"text":"single-vendor","id":"single-vendor","depth":3},{"text":"","id":"-3","depth":4},{"text":"","id":"-3","depth":4},{"text":"split-by-size","id":"split-by-size","depth":3},{"text":"","id":"-4","depth":4},{"text":"","id":"-4","depth":4},{"text":"","id":"","depth":2},{"text":"","id":"","depth":3},{"text":" webpack ","id":"-webpack-","depth":3}],"domain":"","content":"#\n\n\n\n Builder \n\n\n#\n\n> Builder  performance.chunkSplit \n\nBuilder \n\n * split-by-experience:  npm  chunk\n * split-by-module:  NPM  NPM  chunk\n * split-by-size\n * all-in-one:  chunk \n * single-vendor:  NPM  chunk \n * custom: \n\n\nsplit-by-experience#\n\n#\n\nBuilder  split-by-experience  npm\n chunk\n\n * lib-polyfill.js core-js@babel/runtime@swc/helpers\n * lib-react.js reactreact-dom\n * lib-router.js react-routerreact-router-domhistory@remix-run/router\n * lib-lodash.js lodashlodash-es\n * lib-antd.js antd\n * lib-arco.js @arco-design/web-react\n * lib-semi.js @douyinfe/semi-ui\n\n chunk chunk \n\nTIP\n npm  chunk\n\n#\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-experience',\n    },\n  },\n};\n\n\n\nsplit-by-module#\n\n#\n\n NPM  chunk\n\nwarning \n node_modules HTTP/2  HTTP/2  HTTP\n\n\n#\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-module',\n    },\n  },\n};\n\n\n\nall-in-one#\n\n#\n\n chunk \n\n#\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'all-in-one',\n    },\n  },\n};\n\n\n\nsingle-vendor#\n\n#\n\n chunk  chunk \n\n#\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'single-vendor',\n    },\n  },\n};\n\n\n\nsplit-by-size#\n\n#\n\n minSizemaxSize Webpack \n\n#\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-size',\n      minSize: 30000,\n      maxSize: 50000,\n    },\n  },\n};\n\n\n\n#\n\n Builder :\n\n * \n *  webpack \n\n\n\n\n#\n\nBuilder  webpack \n\n node_modules  axios  axios.js \n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-experience',\n      forceSplitting: {\n        axios: /node_modules\\/axios/,\n      },\n    },\n  },\n};\n\n\n forceSplitting  chunk\n\n\n webpack #\n\n override  webpack :\n\nexport default {\n  performance: {\n    chunkSplit: {\n      strategy: 'split-by-experience',\n      override: {\n        chunks: 'all',\n        minSize: 30000,\n      },\n    },\n  },\n};\n\n\n override  webpack  webpack ","frontmatter":{}},{"id":307,"title":"","routePath":"/builder/guide/quick-start","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":" Modern.js ","id":"-modern.js-","depth":2},{"text":"","id":"","depth":2},{"text":"1.  Builder","id":"1.--builder","depth":3},{"text":"2.  Builder ","id":"2.--builder-","depth":3},{"text":"3.  Builder ","id":"3.--builder-","depth":3},{"text":"","id":"","depth":2}],"domain":"","content":"#\n\n\n#\n\n Node.js Node.js  14.17.6 Node.js 16  LTS \n\n Node.js \n\nnode -v\n# v16.19.1\n\n\n Node.js 14.17.6 nvm  fnm \n\n nvm  Node.js 16 LTS \n\n#  Node.js 16 \nnvm install 16 --lts\n\n#  Node.js 16 \nnvm alias default 16\n\n#  Node.js 16\nnvm use 16\n\n\nnvm  fnm\nnvm  fnm  Node.js nvm  fnm  Rust  nvm \n\n nvm  fnm  lts/gallium  .nvmrc \nNode.js \n\n\n Modern.js #\n\nModern.js  Modern.js Builder \nBuilder Modern.js  Builder \n\nnpx @modern-js/create my-app\n\n\n Modern.js -   Modern.js -   Modern.js \n\n\nModern.js  Modern.js Builder  Modern.js\n Modern.js Builder \n\n\n#\n\n Builder:\n\n\n1.  Builder#\n\n\n\n * @modern-js/builder  Builder  Builder  API\n * @modern-js/builder-webpack-provider  Builder  Provider webpack\n   \n\npnpm add @modern-js/builder @modern-js/builder-webpack-provider -D\n\n\n>  builder  provider \n\n\n2.  Builder #\n\n Builder \n\n Builder Provider builderConfig Builder\n API -  \n\n\n\n\nconst provider = builderWebpackProvider({\n  builderConfig: {\n    // some configs\n  },\n});\n\n\n provider  createBuilder  Builder \n\nconst builder = await createBuilder(provider, {\n  entry: {\n    index: './src/index.ts',\n  },\n});\n\n\n entry createBuilder  API - createBuilder \n\n\n3.  Builder #\n\nBuilder \n\n builder.startDevServer  Dev Server\n\nawait builder.startDevServer();\n\n\n Dev Server \n\ninfo    Starting dev server...\ninfo    Dev server running at:\n\n  > Local:    http://localhost:8081\n  > Network:  http://192.168.0.1:8081\n\n\n builder.build \n\nawait builder.build();\n\n\n>  Builder  Builder Instance \n\n Builder  Builder  Builder \n\n\n#\n\n","frontmatter":{}},{"id":309,"title":"","routePath":"/builder/plugins/introduction","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":" webpack ","id":"-webpack-","depth":2},{"text":"","id":"","depth":2},{"text":" Loader","id":"-loader","depth":3},{"text":"","id":"","depth":3},{"text":" webpack ","id":"-webpack-","depth":3}],"domain":"","content":"#\n\nBuilder   Builder\n\n\n *  bundler \n * \n * \n * \n\nBuilder  webpack  Rspack  bundler Node.js API\n bundler \n\n\n#\n\n (options?: PluginOptions) => BuilderPlugin \nbuilderPluginXXX\n\n\n\nexport interface PluginFooOptions {\n  message?: string;\n}\n\nexport const builderPluginFoo = (\n  options?: PluginFooOptions,\n): BuilderPlugin => ({\n  name: 'plugin-foo',\n  setup(api) {\n    api.onExit(() => {\n      const msg = options.message || 'finish.';\n      console.log(msg);\n    });\n  },\n});\n\nbuilder.addPlugins([builderPluginFoo({ message: 'some other message.' })]);\n\n\n   \n\n\n\n * name \n * setup \n * api \n\n builder-plugin  builder-plugin-foo\n@scope/builder-plugin-bar \n\n\n#\n\nBuilder \n\nBuilder  API \n\nBuilder  Bundler webpack hooks\n\n\n#\n\n\n\n /  Builder  Builder \n\n * \n *  api.modifyBuilderConfig(...) \n * \n\n\n\nexport const builderPluginUploadDist = (): BuilderPlugin => ({\n  name: 'plugin-upload-dist',\n  setup(api) {\n    api.modifyBuilderConfig(config => {\n      // \n      config.output ||= {};\n      config.output.disableMinimize = true;\n      // ...\n    });\n    api.onBeforeBuild(() => {\n      // \n      const config = api.getNormalizedConfig();\n      if (!config.output.disableMinimize) {\n        // \n        throw new Error(\n          'You must disable minimize to upload readable dist files.',\n        );\n      }\n    });\n    api.onAfterBuild(() => {\n      const config = api.getNormalizedConfig();\n      const distRoot = config.output.distPath.root;\n      // TODO:  `distRoot` \n    });\n  },\n});\n\n\n\n\n * api.modifyBuilderConfig(config => {}) \n * api.getBuilderConfig() \n * api.getNormalizedConfig() \n\n PluginUploadDist \n\napi.modifyBuilderConfig((config: BuilderConfig) => {});\napi.getBuilderConfig() as BuilderConfig;\ntype BuilderConfig = {\n  output?: {\n    disableMinimize?: boolean;\n    distPath?: { root?: string };\n  };\n};\n\napi.getNormalizedConfig() as NormalizedConfig;\ntype NormalizedConfig = {\n  output: {\n    disableMinimize: boolean;\n    distPath: { root: string };\n  };\n};\n\n\ngetNormalizedConfig()  BuilderConfig \n\n\n\n\n *  api.modifyBuilderConfig(config => {}) \n *  api.getNormalizedConfig() \n\n\n webpack #\n\n webpack \n\n * api.modifyWebpackChain(chain => {})  webpack-chain\n * api.modifyWebpackConfig(config => {})  webpack \n * api.onAfterCreateCompiler(compiler => {})  webpack \n\n neutrinojs/webpack-chain  API  webpack \n\nBuilder  webpack5 sorrycc/webpack-chain\n\n\n#\n\n\n Loader#\n\nLoader  concepts  loaders\n\n\n\nexport const builderPluginTypeScriptExt = (): BuilderPlugin => ({\n  name: 'builder-typescript-ext',\n  setup(api) {\n    api.modifyWebpackChain(async chain => {\n      //  ts-loader  typescript \n      chain.module.rule(CHAIN_ID.RULE.TS).test(/\\.(ts|mts|cts|tsx|tss|tsm)$/);\n    });\n  },\n});\n\n\n\n#\n\n\n\nexport const builderPluginAdminPanel = (): BuilderPlugin => ({\n  name: 'builder-admin-panel',\n  setup(api) {\n    api.modifyWebpackChain(async chain => {\n      config.entry('admin-panel').add('src/admin/panel.js');\n    });\n  },\n});\n\n\n\n webpack #\n\n Builder  webpack \n\n\n\n\nexport const builderPluginInspector = (options?: Options): BuilderPlugin => ({\n  name: 'builder-plugin-inspector',\n  setup(api) {\n    api.modifyWebpackChain(async chain => {\n      // \n      const { InspectorWebpackPlugin } = await import(\n        '@modern-js/inspector-webpack-plugin'\n      );\n      //  webpack chain \n      chain\n        .plugin('inspector-webpack-plugin')\n        .use(InspectorWebpackPlugin, [inspectorOptions]);\n    });\n  },\n});\n","frontmatter":{}},{"id":310,"title":"","routePath":"/builder/plugins/list","lang":"zh","toc":[{"text":"","id":"","depth":2}],"domain":"","content":"#\n\n\n#\n\n * @modern-js/builder-plugin-swc SWC \n * @modern-js/builder-plugin-stylus Stylus  CSS \n * @modern-js/builder-plugin-esbuild esbuild \n * @modern-js/builder-plugin-node-polyfill Node  Polyfills\n * @modern-js/builder-plugin-image-compress\n\n modern.js/packages/builder ","frontmatter":{}},{"id":311,"title":"Esbuild ","routePath":"/builder/plugins/plugin-esbuild","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":"","id":"","depth":3},{"text":"","id":"","depth":3},{"text":"","id":"","depth":2},{"text":"loader","id":"loader","depth":3},{"text":" JSX ","id":"-jsx-","depth":4},{"text":"","id":"","depth":4},{"text":"","id":"","depth":4},{"text":"minimize","id":"minimize","depth":3},{"text":"","id":"-1","depth":4},{"text":"","id":"","depth":4},{"text":"esbuild ","id":"esbuild-","depth":2},{"text":"","id":"","depth":3},{"text":" Babel ","id":"-babel-","depth":3},{"text":"","id":"","depth":3}],"domain":"","content":"#\n\nesbuild  Golang  JavaScript esbuild\n webpack  terser esbuild \n\nBuilder  esbuild  esbuild  babel-loaderts-loader  terser\n esbuild  OOM (heap out of\nmemory) \n\n SWC\n esbuild SWC  SWC \n\n SWC  esbuild SWC \n\n\n#\n\n\n#\n\n:\n\n# npm\nnpm install @modern-js/builder-plugin-esbuild -D\n\n# yarn\nyarn add @modern-js/builder-plugin-esbuild -D\n\n# pnpm\npnpm add @modern-js/builder-plugin-esbuild -D\n\n\n\n#\n\n Modern.js  builderPlugins  esbuild \n\n\n\nexport default {\n  builderPlugins: [builderPluginEsbuild()],\n};\n\n\n Builder  Node API  addPlugins  esbuild \n\n\n\n//  builder \nbuilder.addPlugins([builderPluginEsbuild()]);\n\n\n\n#\n\n\n\n\nloader#\n\n * \n\ntype LoaderOptions = EsbuildLoaderOptions | false | undefined;\n\n\n * \n\nconst defaultOptions = {\n  target: 'es2015',\n  charset: builderConfig.output.charset,\n};\n\n\n JavaScript  TypeScript  esbuild-loader  babel-loader \nts-loader\n\n esbuild-loader \n\n JSX #\n\n esbuild esbuild  tsconfig.json  compilerOptions.jsx\n JSX \n\n tsconfig.json  JSX \n\n React  compilerOptions.jsx  react-jsx\n\n{\n  \"compilerOptions\": {\n    \"jsx\": \"react-jsx\"\n  }\n}\n\n\n#\n\n target target  JavaScript \nes6es2020 ['chrome58', 'edge16'\n,'firefox57']target  esbuild - target\n\ntarget \n\n * chrome\n * edge\n * firefox\n * ie\n * ios\n * node\n * opera\n * safari\n\nbuilderPluginEsbuild({\n  loader: {\n    target: 'chrome61',\n  },\n});\n\n\n#\n\n loader  false  esbuild  Builder  Babel \n\nbuilderPluginEsbuild({\n  loader: false,\n});\n\n\n\nminimize#\n\n * \n\ntype MinimizeOptions = EsbuildMinifyOptions | false | undefined;\n\n\n * \n\nconst defaultOptions = {\n  css: true,\n  target: 'es2015',\n};\n\n\n JavaScript  CSS \n\n esbuild-loader \n\n#\n\n target \n\nbuilderPluginEsbuild({\n  minimize: {\n    target: 'chrome61',\n  },\n});\n\n\n#\n\n minimize  false  esbuild  Builder  Terser \n\nbuilderPluginEsbuild({\n  minimize: false,\n});\n\n\n\nesbuild #\n\n esbuild  webpack  Builder\n\n\n\n#\n\n esbuild  loader esbuild  ES2015 ES6\nPolyfill  ES5  SWC \n\n:\n\nbuilderPluginEsbuild({\n  loader: {\n    target: 'es2015',\n  },\n});\n\n\n esbuild  minimize esbuild  ES2015 \n\n target  es5 ES5  esbuild Transforming 'xxx'\nto the configured target environment (\"es5\") is not supported yet\n\n ES5  minimize  SWC \n\n:\n\nbuilderPluginEsbuild({\n  minimize: {\n    target: 'es2015',\n  },\n});\n\n\n\n Babel #\n\n esbuild  babel-plugin-import  Babel  esbuild\n Builder  esbuild  Transform API esbuild\n\n\n babel-plugin-import  Babel  SWC \n\n\n#\n\n esbuild  esbuild  terser\nesbuild \n\n minification-benchmarks","frontmatter":{}},{"id":312,"title":"Image Compress ","routePath":"/builder/plugins/plugin-image-compress","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":"","id":"","depth":3},{"text":"","id":"","depth":3},{"text":"","id":"","depth":2}],"domain":"","content":"#\n\nImage Compress \n\n\n#\n\nTIP\n Rspack Image Compress \n\n\n#\n\n:\n\n# npm\nnpm install @modern-js/builder-plugin-image-compress -D\n\n# yarn\nyarn add @modern-js/builder-plugin-image-compress -D\n\n# pnpm\npnpm add @modern-js/builder-plugin-image-compress -D\n\n\n\n#\n\n Modern.js  builderPlugins  Image Compress \n\n\n\nexport default {\n  builderPlugins: [builderPluginImageCompress()],\n};\n\n\n Builder  Node API  addPlugins  Image Compress \n\n\n\n//  builder \nbuilder.addPlugins([builderPluginImageCompress()]);\n\n\n\n#\n\n  use\n\n\n jpeg, png, ico \n\nbuilderPluginImageCompress(['jpeg', 'png', 'ico']);\n\n\nbuilderPluginImageCompress([{ use: 'jpeg' }, { use: 'png' }, { use: 'ico' }]);\n\n\n jpeg  png \n\nbuilderPluginImageCompress([\n  { use: 'jpeg', test: /\\.(jpg|jpeg|jpe)$/ },\n  { use: 'png', minQuality: 50 },\n  'ico',\n]);\n\n\n png \n\nbuilderPluginImageCompress(['jpeg', 'pngLossless', 'ico']);\n\n\n bundler loader  png \npngLossless \n\nbuilderPluginImageCompress(['jpeg', 'pngLossless', 'ico', 'png']);\n\n\n @napi-rs/image","frontmatter":{}},{"id":313,"title":"Node Polyfill ","routePath":"/builder/plugins/plugin-node-polyfill","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":"","id":"","depth":3},{"text":"","id":"","depth":3},{"text":"Node Polyfills","id":"node-polyfills","depth":2},{"text":"Globals","id":"globals","depth":3},{"text":"Modules","id":"modules","depth":3},{"text":"Fallbacks","id":"fallbacks","depth":3}],"domain":"","content":"#\n\nNode Polyfill \n Node  Node  Node Node\nPolyfill  Node  polyfills\n\n Node Polyfill  Node  polyfills\n\n\n#\n\n\n#\n\n:\n\n# npm\nnpm install @modern-js/builder-plugin-node-polyfill -D\n\n# yarn\nyarn add @modern-js/builder-plugin-node-polyfill -D\n\n# pnpm\npnpm add @modern-js/builder-plugin-node-polyfill -D\n\n\n\n#\n\n Modern.js  builderPlugins  node polyfill \n\n\n\nexport default {\n  builderPlugins: [builderPluginNodePolyfill()],\n};\n\n\n Builder  Node API  addPlugins  node polyfill \n\n\n\n//  builder \nbuilder.addPlugins([builderPluginNodePolyfill()]);\n\n\n\nNode Polyfills#\n\n\nGlobals#\n\n * Buffer\n * process\n\n polyfill \n\nconst bufferData = Buffer.from('xxxx');\n\n\n\nModules#\n\n * assert\n * buffer\n * console\n * constants\n * crypto\n * domain\n * events\n * http\n * https\n * os\n * path\n * punycode\n * process\n * querystring\n * stream\n * _stream_duplex\n * _stream_passthrough\n * _stream_readable\n * _stream_transform\n * _stream_writable\n * string_decoder\n * sys\n * timers\n * tty\n * url\n * util\n * vm\n * zlib\n\n require  import  polyfill \n\n\n\nconst bufferData = Buffer.from('xxxx');\n\n\n\nFallbacks#\n\n * child_process\n * cluster\n * dgram\n * dns\n * fs\n * module\n * net\n * readline\n * repl\n * tls\n\n polyfill fallback \n\n\n\nconsole.log(fs); // -> {}\n","frontmatter":{}},{"id":314,"title":"Stylus ","routePath":"/builder/plugins/plugin-stylus","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":"","id":"","depth":3},{"text":"","id":"","depth":3},{"text":"","id":"","depth":2},{"text":"","id":"","depth":2},{"text":"stylusOptions","id":"stylusoptions","depth":3},{"text":"sourceMap","id":"sourcemap","depth":3}],"domain":"","content":"#\n\nStylus  CSS  Builder  Stylus\n\n\n#\n\nTIP\n Rspack Stylus \n\n\n#\n\n:\n\n# npm\nnpm install @modern-js/builder-plugin-stylus -D\n\n# yarn\nyarn add @modern-js/builder-plugin-stylus -D\n\n# pnpm\npnpm install @modern-js/builder-plugin-stylus -D\n\n\n\n#\n\n Modern.js  builderPlugins  Stylus \n\n\n\nexport default {\n  builderPlugins: [builderPluginStylus()],\n};\n\n\n Builder  Node API  addPlugins  Stylus \n\n\n\n//  builder \nbuilder.addPlugins([builderPluginStylus()]);\n\n\n\n#\n\n *.styl  *.module.styl \n\n * normalize.styl:\n\nbody\n  color #000\n  font 14px Arial, sans-serif\n\n\n * title.module.styl:\n\n.title\n  font-size: 14px;\n\n\n * index.js:\n\nimport './normalize.styl';\n\n\nconsole.log(style.title);\n\n\n\n#\n\n Stylus \n\n\nstylusOptions#\n\n * \n\ntype StylusOptions = {\n  use?: string[];\n  include?: string;\n  import?: string;\n  resolveURL?: boolean;\n  lineNumbers?: boolean;\n  hoistAtrules?: boolean;\n};\n\n\n *  undefined\n\n Stylus  Stylus  \n\nbuilderPluginStylus({\n  stylusOptions: {\n    lineNumbers: false,\n  },\n});\n\n\n\nsourceMap#\n\n *  boolean\n *  isDev\n\n Source Map\n\nbuilderPluginStylus({\n  sourceMap: false,\n});\n","frontmatter":{}},{"id":315,"title":"SWC ","routePath":"/builder/plugins/plugin-swc","lang":"zh","toc":[{"text":"","id":"","depth":2},{"text":"","id":"","depth":3},{"text":"","id":"","depth":3},{"text":"","id":"","depth":2},{"text":"presetReact","id":"presetreact","depth":3},{"text":"presetEnv","id":"presetenv","depth":3},{"text":"jsMinify","id":"jsminify","depth":3},{"text":"cssMinify","id":"cssminify","depth":3},{"text":"extensions","id":"extensions","depth":3},{"text":"extensions.reactUtils","id":"extensions.reactutils","depth":4},{"text":"extensions.lodash","id":"extensions.lodash","depth":4},{"text":"extensions.styledComponent","id":"extensions.styledcomponent","depth":4},{"text":"extensions.emotion","id":"extensions.emotion","depth":4},{"text":"extensions.pluginImport","id":"extensions.pluginimport","depth":4},{"text":"","id":"","depth":2}],"domain":"","content":"#\n\nSWC (Speedy Web Compiler)  Rust  JavaScript  TypeScript \nPolyfill  Babel  Babel \n\nModern.js Builder  SWC  Web Polyfill \nBabel \n\n\n#\n\nTIP\n Rspack  SWC  SWC \n\n\n#\n\n:\n\n# npm\nnpm install @modern-js/builder-plugin-swc -D\n\n# yarn\nyarn add @modern-js/builder-plugin-swc -D\n\n# pnpm\npnpm add @modern-js/builder-plugin-swc -D\n\n\n\n#\n\n Modern.js  builderPlugins  SWC \n\n\n\nexport default {\n  builderPlugins: [builderPluginSwc()],\n};\n\n\n Builder  Node API  addPlugins  SWC \n\n\n\n//  builder \nbuilder.addPlugins([builderPluginSwc()]);\n\n\nThat's it !\n\n SWC \n\n\n#\n\n * \n\ntype PluginConfig = {\n  presetReact?: ReactConfig;\n  presetEnv?: EnvConfig;\n  jsMinify?: boolean | JsMinifyOptions;\n  cssMinify?: boolean | CssMinifyOptions;\n  extensions?: Extensions;\n};\n\n\n\npresetReact#\n\n *  SWC  presetReact\n\n @babel/preset-react\n\n react  runtime  react  17.0.0 automatic\nclassic\n\n\npresetEnv#\n\n *  SWC  presetEnv\n\n @babel/preset-env :\n\n{\n  targets: '', //  browserslist\n  mode: 'usage',\n}\n\n\n\njsMinify#\n\n *  boolean  terser  compress \n *  { compress: {}, mangle: true }\n\n false  SWC  true \n\n\ncssMinify#\n\n *  boolean\n *  true\n\n SWC  CSS  CSS \n\n\nextensions#\n\n *  Object\n\nextensions  Babel \n\nextensions.reactUtils#\n\n * \n\ntype ReactUtilsOptions = {\n  autoImportReact?: boolean;\n  removeEffect?: boolean;\n  removePropTypes?: {\n    mode?: 'remove' | 'unwrap' | 'unsafe-wrap';\n    removeImport?: boolean;\n    ignoreFilenames?: string[];\n    additionalLibraries?: string[];\n    classNameMatchers?: string[];\n  };\n};\n\n\n React :\n\nreactUtils.autoImportReact\n\n *  boolean\n\n React, `` jsx  React.createElement\n\nreactUtils.removeEffect\n\n *  boolean\n\n useEffect \n\nreactUtils.removePropTypes\n\n * \n\ntype RemovePropTypesOptions = {\n  mode?: 'remove' | 'unwrap' | 'unsafe-wrap';\n  removeImport?: boolean;\n  ignoreFilenames?: string[];\n  additionalLibraries?: string[];\n  classNameMatchers?: string[];\n};\n\n\n React  @babel/plugin-react-transform-remove-prop-types\n\n @babel/plugin-react-transform-remove-prop-types \n\nextensions.lodash#\n\n *  { cwd?: string; ids?: string;}\n *  { cwd: process.cwd(), ids: [] }\n\n @babel/plugin-lodash\n\nextensions.styledComponent#\n\n * \n\nboolean | {\n  displayName?: boolean; // , ,\n  ssr?: boolean; // \n  fileName?: boolean; // \n  topLevelImportPaths?: string[]; // \n  meaninglessFileNames?: string[]; //  [\"index\"].\n  cssProp?: boolean; // \n  namespace?: string; // \n};\n\n\n Next.js  styled-component\n\nextensions.emotion#\n\n * \n\nboolean | {\n  sourceMap?: boolean, // \n  autoLabel?: 'never' | 'dev-only' | 'always', //  'dev-only'\n  //  '[local]'.\n  // : `[local]` `[filename]`  `[dirname]`\n  //  autoLabel  'dev-only'  'always' .\n  // \n  //  \"my-classname--[local]\" [local] \n  labelFormat?: string,\n  //  undefined.\n  //  emotion\n  // \n  importMap?: {\n    [packageName: string]: {\n      [exportName: string]: {\n        canonicalImport?: [string, string],\n        styledBaseImport?: [string, string],\n      }\n    }\n  },\n},\n\n\n Next.js  @emotion/babel-plugin\n\nextensions.pluginImport#\n\nTIP\nBuilder  source.transformImport  extensions.pluginImport\n\n babel-plugin-import\n\n customNamecustomStyleName  JavaScript  Rust  Node-API\n\n\ncustomNamecustomStyleName\n\n\n:\n\n\n\n\n\n\nPluginSWC({\n  extensions: {\n    pluginImport: [\n      {\n        libraryName: 'foo',\n        customName: 'foo/es/{{ member }}',\n      },\n    ],\n  },\n});\n\n\n {{ member }} :\n\n\n\n\n customName: \"foo/es/{{ member }}\"  customName: (member) =>\n`foo/es/${member}`  Node-API \n\n handlebars\n\nPluginSWC({\n  extensions: {\n    pluginImport: [\n      {\n        libraryName: 'foo',\n        customName: 'foo/es/{{ kebabCase member }}',\n      },\n    ],\n  },\n});\n\n\n:\n\n\n\n\n kebabCase  camelCasesnakeCaseupperCaselowerCase \n\n\n#\n\n @babel/plugin-transform-runtime  Babel ","frontmatter":{}}]